?:(\\\\[|])|[^|`]|`[^`]++`|`)++/', $row, $matches);

            $cells = array_slice($matches[0], 0, count($Block['alignments']));

            foreach ($cells as $index => $cell)
            {
                $cell = trim($cell);

                $Element = array(
                    'name' => 'td',
                    'handler' => array(
                        'function' => 'lineElements',
                        'argument' => $cell,
                        'destination' => 'elements',
                    )
                );

                if (isset($Block['alignments'][$index]))
                {
                    $Element['attributes'] = array(
                        'style' => 'text-align: ' . $Block['alignments'][$index] . ';',
                    );
                }

                $Elements []= $Element;
            }

            $Element = array(
                'name' => 'tr',
                'elements' => $Elements,
            );

            $Block['element']['elements'][1]['elements'] []= $Element;

            return $Block;
        }
    }

    #
    # ~
    #

    protected function paragraph($Line)
    {
        return array(
            'type' => 'Paragraph',
            'element' => array(
                'name' => 'p',
                'handler' => array(
                    'function' => 'lineElements',
                    'argument' => $Line['text'],
                    'destination' => 'elements',
                ),
            ),
        );
    }

    protected function paragraphContinue($Line, array $Block)
    {
        if (isset($Block['interrupted']))
        {
            return;
        }

        $Block['element']['handler']['argument'] .= "\n".$Line['text'];

        return $Block;
    }

    #
    # Inline Elements
    #

    protected $InlineTypes = array(
        '!' => array('Image'),
        '&' => array('SpecialCharacter'),
        '*' => array('Emphasis'),
        ':' => array('Url'),
        '<' => array('UrlTag', 'EmailTag', 'Markup'),
        '[' => array('Link'),
        '_' => array('Emphasis'),
        '`' => array('Code'),
        '~' => array('Strikethrough'),
        '\\' => array('EscapeSequence'),
    );

    # ~

    protected $inlineMarkerList = '!*_&[:<`~\\';

    #
    # ~
    #

    public function line($text, $nonNestables = array())
    {
        return $this->elements($this->lineElements($text, $nonNestables));
    }

    protected function lineElements($text, $nonNestables = array())
    {
        # standardize line breaks
        $text = str_replace(array("\r\n", "\r"), "\n", $text);

        $Elements = array();

        $nonNestables = (empty($nonNestables)
            ? array()
            : array_combine($nonNestables, $nonNestables)
        );

        # $excerpt is based on the first occurrence of a marker

        while ($excerpt = strpbrk($text, $this->inlineMarkerList))
        {
            $marker = $excerpt[0];

            $markerPosition = strlen($text) - strlen($excerpt);

            $Excerpt = array('text' => $excerpt, 'context' => $text);

            foreach ($this->InlineTypes[$marker] as $inlineType)
            {
                # check to see if the current inline type is nestable in the current context

                if (isset($nonNestables[$inlineType]))
                {
                    continue;
                }

                $Inline = $this->{"inline$inlineType"}($Excerpt);

                if ( ! isset($Inline))
                {
                    continue;
                }

                # makes sure that the inline belongs to "our" marker

                if (isset($Inline['position']) and $Inline['position'] > $markerPosition)
                {
                    continue;
                }

                # sets a default inline position

                if ( ! isset($Inline['position']))
                {
                    $Inline['position'] = $markerPosition;
                }

                # cause the new element to 'inherit' our non nestables


                $Inline['element']['nonNestables'] = isset($Inline['element']['nonNestables'])
                    ? array_merge($Inline['element']['nonNestables'], $nonNestables)
                    : $nonNestables
                ;

                # the text that comes before the inline
                $unmarkedText = substr($text, 0, $Inline['position']);

                # compile the unmarked text
                $InlineText = $this->inlineText($unmarkedText);
                $Elements[] = $InlineText['element'];

                # compile the inline
                $Elements[] = $this->extractElement($Inline);

                # remove the examined text
                $text = substr($text, $Inline['position'] + $Inline['extent']);

                continue 2;
            }

            # the marker does not belong to an inline

            $unmarkedText = substr($text, 0, $markerPosition + 1);

            $InlineText = $this->inlineText($unmarkedText);
            $Elements[] = $InlineText['element'];

            $text = substr($text, $markerPosition + 1);
        }

        $InlineText = $this->inlineText($text);
        $Elements[] = $InlineText['element'];

        foreach ($Elements as &$Element)
        {
            if ( ! isset($Element['autobreak']))
            {
                $Element['autobreak'] = false;
            }
        }

        return $Elements;
    }

    #
    # ~
    #

    protected function inlineText($text)
    {
        $Inline = array(
            'extent' => strlen($text),
            'element' => array(),
        );

        $Inline['element']['elements'] = self::pregReplaceElements(
            $this->breaksEnabled ? '/[ ]*+\n/' : '/(?:[ ]*+\\\\|[ ]{2,}+)\n/',
            array(
                array('name' => 'br'),
                array('text' => "\n"),
            ),
            $text
        );

        return $Inline;
    }

    protected function inlineCode($Excerpt)
    {
        $marker = $Excerpt['text'][0];

        if (preg_match('/^(['.$marker.']++)[ ]*+(.+?)[ ]*+(?<!['.$marker.'])\1(?!'.$marker.')/s', $Excerpt['text'], $matches))
        {
            $text = $matches[2];
            $text = preg_replace('/[ ]*+\n/', ' ', $text);

            return array(
                'extent' => strlen($matches[0]),
                'element' => array(
                    'name' => 'code',
                    'text' => $text,
                ),
            );
        }
    }

    protected function inlineEmailTag($Excerpt)
    {
        $hostnameLabel = '[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?';

        $commonMarkEmail = '[a-zA-Z0-9.!#$%&\'*+\/=?^_`{|}~-]++@'
            . $hostnameLabel . '(?:\.' . $hostnameLabel . ')*';

        if (strpos($Excerpt['text'], '>') !== false
            and preg_match("/^<((mailto:)?$commonMarkEmail)>/i", $Excerpt['text'], $matches)
        ){
            $url = $matches[1];

            if ( ! isset($matches[2]))
            {
                $url = "mailto:$url";
            }

            return array(
                'extent' => strlen($matches[0]),
                'element' => array(
                    'name' => 'a',
                    'text' => $matches[1],
                    'attributes' => array(
                        'href' => $url,
                    ),
                ),
            );
        }
    }

    protected function inlineEmphasis($Excerpt)
    {
        if ( ! isset($Excerpt['text'][1]))
        {
            return;
        }

        $marker = $Excerpt['text'][0];

        if ($Excerpt['text'][1] === $marker and preg_match($this->StrongRegex[$marker], $Excerpt['text'], $matches))
        {
            $emphasis = 'strong';
        }
        elseif (preg_match($this->EmRegex[$marker], $Excerpt['text'], $matches))
        {
            $emphasis = 'em';
        }
        else
        {
            return;
        }

        return array(
            'extent' => strlen($matches[0]),
            'element' => array(
                'name' => $emphasis,
                'handler' => array(
                    'function' => 'lineElements',
                    'argument' => $matches[1],
                    'destination' => 'elements',
                )
            ),
        );
    }

    protected function inlineEscapeSequence($Excerpt)
    {
        if (isset($Excerpt['text'][1]) and in_array($Excerpt['text'][1], $this->specialCharacters))
        {
            return array(
                'element' => array('rawHtml' => $Excerpt['text'][1]),
                'extent' => 2,
            );
        }
    }

    protected function inlineImage($Excerpt)
    {
        if ( ! isset($Excerpt['text'][1]) or $Excerpt['text'][1] !== '[')
        {
            return;
        }

        $Excerpt['text']= substr($Excerpt['text'], 1);

        $Link = $this->inlineLink($Excerpt);

        if ($Link === null)
        {
            return;
        }

        $Inline = array(
            'extent' => $Link['extent'] + 1,
            'element' => array(
                'name' => 'img',
                'attributes' => array(
                    'src' => $Link['element']['attributes']['href'],
                    'alt' => $Link['element']['handler']['argument'],
                ),
                'autobreak' => true,
            ),
        );

        $Inline['element']['attributes'] += $Link['element']['attributes'];

        unset($Inline['element']['attributes']['href']);

        return $Inline;
    }

    protected function inlineLink($Excerpt)
    {
        $Element = array(
            'name' => 'a',
            'handler' => array(
                'function' => 'lineElements',
                'argument' => null,
                'destination' => 'elements',
            ),
            'nonNestables' => array('Url', 'Link'),
            'attributes' => array(
                'href' => null,
                'title' => null,
            ),
        );

        $extent = 0;

        $remainder = $Excerpt['text'];

        if (preg_match('/\[((?:[^][]++|(?R))*+)\]/', $remainder, $matches))
        {
            $Element['handler']['argument'] = $matches[1];

            $extent += strlen($matches[0]);

            $remainder = substr($remainder, $extent);
        }
        else
        {
            return;
        }

        if (preg_match('/^[(]\s*+((?:[^ ()]++|[(][^ )]+[)])++)(?:[ ]+("[^"]*+"|\'[^\']*+\'))?\s*+[)]/', $remainder, $matches))
        {
            $Element['attributes']['href'] = $matches[1];

            if (isset($matches[2]))
            {
                $Element['attributes']['title'] = substr($matches[2], 1, - 1);
            }

            $extent += strlen($matches[0]);
        }
        else
        {
            if (preg_match('/^\s*\[(.*?)\]/', $remainder, $matches))
            {
                $definition = strlen($matches[1]) ? $matches[1] : $Element['handler']['argument'];
                $definition = strtolower($definition);

                $extent += strlen($matches[0]);
            }
            else
            {
                $definition = strtolower($Element['handler']['argument']);
            }

            if ( ! isset($this->DefinitionData['Reference'][$definition]))
            {
                return;
            }

            $Definition = $this->DefinitionData['Reference'][$definition];

            $Element['attributes']['href'] = $Definition['url'];
            $Element['attributes']['title'] = $Definition['title'];
        }

        return array(
            'extent' => $extent,
            'element' => $Element,
        );
    }

    protected function inlineMarkup($Excerpt)
    {
        if ($this->markupEscaped or $this->safeMode or strpos($Excerpt['text'], '>') === false)
        {
            return;
        }

        if ($Excerpt['text'][1] === '/' and preg_match('/^<\/\w[\w-]*+[ ]*+>/s', $Excerpt['text'], $matches))
        {
            return array(
                'element' => array('rawHtml' => $matches[0]),
                'extent' => strlen($matches[0]),
            );
        }

        if ($Excerpt['text'][1] === '!' and preg_match('/^<!---?[^>-](?:-?+[^-])*-->/s', $Excerpt['text'], $matches))
        {
            return array(
                'element' => array('rawHtml' => $matches[0]),
                'extent' => strlen($matches[0]),
            );
        }

        if ($Excerpt['text'][1] !== ' ' and preg_match('/^<\w[\w-]*+(?:[ ]*+'.$this->regexHtmlAttribute.')*+[ ]*+\/?>/s', $Excerpt['text'], $matches))
        {
            return array(
                'element' => array('rawHtml' => $matches[0]),
                'extent' => strlen($matches[0]),
            );
        }
    }

    protected function inlineSpecialCharacter($Excerpt)
    {
        if (substr($Excerpt['text'], 1, 1) !== ' ' and strpos($Excerpt['text'], ';') !== false
            and preg_match('/^&(#?+[0-9a-zA-Z]++);/', $Excerpt['text'], $matches)
        ) {
            return array(
                'element' => array('rawHtml' => '&' . $matches[1] . ';'),
                'extent' => strlen($matches[0]),
            );
        }

        return;
    }

    protected function inlineStrikethrough($Excerpt)
    {
        if ( ! isset($Excerpt['text'][1]))
        {
            return;
        }

        if ($Excerpt['text'][1] === '~' and preg_match('/^~~(?=\S)(.+?)(?<=\S)~~/', $Excerpt['text'], $matches))
        {
            return array(
                'extent' => strlen($matches[0]),
                'element' => array(
                    'name' => 'del',
                    'handler' => array(
                        'function' => 'lineElements',
                        'argument' => $matches[1],
                        'destination' => 'elements',
                    )
                ),
            );
        }
    }

    protected function inlineUrl($Excerpt)
    {
        if ($this->urlsLinked !== true or ! isset($Excerpt['text'][2]) or $Excerpt['text'][2] !== '/')
        {
            return;
        }

        if (strpos($Excerpt['context'], 'http') !== false
            and preg_match('/\bhttps?+:[\/]{2}[^\s<]+\b\/*+/ui', $Excerpt['context'], $matches, PREG_OFFSET_CAPTURE)
        ) {
            $url = $matches[0][0];

            $Inline = array(
                'extent' => strlen($matches[0][0]),
                'position' => $matches[0][1],
                'element' => array(
                    'name' => 'a',
                    'text' => $url,
                    'attributes' => array(
                        'href' => $url,
                    ),
                ),
            );

            return $Inline;
        }
    }

    protected function inlineUrlTag($Excerpt)
    {
        if (strpos($Excerpt['text'], '>') !== false and preg_match('/^<(\w++:\/{2}[^ >]++)>/i', $Excerpt['text'], $matches))
        {
            $url = $matches[1];

            return array(
                'extent' => strlen($matches[0]),
                'element' => array(
                    'name' => 'a',
                    'text' => $url,
                    'attributes' => array(
                        'href' => $url,
                    ),
                ),
            );
        }
    }

    # ~

    protected function unmarkedText($text)
    {
        $Inline = $this->inlineText($text);
        return $this->element($Inline['element']);
    }

    #
    # Handlers
    #

    protected function handle(array $Element)
    {
        if (isset($Element['handler']))
        {
            if (!isset($Element['nonNestables']))
            {
                $Element['nonNestables'] = array();
            }

            if (is_string($Element['handler']))
            {
                $function = $Element['handler'];
                $argument = $Element['text'];
                unset($Element['text']);
                $destination = 'rawHtml';
            }
            else
            {
                $function = $Element['handler']['function'];
                $argument = $Element['handler']['argument'];
                $destination = $Element['handler']['destination'];
            }

            $Element[$destination] = $this->{$function}($argument, $Element['nonNestables']);

            if ($destination === 'handler')
            {
                $Element = $this->handle($Element);
            }

            unset($Element['handler']);
        }

        return $Element;
    }

    protected function handleElementRecursive(array $Element)
    {
        return $this->elementApplyRecursive(array($this, 'handle'), $Element);
    }

    protected function handleElementsRecursive(array $Elements)
    {
        return $this->elementsApplyRecursive(array($this, 'handle'), $Elements);
    }

    protected function elementApplyRecursive($closure, array $Element)
    {
        $Element = call_user_func($closure, $Element);

        if (isset($Element['elements']))
        {
            $Element['elements'] = $this->elementsApplyRecursive($closure, $Element['elements']);
        }
        elseif (isset($Element['element']))
        {
            $Element['element'] = $this->elementApplyRecursive($closure, $Element['element']);
        }

        return $Element;
    }

    protected function elementApplyRecursiveDepthFirst($closure, array $Element)
    {
        if (isset($Element['elements']))
        {
            $Element['elements'] = $this->elementsApplyRecursiveDepthFirst($closure, $Element['elements']);
        }
        elseif (isset($Element['element']))
        {
            $Element['element'] = $this->elementsApplyRecursiveDepthFirst($closure, $Element['element']);
        }

        $Element = call_user_func($closure, $Element);

        return $Element;
    }

    protected function elementsApplyRecursive($closure, array $Elements)
    {
        foreach ($Elements as &$Element)
        {
            $Element = $this->elementApplyRecursive($closure, $Element);
        }

        return $Elements;
    }

    protected function elementsApplyRecursiveDepthFirst($closure, array $Elements)
    {
        foreach ($Elements as &$Element)
        {
            $Element = $this->elementApplyRecursiveDepthFirst($closure, $Element);
        }

        return $Elements;
    }

    protected function element(array $Element)
    {
        if ($this->safeMode)
        {
            $Element = $this->sanitiseElement($Element);
        }

        # identity map if element has no handler
        $Element = $this->handle($Element);

        $hasName = isset($Element['name']);

        $markup = '';

        if ($hasName)
        {
            $markup .= '<' . $Element['name'];

            if (isset($Element['attributes']))
            {
                foreach ($Element['attributes'] as $name => $value)
                {
                    if ($value === null)
                    {
                        continue;
                    }

                    $markup .= " $name=\"".self::escape($value).'"';
                }
            }
        }

        $permitRawHtml = false;

        if (isset($Element['text']))
        {
            $text = $Element['text'];
        }
        // very strongly consider an alternative if you're writing an
        // extension
        elseif (isset($Element['rawHtml']))
        {
            $text = $Element['rawHtml'];

            $allowRawHtmlInSafeMode = isset($Element['allowRawHtmlInSafeMode']) && $Element['allowRawHtmlInSafeMode'];
            $permitRawHtml = !$this->safeMode || $allowRawHtmlInSafeMode;
        }

        $hasContent = isset($text) || isset($Element['element']) || isset($Element['elements']);

        if ($hasContent)
        {
            $markup .= $hasName ? '>' : '';

            if (isset($Element['elements']))
            {
                $markup .= $this->elements($Element['elements']);
            }
            elseif (isset($Element['element']))
            {
                $markup .= $this->element($Element['element']);
            }
            else
            {
                if (!$permitRawHtml)
                {
                    $markup .= self::escape($text, true);
                }
                else
                {
                    $markup .= $text;
                }
            }

            $markup .= $hasName ? '</' . $Element['name'] . '>' : '';
        }
        elseif ($hasName)
        {
            $markup .= ' />';
        }

        return $markup;
    }

    protected function elements(array $Elements)
    {
        $markup = '';

        $autoBreak = true;

        foreach ($Elements as $Element)
        {
            if (empty($Element))
            {
                continue;
            }

            $autoBreakNext = (isset($Element['autobreak'])
                ? $Element['autobreak'] : isset($Element['name'])
            );
            // (autobreak === false) covers both sides of an element
            $autoBreak = !$autoBreak ? $autoBreak : $autoBreakNext;

            $markup .= ($autoBreak ? "\n" : '') . $this->element($Element);
            $autoBreak = $autoBreakNext;
        }

        $markup .= $autoBreak ? "\n" : '';

        return $markup;
    }

    # ~

    protected function li($lines)
    {
        $Elements = $this->linesElements($lines);

        if ( ! in_array('', $lines)
            and isset($Elements[0]) and isset($Elements[0]['name'])
            and $Elements[0]['name'] === 'p'
        ) {
            unset($Elements[0]['name']);
        }

        return $Elements;
    }

    #
    # AST Convenience
    #

    /**
     * Replace occurrences $regexp with $Elements in $text. Return an array of
     * elements representing the replacement.
     */
    protected static function pregReplaceElements($regexp, $Elements, $text)
    {
        $newElements = array();

        while (preg_match($regexp, $text, $matches, PREG_OFFSET_CAPTURE))
        {
            $offset = $matches[0][1];
            $before = substr($text, 0, $offset);
            $after = substr($text, $offset + strlen($matches[0][0]));

            $newElements[] = array('text' => $before);

            foreach ($Elements as $Element)
            {
                $newElements[] = $Element;
            }

            $text = $after;
        }

        $newElements[] = array('text' => $text);

        return $newElements;
    }

    #
    # Deprecated Methods
    #

    function parse($text)
    {
        $markup = $this->text($text);

        return $markup;
    }

    protected function sanitiseElement(array $Element)
    {
        static $goodAttribute = '/^[a-zA-Z0-9][a-zA-Z0-9-_]*+$/';
        static $safeUrlNameToAtt  = array(
            'a'   => 'href',
            'img' => 'src',
        );

        if ( ! isset($Element['name']))
        {
            unset($Element['attributes']);
            return $Element;
        }

        if (isset($safeUrlNameToAtt[$Element['name']]))
        {
            $Element = $this->filterUnsafeUrlInAttribute($Element, $safeUrlNameToAtt[$Element['name']]);
        }

        if ( ! empty($Element['attributes']))
        {
            foreach ($Element['attributes'] as $att => $val)
            {
                # filter out badly parsed attribute
                if ( ! preg_match($goodAttribute, $att))
                {
                    unset($Element['attributes'][$att]);
                }
                # dump onevent attribute
                elseif (self::striAtStart($att, 'on'))
                {
                    unset($Element['attributes'][$att]);
                }
            }
        }

        return $Element;
    }

    protected function filterUnsafeUrlInAttribute(array $Element, $attribute)
    {
        foreach ($this->safeLinksWhitelist as $scheme)
        {
            if (self::striAtStart($Element['attributes'][$attribute], $scheme))
            {
                return $Element;
            }
        }

        $Element['attributes'][$attribute] = str_replace(':', '%3A', $Element['attributes'][$attribute]);

        return $Element;
    }

    #
    # Static Methods
    #

    protected static function escape($text, $allowQuotes = false)
    {
        return htmlspecialchars($text, $allowQuotes ? ENT_NOQUOTES : ENT_QUOTES, 'UTF-8');
    }

    protected static function striAtStart($string, $needle)
    {
        $len = strlen($needle);

        if ($len > strlen($string))
        {
            return false;
        }
        else
        {
            return strtolower(substr($string, 0, $len)) === strtolower($needle);
        }
    }

    static function instance($name = 'default')
    {
        if (isset(self::$instances[$name]))
        {
            return self::$instances[$name];
        }

        $instance = new static();

        self::$instances[$name] = $instance;

        return $instance;
    }

    private static $instances = array();

    #
    # Fields
    #

    protected $DefinitionData;

    #
    # Read-Only

    protected $specialCharacters = array(
        '\\', '`', '*', '_', '{', '}', '[', ']', '(', ')', '>', '#', '+', '-', '.', '!', '|', '~'
    );

    protected $StrongRegex = array(
        '*' => '/^[*]{2}((?:\\\\\*|[^*]|[*][^*]*+[*])+?)[*]{2}(?![*])/s',
        '_' => '/^__((?:\\\\_|[^_]|_[^_]*+_)+?)__(?!_)/us',
    );

    protected $EmRegex = array(
        '*' => '/^[*]((?:\\\\\*|[^*]|[*][*][^*]+?[*][*])+?)[*](?![*])/s',
        '_' => '/^_((?:\\\\_|[^_]|__[^_]*__)+?)_(?!_)\b/us',
    );

    protected $regexHtmlAttribute = '[a-zA-Z_:][\w:.-]*+(?:\s*+=\s*+(?:[^"\'=<>`\s]+|"[^"]*+"|\'[^\']*+\'))?+';

    protected $voidElements = array(
        'area', 'base', 'br', 'col', 'command', 'embed', 'hr', 'img', 'input', 'link', 'meta', 'param', 'source',
    );

    protected $textLevelElements = array(
        'a', 'br', 'bdo', 'abbr', 'blink', 'nextid', 'acronym', 'basefont',
        'b', 'em', 'big', 'cite', 'small', 'spacer', 'listing',
        'i', 'rp', 'del', 'code',          'strike', 'marquee',
        'q', 'rt', 'ins', 'font',          'strong',
        's', 'tt', 'kbd', 'mark',
        'u', 'xm', 'sub', 'nobr',
                   'sup', 'ruby',
                   'var', 'span',
                   'wbr', 'time',
    );
}

--- END FILE: C:\xampp\htdocs\files\PAUSE\libs\Parsedown.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\partials\_sidebar.php ---
<aside class="dashboard-sidebar">
    <h2>Verwaltung</h2>
    <nav class="dashboard-nav">
        <?php
        $currentUrl = $_SERVER['REQUEST_URI'];
        $userRole = $_SESSION['user_role'] ?? '';
        $settings = \App\Core\Utils::getSettings();
        ?>
        <?php if (in_array($userRole, ['admin'])): ?>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/dashboard')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'admin/dashboard') ? 'active' : ''); ?>">
                Dashboard √úbersicht
            </a>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/users')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'admin/users') ? 'active' : ''); ?>">
                Benutzer verwalten
            </a>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/csv-template')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'admin/csv-template') ? 'active' : ''); ?>">
                CSV Importvorlage
            </a>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/stammdaten')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'admin/stammdaten') ? 'active' : ''); ?>">
                Stammdaten
            </a>
        <?php endif; ?>
        <?php if (in_array($userRole, ['admin', 'planer', 'lehrer'])): ?>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/announcements')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'admin/announcements') ? 'active' : ''); ?>">
                Ank√ºndigungen
            </a>
        <?php endif; ?>
        <?php // NEU: Link nur anzeigen, wenn das Board in den Settings aktiviert ist ?>
        <?php if (in_array($userRole, ['admin', 'planer']) && $settings['community_board_enabled']): ?>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/community-moderation')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'admin/community-moderation') ? 'active' : ''); ?>">
                Schwarzes Brett (Mod.)
            </a>
        <?php endif; ?>
        <?php if (in_array($userRole, ['admin'])): ?>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/audit-logs')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'admin/audit-logs') ? 'active' : ''); ?>">
                Audit Log (Protokoll)
            </a>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/system-health')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'admin/system-health') ? 'active' : ''); ?>">
                System-Status
            </a>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/settings')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'admin/settings') ? 'active' : ''); ?>">
                Einstellungen
            </a>
        <?php endif; ?>
         <?php if (in_array($userRole, ['planer'])): ?>
               <?php endif; ?>
    </nav>
</aside>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\partials\_sidebar.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\Announcements.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper admin-dashboard-wrapper">
    <h1 class="main-title">Ank√ºndigungsverwaltung</h1>
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; ?>
        <main class="dashboard-content" id="announcements-management">
            <div class="dashboard-section active">
                <div class="form-container">
                    <h4 id="announcement-form-title">Neue Ank√ºndigung erstellen</h4>
                    <!-- KORRIGIERT: method="POST" hinzugef√ºgt -->
                    <form id="announcement-form" data-mode="create" method="POST" enctype="multipart/form-data">
                        <?php \App\Core\Security::csrfInput(); // Add CSRF input field ?>
                        <input type="hidden" name="announcement_id" id="announcement_id">
                        <div class="form-group">
                            <label for="title">Titel*</label>
                            <input type="text" name="title" id="title" required>
                        </div>
                        <div class="form-group">
                            <label for="content">Inhalt*</label>
                            <textarea name="content" id="content" rows="5" required></textarea>
                            <small class="form-hint">Sie k√∂nnen <a href="https://www.markdownguide.org/basic-syntax/" target="_blank">Markdown</a> f√ºr die Formatierung verwenden (z.B. **fett**, *kursiv*, Listen).</small>
                        </div>
                        <?php if (in_array($userRole, ['admin', 'planer'])): ?>
                            <fieldset class="target-group-fieldset">
                                <legend>Zielgruppe ausw√§hlen*</legend>
                                <div class="form-group" id="target-class-container">
                                    <label for="target_class_id">Klassenspezifisch (nur Sch√ºler)</label>
                                    <select name="target_class_id" id="target_class_id">
                                        <option value="">-- Klasse w√§hlen --</option>
                                        <?php foreach ($availableClasses as $class): ?>
                                            <option value="<?php echo htmlspecialchars($class['class_id']); ?>">
                                                <?php echo htmlspecialchars($class['class_id'] . ' - ' . $class['class_name']); ?>
                                            </option>
                                        <?php endforeach; ?>
                                    </select>
                                    <small class="form-hint">ODER eine der folgenden Optionen w√§hlen:</small>
                                </div>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="target_global" id="target_global" value="1">
                                        Globale Ank√ºndigung (Alle Nutzer)
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="target_teacher" id="target_teacher" value="1">
                                        Nur f√ºr Lehrer
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="target_planer" id="target_planer" value="1">
                                        Nur f√ºr Planer
                                    </label>
                                </div>
                                <small class="form-hint error-hint" id="target-error" style="display: none; color: var(--color-danger); font-weight: bold;">Bitte eine Klasse ODER genau eine Checkbox ausw√§hlen.</small>
                            </fieldset>
                            <div class="form-group">
                                <label for="attachment">Anhang (optional, max 5MB)</label>
                                <input type="file" name="attachment" id="attachment">
                                <small class="form-hint">Erlaubte Typen: JPG, PNG, PDF, DOC, DOCX</small>
                                <div id="current-attachment-info" style="display: none; margin-top: 5px;">
                                    Aktueller Anhang: <a href="#" id="current-attachment-link" target="_blank"></a>
                                    <label style="margin-left: 10px;">
                                        <input type="checkbox" name="remove_attachment" id="remove_attachment" value="1"> Anhang entfernen
                                    </label>
                                </div>
                            </div>
                        <?php elseif ($userRole === 'lehrer'): ?>
                            <input type="hidden" name="target_role_fixed" value="schueler">
                            <div class="form-group">
                                <label for="target_class_id">Klasse*</label>
                                <select name="target_class_id" id="target_class_id" required>
                                    <option value="">Bitte w√§hlen...</option>
                                    <?php foreach ($availableClasses as $class): ?>
                                        <option value="<?php echo htmlspecialchars($class['class_id']); ?>">
                                            <?php echo htmlspecialchars($class['class_id'] . ' - ' . $class['class_name']); ?>
                                        </option>
                                    <?php endforeach; ?>
                                </select>
                                <small>Sie k√∂nnen nur Ank√ºndigungen f√ºr Sch√ºler einer Klasse erstellen.</small>
                            </div>
                        <?php endif; ?>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="cancel-edit-announcement" style="display: none;">Abbrechen</button>
                            <button type="submit" class="btn btn-primary">Speichern</button>
                        </div>
                    </form>
                </div>
                <div class="table-container announcements-list">
                    <h3>Bestehende Ank√ºndigungen</h3>
                     <div id="announcements-table-container">
                         <?php if (empty($allAnnouncements)): ?>
                             <p>Keine Ank√ºndigungen vorhanden.</p>
                         <?php else: ?>
                             <table class="data-table" id="announcements-table">
                                 <thead>
                                     <tr>
                                         <th>Titel</th>
                                         <th>Autor</th>
                                         <th>Zielgruppe</th>
                                         <th>Datum</th>
                                         <th>Anhang</th>
                                         <th>Aktionen</th>
                                     </tr>
                                 </thead>
                                 <tbody>
                                     <?php foreach ($allAnnouncements as $ann):
                                         $targetDisplay = '';
                                         if ($ann['is_global']) { $targetDisplay = 'Global'; }
                                         elseif ($ann['class_id']) { $targetDisplay = 'Klasse: ' . htmlspecialchars($ann['target_class_name'] ?? $ann['class_id']); }
                                         else { $targetDisplay = 'Unbekannt'; } // Fallback, sollte nicht vorkommen mit neuer Logik
                                     ?>
                                     <tr data-id="<?php echo $ann['announcement_id']; ?>"
                                         data-title="<?php echo htmlspecialchars($ann['title']); ?>"
                                         data-content="<?php echo htmlspecialchars($ann['content']); ?>"
                                         data-is-global="<?php echo $ann['is_global']; ?>"
                                         data-class-id="<?php echo htmlspecialchars($ann['class_id'] ?? ''); ?>"
                                         data-file-path="<?php echo htmlspecialchars($ann['file_path'] ?? ''); ?>"
                                         data-user-id="<?php echo $ann['user_id']; ?>">
                                         <td><?php echo htmlspecialchars($ann['title']); ?></td>
                                         <td><?php echo htmlspecialchars($ann['author_name'] ?? 'Unbekannt'); ?></td>
                                         <td><?php echo $targetDisplay; ?></td>
                                         <td><?php echo htmlspecialchars(date('d.m.Y H:i', strtotime($ann['created_at']))); ?></td>
                                          <td>
                                              <?php if (!empty($ann['file_url'])): ?>
                                                  <a href="<?php echo htmlspecialchars($ann['file_url']); ?>" target="_blank" title="<?php echo htmlspecialchars(basename($ann['file_path'] ?? 'Anhang')); ?>">
                                                      üìé Anhang
                                                  </a>
                                              <?php else: ?>
                                                  -
                                              <?php endif; ?>
                                          </td>
                                         <td class="actions">
                                             <?php
                                               $canModify = in_array($userRole, ['admin', 'planer']) || ($userRole === 'lehrer' && $ann['user_id'] == $_SESSION['user_id']);
                                             ?>
                                             <?php if ($canModify): ?>
                                                 <!-- <button class="btn btn-warning btn-small edit-announcement">Bearbeiten</button> -->
                                                 <button class="btn btn-danger btn-small delete-announcement">L√∂schen</button>
                                             <?php endif; ?>
                                         </td>
                                     </tr>
                                     <?php endforeach; ?>
                                 </tbody>
                             </table>
                         <?php endif; ?>
                     </div>
                </div>
            </div>
        </main>
    </div>
</div>
<?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\Announcements.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\audit_logs.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper admin-dashboard-wrapper">
    <h1 class="main-title">Audit Log (Aktionsprotokoll)</h1>
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; ?>
        <main class="dashboard-content" id="audit-log-management">
            <!-- Sektion f√ºr Filter -->
            <div class.="dashboard-section" id="filter-section">
                 <div class="form-container" style="background-color: var(--color-surface-alt); margin-bottom: 20px;">
                    <form id="audit-filter-form" class="filter-form">
                        <div class="filter-grid">
                            <!-- Benutzerfilter -->
                            <div class="form-group">
                                <label for="filter-user">Benutzer</label>
                                <select name="user_id" id="filter-user">
                                    <option value="">Alle Benutzer</option>
                                    <?php foreach ($availableUsers as $user): ?>
                                        <option value="<?php echo $user['user_id']; ?>">
                                            <?php echo htmlspecialchars($user['last_name'] . ', ' . $user['first_name'] . ' (' . $user['username'] . ')'); ?>
                                        </option>
                                    <?php endforeach; ?>
                                </select>
                            </div>
                            <!-- Aktionsfilter -->
                            <div class="form-group">
                                <label for="filter-action">Aktion</label>
                                <select name="action" id="filter-action">
                                    <option value="">Alle Aktionen</option>
                                     <?php foreach ($availableActions as $action): ?>
                                        <option value="<?php echo htmlspecialchars($action); ?>">
                                            <?php echo htmlspecialchars($action); ?>
                                        </option>
                                    <?php endforeach; ?>
                                </select>
                            </div>
                            <!-- Datumsfilter (Von) -->
                            <div class="form-group">
                                <label for="filter-date-from">Von Datum</label>
                                <input type="date" name="date_from" id="filter-date-from">
                            </div>
                            <!-- Datumsfilter (Bis) -->
                            <div class="form-group">
                                <label for="filter-date-to">Bis Datum</label>
                                <input type="date" name="date_to" id="filter-date-to">
                            </div>
                        </div>
                        <div class="form-actions" style="margin-top: 10px;">
                            <button type="submit" class="btn btn-primary btn-small" style="width: 150px; margin-bottom: 0;">Filtern</button>
                            <button type="reset" class="btn btn-secondary btn-small" id="filter-reset-btn" style="width: 150px; margin-bottom: 0;">Zur√ºcksetzen</button>
                        </div>
                    </form>
                 </div>
            </div>
            <!-- Sektion f√ºr die Log-Tabelle -->
            <div class="dashboard-section active" id="log-list-section">
                <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3>Protokoll-Eintr√§ge</h3>
                    <div id="pagination-summary" class="pagination-summary" style="font-size: 0.9rem; color: var(--color-text-muted);"></div>
                </div>
                <div class="table-container">
                    <div class="table-responsive">
                        <table class="data-table" id="audit-logs-table">
                            <thead>
                                <tr>
                                    <th style="width: 150px;">Zeitstempel</th>
                                    <th style="width: 180px;">Benutzer</th>
                                    <th style="width: 130px;">Aktion</th>
                                    <th style_width="100px;">Ziel-Typ</th>
                                    <th style="width: 80px;">Ziel-ID</th>
                                    <th>Details</th>
                                    <th style="width: 110px;">IP-Adresse</th>
                                </tr>
                            </thead>
                            <tbody id="audit-logs-tbody">
                                <!-- Inhalt wird per JS geladen -->
                                <tr><td colspan="7" style="text-align: center; padding: 40px;">
                                    <div class="loading-spinner"></div>
                                </td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- Paginierung -->
                <div class="pagination-controls" id="pagination-controls" style="margin-top: 20px; display: flex; justify-content: center; align-items: center; gap: 10px;">
                    <!-- Paginierung wird per JS erstellt -->
                </div>
            </div>
        </main>
    </div>
</div>
<?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\audit_logs.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\community_moderation.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper admin-dashboard-wrapper">
    <h1 class="main-title">Moderation Schwarzes Brett</h1>
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; ?>
        <main class="dashboard-content" id="community-moderation">
            <!-- NEU: Tab Navigation -->
            <nav class="tab-navigation">
                <button class="tab-button active" data-target="pending-section">
                    Ausstehend (<?php echo count($pendingPosts); ?>)
                </button>
                <button class="tab-button" data-target="approved-section">
                    Freigegeben (<?php echo count($approvedPosts); ?>)
                </button>
            </nav>
            <!-- NEU: Tab Content Wrapper -->
            <div class="tab-content">
                <!-- Tab 1: Ausstehende Beitr√§ge -->
                <div class="dashboard-section active" id="pending-section">
                    <h3>Ausstehende Beitr√§ge</h3>
                    <p>Diese Beitr√§ge wurden von Sch√ºlern erstellt und warten auf Freigabe.</p>
                    <div id="pending-posts-list" class="posts-list-container">
                        <?php if (empty($pendingPosts)): ?>
                            <p class="message info">Aktuell gibt es keine Beitr√§ge, die moderiert werden m√ºssen.</p>
                        <?php else: ?>
                            <?php foreach ($pendingPosts as $post): ?>
                                <div class="community-post-item moderation-item" data-id="<?php echo $post['post_id']; ?>">
                                    <div class="post-header">
                                        <strong class="post-title"><?php echo htmlspecialchars($post['title']); ?></strong>
                                        <span class="post-meta">
                                            Von: <?php echo htmlspecialchars($post['first_name'] . ' ' . $post['last_name']); ?> (@<?php echo htmlspecialchars($post['username']); ?>)
                                            <br>
                                            Am: <?php echo date('d.m.Y H:i', strtotime($post['created_at'])); ?>
                                        </span>
                                    </div>
                                    <div class="post-content-preview">
                                        <?php echo $post['content_html']; // HTML aus Parsedown (als "safe" markiert) ?>
                                    </div>
                                    <div class="moderation-actions">
                                        <button class="btn btn-success btn-small approve-post-btn" data-id="<?php echo $post['post_id']; ?>">Freigeben</button>
                                        <button class="btn btn-danger btn-small reject-post-btn" data-id="<?php echo $post['post_id']; ?>">Ablehnen & L√∂schen</button>
                                    </div>
                                </div>
                            <?php endforeach; ?>
                        <?php endif; ?>
                    </div>
                </div> <!-- Ende #pending-section -->
                <!-- Tab 2: Freigegebene Beitr√§ge -->
                <div class="dashboard-section" id="approved-section">
                    <h3>Freigegebene Beitr√§ge</h3>
                    <p>Dies sind alle aktuell sichtbaren Beitr√§ge auf dem Schwarzen Brett. Sie k√∂nnen hier bereits freigegebene Beitr√§ge wieder l√∂schen.</p>
                    <div id="approved-posts-list" class="posts-list-container">
                        <?php if (empty($approvedPosts)): ?>
                            <p class="message info">Aktuell sind keine Beitr√§ge freigegeben.</p>
                        <?php else: ?>
                            <?php foreach ($approvedPosts as $post): ?>
                                <div class="community-post-item moderation-item" data-id="<?php echo $post['post_id']; ?>">
                                    <div class="post-header">
                                        <strong class="post-title"><?php echo htmlspecialchars($post['title']); ?></strong>
                                        <span class="post-meta">
                                            Von: <?php echo htmlspecialchars($post['first_name'] . ' ' . $post['last_name']); ?> (@<?php echo htmlspecialchars($post['username']); ?>)
                                            <br>
                                            Am: <?php echo date('d.m.Y H:i', strtotime($post['created_at'])); ?>
                                            <?php if ($post['moderator_id']): // Zeige Moderationsdatum, falls vorhanden ?>
                                                <br><i>Freigegeben am: <?php echo date('d.m.Y H:i', strtotime($post['moderated_at'])); ?></i>
                                            <?php endif; ?>
                                        </span>
                                    </div>
                                    <div class="post-content-preview">
                                        <?php echo $post['content_html']; // HTML aus Parsedown ?>
                                    </div>
                                    <div class="moderation-actions">
                                        <button class="btn btn-danger btn-small delete-approved-btn" data-id="<?php echo $post['post_id']; ?>">Endg√ºltig L√∂schen</button>
                                    </div>
                                </div>
                            <?php endforeach; ?>
                        <?php endif; ?>
                    </div>
                </div> <!-- Ende #approved-section -->
            </div> <!-- Ende .tab-content -->
        </main>
    </div>
</div>
<?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\community_moderation.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\csv_template.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper admin-dashboard-wrapper">
    <h1 class="main-title">CSV-Importvorlage (Benutzer)</h1>
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; ?>
        <main class="dashboard-content" id="csv-template-view">
            <div class="dashboard-section active">
                <div class="section-header">
                    <h3>Vorschau der Vorlagenstruktur</h3>
                    <a href="<?php echo htmlspecialchars(rtrim($config['base_url'], '/')); ?>/assets/templates/user_import_template.csv" download="user_import_template.csv" class="btn btn-primary" style="width: auto; margin-bottom: 0;">
                        Vorlage herunterladen
                    </a>
                </div>
                <p>Die CSV-Datei muss exakt diese Spalten in dieser Reihenfolge enthalten. Die erste Zeile muss die Header-Zeile sein. Die Zeilen 2 und 3 sind Beispiele.</p>
                <?php if (isset($templateData['error'])): ?>
                    <p class="message error"><?php echo htmlspecialchars($templateData['error']); ?></p>
                <?php elseif (!empty($templateData['headers'])): ?>
                    <div class="table-container" style="margin-top: 20px;">
                        <div class="table-responsive">
                            <table class="data-table csv-preview-table">
                                <thead>
                                    <tr>
                                        <?php foreach ($templateData['headers'] as $header): ?>
                                            <th><?php echo htmlspecialchars($header); ?></th>
                                        <?php endforeach; ?>
                                    </tr>
                                </thead>
                                <tbody>
                                    <?php foreach ($templateData['rows'] as $row): ?>
                                        <tr>
                                            <?php foreach ($row as $cell): ?>
                                                <td><?php echo htmlspecialchars($cell); ?></td>
                                            <?php endforeach; ?>
                                        </tr>
                                    <?php endforeach; ?>
                                    <?php if (empty($templateData['rows'])): ?>
                                        <tr>
                                            <td colspan="<?php echo count($templateData['headers']); ?>"><i>Die Vorlagendatei enth√§lt keine Beispielzeilen.</i></td>
                                        </tr>
                                    <?php endif; ?>
                                </tbody>
                            </table>
                        </div>
                    </div>
                <?php else: ?>
                     <p class="message error">Die Vorlagendatei ist leer oder konnte nicht korrekt gelesen werden.</p>
                <?php endif; ?>
            </div>
        </main>
    </div>
</div>
<?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\csv_template.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\dashboard.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper admin-dashboard-wrapper">
    <h1 class="main-title">Admin Dashboard</h1>
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; ?>
        <main class="dashboard-content" id="admin-dashboard-overview">
            <?php if (isset($dashboardData['error'])): ?>
                <div class="message error"><?php echo htmlspecialchars($dashboardData['error']); ?></div>
            <?php endif; ?>
            <div class="dashboard-widget-grid" id="dashboard-widget-grid">
                <div class="dashboard-widget widget-stats" draggable="true" id="widget-stats">
                    <h3>üìä System√ºbersicht</h3>
                    <div class="stat-grid">
                        <div class="stat-item main-stat">
                            <span class="stat-value"><?php echo $dashboardData['totalUsers'] ?? 0; ?></span>
                            <span class="stat-label">Benutzer gesamt</span>
                        </div>
                        <div class="stat-item sub-stat">
                            <span class="stat-value"><?php echo $dashboardData['userCounts']['schueler'] ?? 0; ?></span>
                            <span class="stat-label">Sch√ºler</span>
                        </div>
                        <div class="stat-item sub-stat">
                            <span class="stat-value"><?php echo $dashboardData['userCounts']['lehrer'] ?? 0; ?></span>
                            <span class="stat-label">Lehrer</span>
                        </div>
                        <div class="stat-item sub-stat">
                            <span class="stat-value"><?php echo $dashboardData['userCounts']['planer'] ?? 0; ?></span>
                            <span class="stat-label">Planer</span>
                        </div>
                        <div class="stat-item sub-stat">
                            <span class="stat-value"><?php echo $dashboardData['userCounts']['admin'] ?? 0; ?></span>
                            <span class="stat-label">Admins</span>
                        </div>
                    </div>
                    <hr class="stat-divider">
                    <div class="stat-grid bottom-grid">
                        <div class="stat-item">
                            <span class="stat-value"><?php echo $dashboardData['classCount'] ?? 0; ?></span>
                            <span class="stat-label">Klassen</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value"><?php echo $dashboardData['teacherCount'] ?? 0; ?></span>
                            <span class="stat-label">Lehrerprofile</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value"><?php echo $dashboardData['subjectCount'] ?? 0; ?></span>
                            <span class="stat-label">F√§cher</span>
                        </div>
                         <div class="stat-item">
                            <span class="stat-value"><?php echo $dashboardData['roomCount'] ?? 0; ?></span>
                            <span class="stat-label">R√§ume</span>
                        </div>
                    </div>
                </div>
                <div class="dashboard-widget widget-maintenance" draggable="true" id="widget-maintenance">
                    <h3>üîß Wartungsmodus</h3>
                    <div class="setting-control" style="justify-content: space-between;">
                        <label class="toggle-switch">
                            <input type="checkbox"
                                   id="dashboard_maintenance_mode"
                                   name="maintenance_mode"
                                   value="1"
                                   <?php echo($dashboardData['settings']['maintenance_mode'] ? 'checked' : ''); ?>
                                   data-csrf-token="<?php echo htmlspecialchars(\App\Core\Security::getCsrfToken()); ?>"> <?php  ?>
                            <span class="slider round"></span>
                        </label>
                        <span id="dashboard-maintenance-status" class="toggle-status" style="font-weight: bold;">
                             <?php echo($dashboardData['settings']['maintenance_mode'] ? 'Aktiviert' : 'Deaktiviert'); ?>
                        </span>
                    </div>
                    <p style="font-size: 0.85rem; color: var(--color-text-muted); margin-top: 10px;">
                        Schaltet den Zugang f√ºr Sch√ºler und Lehrer an/aus.
                        <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/settings')); ?>" style="font-size: inherit;">Nachricht/Whitelist anpassen</a>
                    </p>
                    <span id="maintenance-toggle-spinner" class="loading-spinner small" style="display: none; margin-left: 15px;"></span>
                </div>
                <div class="dashboard-widget widget-publish-status" draggable="true" id="widget-publish-status">
                    <h3>üöÄ Ver√∂ffentlichungsstatus</h3>
                    <div class="publish-status-group">
                        <strong>Aktuelle Woche (KW <?php echo htmlspecialchars($dashboardData['publishStatus']['currentWeekNum'] ?? '-'); ?>):</strong>
                        <div class="status-indicators">
                            <span class="status-indicator <?php echo($dashboardData['publishStatus']['current']['student'] ?? false) ? 'published' : 'not-published'; ?>">
                                Sch√ºler
                            </span>
                            <span class="status-indicator <?php echo($dashboardData['publishStatus']['current']['teacher'] ?? false) ? 'published' : 'not-published'; ?>">
                                Lehrer
                            </span>
                        </div>
                    </div>
                    <div class="publish-status-group">
                        <strong>N√§chste Woche (KW <?php echo htmlspecialchars($dashboardData['publishStatus']['nextWeekNum'] ?? '-'); ?>):</strong>
                        <div class="status-indicators">
                            <span class="status-indicator <?php echo($dashboardData['publishStatus']['next']['student'] ?? false) ? 'published' : 'not-published'; ?>">
                                Sch√ºler
                            </span>
                            <span class="status-indicator <?php echo($dashboardData['publishStatus']['next']['teacher'] ?? false) ? 'published' : 'not-published'; ?>">
                                Lehrer
                            </span>
                        </div>
                    </div>
                    <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('planer/dashboard')); ?>" class="widget-link">Jetzt verwalten &raquo;</a>
                </div>
                <div class="dashboard-widget widget-activity" draggable="true" id="widget-activity">
                    <h3>üïí Letzte Aktivit√§ten</h3>
                    <?php if (!empty($dashboardData['latestLogs'])): ?>
                        <ul class="activity-list">
                            <?php foreach ($dashboardData['latestLogs'] as $log): ?>
                                <li>
                                    <span class="log-time"><?php echo date('d.m. H:i', strtotime($log['timestamp'])); ?>:</span>
                                    <span class="log-user"><?php echo htmlspecialchars($log['username'] ?? 'System'); ?></span>
                                    <span class="log-action"><?php echo htmlspecialchars($log['action']); ?></span>
                                    <?php if ($log['target_type'] || $log['target_id']): ?>
                                        <span class="log-target">(<?php echo htmlspecialchars($log['target_type'] ?? ''); ?> <?php echo htmlspecialchars($log['target_id'] ?? ''); ?>)</span>
                                    <?php endif; ?>
                                </li>
                            <?php endforeach; ?>
                        </ul>
                    <?php else: ?>
                        <p style="margin-bottom: 15px;">Keine Protokolleintr√§ge vorhanden.</p>
                    <?php endif; ?>
                     <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/audit-logs')); ?>" class="widget-link">Vollst√§ndiges Log anzeigen &raquo;</a>
                </div>
                 <div class="dashboard-widget widget-quicklinks" draggable="true" id="widget-quicklinks">
                    <h3>üöÄ Schnellzugriffe</h3>
                    <div class="quicklink-buttons">
                         <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/users')); ?>" class="btn btn-secondary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M15 14s1 0 1-1-1-4-6-4-6 3-6 4 1 1 1 1zM11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 9a5 5 0 0 0-5 5v1h10v-1a5 5 0 0 0-5-5"/></svg>
                            Benutzer
                         </a>
                         <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/stammdaten')); ?>" class="btn btn-secondary">
                             <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/></svg>
                            Stammdaten
                        </a>
                         <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('planer/dashboard')); ?>" class="btn btn-secondary">
                             <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/></svg>
                            Planer
                        </a>
                         <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/settings')); ?>" class="btn btn-secondary">
                             <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311a1.464 1.464 0 0 1-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413-1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/></svg>
                            Einstellungen
                        </a>
                    </div>
                </div>
                <div class="dashboard-widget widget-system-status" draggable="true" id="widget-system-status">
                    <h3>‚úÖ System-Status</h3>
                    <ul class="system-check-list">
                        <?php if (empty($dashboardData['systemChecks'])): ?>
                            <li>Status-Checks konnten nicht geladen werden.</li>
                        <?php else: ?>
                            <?php foreach ($dashboardData['systemChecks'] as $check): ?>
                                <li class="<?php echo $check['status'] ? 'status-ok' : 'status-fail'; ?>"
                                    title="<?php echo htmlspecialchars($check['tooltip'] ?? $check['label']); ?>">
                                    <div class="status-info">
                                        <span class="status-icon"><?php echo $check['status'] ? '‚úî' : '‚ùå'; ?></span>
                                        <span class="status-label"><?php echo htmlspecialchars($check['label']); ?>:</span>
                                    </div>
                                    <span class="status-message"><?php echo htmlspecialchars($check['message']); ?></span>
                                </li>
                            <?php endforeach; ?>
                        <?php endif; ?>
                    </ul>
                     <p style="font-size: 0.8rem; color: var(--color-text-muted); margin-top: 10px; margin-bottom: 0;">
                        Basale √úberpr√ºfung der Systemkomponenten.
                    </p>
                    <div class="widget-action-footer">
                         <button class="btn btn-warning btn-small" id="clear-cache-btn" data-csrf-token="<?php echo htmlspecialchars(\App\Core\Security::getCsrfToken()); ?>">
                            Einstellungen-Cache leeren
                         </button>
                         <span id="cache-clear-spinner" class="loading-spinner small" style="display: none;"></span>
                    </div>
                </div>
                <div class="dashboard-widget widget-system-info" draggable="true" id="widget-system-info">
                    <h3>üñ•Ô∏è System-Info</h3>
                    <div class="system-info-list">
                        <div class="info-item">
                            <span class="info-label">PHP-Version</span>
                            <span class="info-value"><?php echo htmlspecialchars($dashboardData['systemInfo']['php'] ?? 'N/A'); ?></span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">DB-Version</span>
                            <span class="info-value"><?php echo htmlspecialchars($dashboardData['systemInfo']['db'] ?? 'N/A'); ?></span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Webserver</span>
                            <span class="info-value"><?php echo htmlspecialchars($dashboardData['systemInfo']['webserver'] ?? 'N/A'); ?></span>
                        </div>
                    </div>
                </div>
            </div> </main>
    </div>
</div>
<?php
?>
<script type="module">
    import { apiFetch } from '<?php echo htmlspecialchars(rtrim($config['base_url'], '/')); ?>/assets/js/api-client.js';
    import { showToast } from '<?php echo htmlspecialchars(rtrim($config['base_url'], '/')); ?>/assets/js/notifications.js';
    const maintenanceToggle = document.getElementById('dashboard_maintenance_mode');
    const maintenanceStatus = document.getElementById('dashboard-maintenance-status');
    const maintenanceSpinner = document.getElementById('maintenance-toggle-spinner');
    if (maintenanceToggle && maintenanceStatus) {
        maintenanceToggle.addEventListener('change', async () => {
            const isChecked = maintenanceToggle.checked;
            const csrfToken = maintenanceToggle.dataset.csrfToken;
            if (maintenanceSpinner) maintenanceSpinner.style.display = 'inline-block';
            maintenanceToggle.disabled = true;
            const formData = new FormData();
            formData.append('maintenance_mode', isChecked ? '1' : '0');
            formData.append('_csrf_token', csrfToken);
            formData.append('site_title', <?php echo json_encode($dashboardData['settings']['site_title'] ?? ''); ?>);
            formData.append('maintenance_message', <?php echo json_encode($dashboardData['settings']['maintenance_message'] ?? ''); ?>);
            formData.append('maintenance_whitelist_ips', <?php echo json_encode($dashboardData['settings']['maintenance_whitelist_ips'] ?? ''); ?>);
            formData.append('default_start_hour', <?php echo json_encode($dashboardData['settings']['default_start_hour'] ?? '1'); ?>);
            formData.append('default_end_hour', <?php echo json_encode($dashboardData['settings']['default_end_hour'] ?? '10'); ?>);
            formData.append('max_login_attempts', <?php echo json_encode($dashboardData['settings']['max_login_attempts'] ?? '5'); ?>);
            formData.append('lockout_minutes', <?php echo json_encode($dashboardData['settings']['lockout_minutes'] ?? '15'); ?>);
            formData.append('default_theme', <?php echo json_encode($dashboardData['settings']['default_theme'] ?? 'light'); ?>);
            formData.append('ical_enabled', '<?php echo $dashboardData['settings']['ical_enabled'] ? '1' : '0'; ?>');
            formData.append('ical_weeks_future', '<?php echo htmlspecialchars($dashboardData['settings']['ical_weeks_future'] ?? '8'); ?>');
            formData.append('pdf_footer_text', <?php echo json_encode($dashboardData['settings']['pdf_footer_text'] ?? ''); ?>);
            try {
                const response = await apiFetch('<?php echo htmlspecialchars(\App\Core\Utils::url('api/admin/settings/save')); ?>', {
                    method: 'POST',
                    body: formData
                });
                if (response.success) {
                    maintenanceStatus.textContent = isChecked ? 'Aktiviert' : 'Deaktiviert';
                    maintenanceStatus.style.color = isChecked ? 'var(--color-success)' : 'var(--color-text-muted)';
                    showToast(`Wartungsmodus ${isChecked ? 'aktiviert' : 'deaktiviert'}.`, 'success');
                    const newToken = document.querySelector('meta[name="csrf-token"]')?.getAttribute('content');
                    if (newToken) maintenanceToggle.dataset.csrfToken = newToken;
                } else {
                    maintenanceToggle.checked = !isChecked;
                }
            } catch (error) {
                 maintenanceToggle.checked = !isChecked;
            } finally {
                if (maintenanceSpinner) maintenanceSpinner.style.display = 'none';
                maintenanceToggle.disabled = false;
            }
        });
    }
    const clearCacheBtn = document.getElementById('clear-cache-btn');
    const cacheSpinner = document.getElementById('cache-clear-spinner');
    if (clearCacheBtn && cacheSpinner) {
        clearCacheBtn.addEventListener('click', async () => {
            const csrfToken = clearCacheBtn.dataset.csrfToken;
            clearCacheBtn.disabled = true;
            cacheSpinner.style.display = 'inline-block';
            try {
                const response = await apiFetch('<?php echo htmlspecialchars(\App\Core\Utils::url('api/admin/cache/clear')); ?>', {
                    method: 'POST',
                    headers: {
                        'X-CSRF-TOKEN': csrfToken 
                    }
                });
                if (response.success) {
                    showToast(response.message, 'success');
                    const newToken = document.querySelector('meta[name="csrf-token"]')?.getAttribute('content');
                    if (newToken) {
                         clearCacheBtn.dataset.csrfToken = newToken;
                         if (maintenanceToggle) maintenanceToggle.dataset.csrfToken = newToken;
                    }
                }
            } catch (error) {
            } finally {
                clearCacheBtn.disabled = false;
                cacheSpinner.style.display = 'none';
            }
        });
    }
    const grid = document.getElementById('dashboard-widget-grid');
    let draggedItem = null;
    let placeholder = null;
    const WIDGET_ORDER_KEY = 'dashboardWidgetOrder';
    function loadWidgetOrder() {
        const savedOrder = localStorage.getItem(WIDGET_ORDER_KEY);
        if (savedOrder && grid) {
            try {
                const order = JSON.parse(savedOrder);
                order.forEach(id => {
                    const widget = document.getElementById(id);
                    if (widget) {
                        grid.appendChild(widget);
                    }
                });
            } catch (e) {
                console.error("Fehler beim Laden der Widget-Reihenfolge:", e);
                localStorage.removeItem(WIDGET_ORDER_KEY);
            }
        }
    }
    function saveWidgetOrder() {
        if (!grid) return;
        const widgets = grid.querySelectorAll('.dashboard-widget');
        const order = Array.from(widgets).map(widget => widget.id);
        localStorage.setItem(WIDGET_ORDER_KEY, JSON.stringify(order));
    }
    function createPlaceholder() {
        if (!placeholder) {
            placeholder = document.createElement('div');
            placeholder.className = 'widget-placeholder';
            if (draggedItem) {
                const rect = draggedItem.getBoundingClientRect();
                placeholder.style.height = `${rect.height}px`;
                placeholder.style.width = `${rect.width}px`; 
            }
        }
        return placeholder;
    }
    function removePlaceholder() {
        if (placeholder && placeholder.parentNode) {
            placeholder.parentNode.removeChild(placeholder);
        }
        placeholder = null;
    }
    function getDragAfterElement(container, clientX, clientY) {
        const draggableElements = [...container.querySelectorAll('.dashboard-widget:not(.dragging)')];
        return draggableElements.reduce((closest, child) => {
            const box = child.getBoundingClientRect();
            const midX = box.left + box.width / 2;
            const midY = box.top + box.height / 2;
            const distance = Math.sqrt(Math.pow(clientX - midX, 2) + Math.pow(clientY - midY, 2));
            if (distance < (closest.distance || Number.POSITIVE_INFINITY)) {
                return { distance: distance, element: child };
            } else {
                return closest;
            }
        }, { distance: Number.POSITIVE_INFINITY, element: null }).element;
    }
    if (grid) {
        loadWidgetOrder();
        grid.addEventListener('dragstart', (e) => {
            if (e.target.classList.contains('dashboard-widget')) {
                draggedItem = e.target;
                setTimeout(() => {
                    if (draggedItem) {
                        draggedItem.classList.add('dragging');
                    }
                }, 0);
                placeholder = createPlaceholder();
            } else {
                e.preventDefault();
            }
        });
        grid.addEventListener('dragend', (e) => {
            if (draggedItem) {
                draggedItem.classList.remove('dragging');
            }
            draggedItem = null;
            removePlaceholder();
        });
        grid.addEventListener('dragover', (e) => {
            e.preventDefault(); // Notwendig, um 'drop' zu erlauben
            if (!draggedItem) return;
            const target = e.target.closest('.dashboard-widget');
            if (target && target !== draggedItem && target !== placeholder) {
                const rect = target.getBoundingClientRect();
                const closestElement = getDragAfterElement(grid, e.clientX, e.clientY);
                if (closestElement) {
                     const closestRect = closestElement.getBoundingClientRect();
                     const midX = closestRect.left + closestRect.width / 2;
                     const midY = closestRect.top + closestRect.height / 2;
                    if (e.clientY >= closestRect.top && e.clientY <= closestRect.bottom) {
                         if (e.clientX < midX) {
                            grid.insertBefore(placeholder, closestElement);
                         } else {
                            grid.insertBefore(placeholder, closestElement.nextSibling);
                         }
                    } else if (e.clientY < midY) {
                         grid.insertBefore(placeholder, closestElement);
                    } else {
                         grid.insertBefore(placeholder, closestElement.nextSibling);
                    }
                } else if (!grid.contains(placeholder)) {
                    grid.appendChild(placeholder);
                }
            } else if (!target && grid === e.target && !grid.contains(placeholder)) {
                 grid.appendChild(placeholder);
            }
        });
        grid.addEventListener('drop', (e) => {
            e.preventDefault();
            if (!draggedItem || !placeholder || !placeholder.parentNode) {
                removePlaceholder();
                if(draggedItem) draggedItem.classList.remove('dragging');
                draggedItem = null;
                return;
            }
            placeholder.parentNode.insertBefore(draggedItem, placeholder);
            removePlaceholder();
            if (draggedItem) {
                draggedItem.classList.remove('dragging');
            }
            draggedItem = null;
            saveWidgetOrder();
        });
    }
</script>
<?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\dashboard.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\settings.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper admin-dashboard-wrapper">
    <h1 class="main-title">Anwendungs-Einstellungen</h1>
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; ?>
        <main class="dashboard-content" id="settings-management">
            <div class="dashboard-section active">
                <form id="settings-form" data-mode="update" method="POST" enctype="multipart/form-data">
                    <?php \App\Core\Security::csrfInput(); // CSRF-Token ?>
                    <div class="form-container settings-section">
                        <h3>Allgemein</h3>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="site_title">Seitentitel</label>
                                <p>Der Name der Anwendung, der im Header und im Browser-Tab angezeigt wird.</p>
                            </div>
                            <div class="setting-control">
                                <input type="text"
                                       id="site_title"
                                       name="site_title"
                                       value="<?php echo htmlspecialchars($currentSettings['site_title'] ?? 'PAUSE Portal'); ?>"
                                       required>
                            </div>
                        </div>
                    </div>
                    <div class="form-container settings-section" style="margin-top: 25px;">
                        <h3>Branding &amp; Design</h3>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="site_logo">Logo (Header)</label>
                                <p>Optional. Wird statt dem Seitentitel im Header angezeigt. Empfohlene H√∂he: 40px. (PNG, JPG, SVG, GIF)</p>
                            </div>
                            <div class="setting-control file-upload-control">
                                <input type="file" id="site_logo" name="site_logo" accept="image/png,image/jpeg,image/svg+xml,image/gif">
                                <div class="file-preview" id="logo-preview-container">
                                    <?php if (!empty($currentSettings['site_logo_path'])): ?>
                                        <img src="<?php echo htmlspecialchars(\App\Core\Utils::url($currentSettings['site_logo_path'])); ?>?t=<?php echo time(); ?>" alt="Logo Vorschau" class="logo-preview">
                                        <label class="remove-file-label">
                                            <input type="checkbox" name="remove_site_logo" value="1"> Logo entfernen
                                        </label>
                                    <?php else: ?>
                                        <span class="no-file">Kein Logo festgelegt.</span>
                                    <?php endif; ?>
                                </div>
                            </div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="site_favicon">Favicon</label>
                                <p>Optional. Das Icon, das im Browser-Tab angezeigt wird. (ICO, PNG, SVG)</p>
                            </div>
                            <div class="setting-control file-upload-control">
                                <input type="file" id="site_favicon" name="site_favicon" accept="image/x-icon,image/png,image/svg+xml">
                                <div class="file-preview" id="favicon-preview-container">
                                    <?php if (!empty($currentSettings['site_favicon_path'])): ?>
                                        <img src="<?php echo htmlspecialchars(\App\Core\Utils::url($currentSettings['site_favicon_path'])); ?>?t=<?php echo time(); ?>" alt="Favicon Vorschau" class="favicon-preview">
                                        <label class="remove-file-label">
                                            <input type="checkbox" name="remove_site_favicon" value="1"> Favicon entfernen
                                        </label>
                                    <?php else: ?>
                                        <span class="no-file">Kein Favicon festgelegt.</span>
                                    <?php endif; ?>
                                </div>
                            </div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="default_theme">Standard-Theme</label>
                                <p>Das Farbschema, das f√ºr G√§ste und neue Benutzer standardm√§√üig geladen wird.</p>
                            </div>
                            <div class="setting-control">
                                <select id="default_theme" name="default_theme" style="max-width: 250px;">
                                    <option value="light" <?php echo ($currentSettings['default_theme'] === 'light') ? 'selected' : ''; ?>>
                                        Hell (Light Mode)
                                    </option>
                                    <option value="dark" <?php echo ($currentSettings['default_theme'] === 'dark') ? 'selected' : ''; ?>>
                                        Dunkel (Dark Mode)
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-container settings-section" style="margin-top: 25px;">
                        <h3>System &amp; Sicherheit</h3>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="maintenance_mode">Wartungsmodus</label>
                                <p>Wenn aktiv, k√∂nnen sich nur noch Admins und Planer anmelden. Alle anderen Benutzer sehen eine Wartungsseite.</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox"
                                           id="maintenance_mode"
                                           name="maintenance_mode"
                                           value="1"
                                           <?php echo($currentSettings['maintenance_mode'] ? 'checked' : ''); ?>>
                                    <span class="slider round"></span>
                                </label>
                                <span id="maintenance-status" class="toggle-status">
                                    <?php echo($currentSettings['maintenance_mode'] ? 'Aktiviert' : 'Deaktiviert'); ?>
                                </span>
                            </div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="maintenance_message">Wartungsmeldung</label>
                                <p>Diese Nachricht wird angezeigt, wenn der Wartungsmodus aktiv ist.</p>
                            </div>
                            <div class="setting-control" style="align-items: flex-start;">
                                <textarea id="maintenance_message"
                                          name="maintenance_message"
                                          rows="3"
                                          style="min-height: 80px; width: 100%; max-width: 450px;"
                                          placeholder="Die Anwendung wird gerade gewartet..."><?php echo htmlspecialchars($currentSettings['maintenance_message'] ?? ''); ?></textarea>
                            </div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="maintenance_whitelist_ips">IP-Whitelist (Wartungsmodus)</label>
                                <p>Diese IP-Adressen k√∂nnen die Seite auch im Wartungsmodus sehen. Trennen Sie IPs durch ein Komma (,).</p>
                            </div>
                            <div class="setting-control" style="align-items: flex-start;">
                                <textarea id="maintenance_whitelist_ips"
                                          name="maintenance_whitelist_ips"
                                          rows="3"
                                          style="min-height: 80px; width: 100%; max-width: 450px;"
                                          placeholder="127.0.0.1, ::1, 192.168.1.100"><?php echo htmlspecialchars($currentSettings['maintenance_whitelist_ips'] ?? ''); ?></textarea>
                            </div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label>Login-Sperre</label>
                                <p>Konfiguriert den Schutz vor Brute-Force-Angriffen beim Login.</p>
                            </div>
                            <div class="setting-control" style="display: flex; gap: 15px;">
                                <div class="form-group" style="flex: 1; margin-bottom: 0;">
                                    <label for="max_login_attempts" style="font-weight: normal; font-size: 0.9rem;">Max. Fehlversuche</label>
                                    <input type="number"
                                           id="max_login_attempts"
                                           name="max_login_attempts"
                                           min="1" max="100"
                                           value="<?php echo htmlspecialchars($currentSettings['max_login_attempts'] ?? '5'); ?>"
                                           required>
                                    <small class="form-hint">Bevor der Account gesperrt wird.</small>
                                </div>
                                <div class="form-group" style="flex: 1; margin-bottom: 0;">
                                    <label for="lockout_minutes" style="font-weight: normal; font-size: 0.9rem;">Sperrdauer (Minuten)</label>
                                    <input type="number"
                                           id="lockout_minutes"
                                           name="lockout_minutes"
                                           min="1" max="1440"
                                           value="<?php echo htmlspecialchars($currentSettings['lockout_minutes'] ?? '15'); ?>"
                                           required>
                                    <small class="form-hint">Wie lange der Account gesperrt bleibt.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-container settings-section" style="margin-top: 25px;">
                        <h3>Planer &amp; Module</h3>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label>Standard-Stundenraster</label>
                                <p>Legt die Anzahl der Stunden fest, die im Planer standardm√§√üig angezeigt werden (z.B. 1-10).</p>
                            </div>
                            <div class="setting-control" style="display: flex; gap: 15px;">
                                <div class="form-group" style="flex: 1; margin-bottom: 0;">
                                    <label for="default_start_hour" style="font-weight: normal; font-size: 0.9rem;">Erste Stunde</label>
                                    <input type="number"
                                           id="default_start_hour"
                                           name="default_start_hour"
                                           min="1" max="12"
                                           value="<?php echo htmlspecialchars($currentSettings['default_start_hour'] ?? '1'); ?>"
                                           required>
                                </div>
                                <div class="form-group" style="flex: 1; margin-bottom: 0;">
                                    <label for="default_end_hour" style="font-weight: normal; font-size: 0.9rem;">Letzte Stunde</label>
                                    <input type="number"
                                           id="default_end_hour"
                                           name="default_end_hour"
                                           min="1" max="12"
                                           value="<?php echo htmlspecialchars($currentSettings['default_end_hour'] ?? '10'); ?>"
                                           required>
                                </div>
                            </div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="ical_enabled">iCal Kalender-Feeds</label>
                                <p>Erlaubt Benutzern (Sch√ºlern/Lehrern), ihren pers√∂nlichen Stundenplan als iCal-Feed zu abonnieren.</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox"
                                           id="ical_enabled"
                                           name="ical_enabled"
                                           value="1"
                                           <?php echo($currentSettings['ical_enabled'] ? 'checked' : ''); ?>>
                                    <span class="slider round"></span>
                                </label>
                                <span id="ical-status" class="toggle-status">
                                    <?php echo($currentSettings['ical_enabled'] ? 'Aktiviert' : 'Deaktiviert'); ?>
                                </span>
                            </div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="ical_weeks_future">iCal-Zeitraum (Zukunft)</label>
                                <p>Anzahl der Wochen, die der iCal-Feed in die Zukunft exportieren soll (Standard: 8).</p>
                            </div>
                            <div class="setting-control">
                                <div class="form-group" style="flex-basis: 150px; margin-bottom: 0;">
                                    <input type="number"
                                           id="ical_weeks_future"
                                           name="ical_weeks_future"
                                           min="1" max="52"
                                           value="<?php echo htmlspecialchars($currentSettings['ical_weeks_future'] ?? '8'); ?>"
                                           required>
                                     <small class="form-hint">Wochen (1-52)</small>
                                </div>
                            </div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="pdf_footer_text">PDF Export Footer-Text</label>
                                <p>Dieser Text erscheint unten links auf jedem PDF-Stundenplan-Export. (z.B. Schulname & Adresse)</p>
                            </div>
                            <div class="setting-control" style="flex-direction: column; align-items: flex-start;">
                                <textarea id="pdf_footer_text"
                                          name="pdf_footer_text"
                                          rows="3"
                                          style="min-height: 80px; width: 100%; max-width: 450px;"
                                          placeholder="z.B. PAUSE Portal - Deine Schule - Schulstra√üe 1"><?php echo htmlspecialchars($currentSettings['pdf_footer_text'] ?? ''); ?></textarea>
                                <small class="form-hint" style="margin-top: 8px;">Hinweis: Nur Standard-Satzzeichen (ASCII/ISO-8859-1) verwenden. Emojis oder spezielle UTF-8-Zeichen werden im PDF nicht korrekt dargestellt.</small>
                            </div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <label for="community_board_enabled">Schwarzes Brett (Community)</label>
                                <p>Aktiviert oder deaktiviert das Schwarze Brett f√ºr alle Benutzer (Sch√ºler, Lehrer, Planer).</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox"
                                           id="community_board_enabled"
                                           name="community_board_enabled"
                                           value="1"
                                           <?php echo($currentSettings['community_board_enabled'] ? 'checked' : ''); ?>>
                                    <span class="slider round"></span>
                                </label>
                                <span id="community-board-status" class="toggle-status">
                                    <?php echo($currentSettings['community_board_enabled'] ? 'Aktiviert' : 'Deaktiviert'); ?>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions" style="margin-top: 30px; border-top: 1px solid var(--color-border); padding-top: 25px;">
                        <button type="submit" class="btn btn-primary" id="save-settings-btn">
                            Einstellungen speichern
                        </button>
                        <span id="save-settings-spinner" class="loading-spinner small" style="display: none; margin-left: 15px;"></span>
                    </div>
                </form>
                <div class="form-container settings-section" style="margin-top: 30px;">
                    <h3>System-Wartung</h3>
                    <div class="setting-row">
                        <div class="setting-info">
                            <label>Anwendungs-Cache</label>
                            <p>L√∂scht alle zwischengespeicherten Daten (z.B. Stundenpl√§ne, Einstellungen). Dies kann helfen, Anzeigefehler nach √Ñnderungen zu beheben.</p>
                        </div>
                        <div class="setting-control cache-control-section" style="flex-direction: column; align-items: flex-start;">
                            <input type="hidden" id="cache_csrf_token" value="<?php echo htmlspecialchars(\App\Core\Security::getCsrfToken()); ?>">
                            <button type="button" id="clear-cache-btn" class="btn btn-secondary" style="width: auto; margin-bottom: 0;">
                                Cache jetzt leeren
                            </button>
                            <small id="cache-clear-status" class="form-text" style="margin-top: 10px; display: block;"></small>
                        </div>
                    </div>
                </div>
                </div>
        </main>
    </div>
</div>
<?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\settings.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\stammdaten.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper admin-dashboard-wrapper">
    <h1 class="main-title">Stammdatenverwaltung</h1>
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; ?>
        <main class="dashboard-content" id="stammdaten-management">
            <nav class="tab-navigation">
                <button class="tab-button active" data-target="subjects-section">F√§cher</button>
                <button class="tab-button" data-target="rooms-section">R√§ume</button>
                <button class="tab-button" data-target="teachers-section">Lehrer</button>
                <button class="tab-button" data-target="classes-section">Klassen</button>
            </nav>
            <div class="tab-content">
                <div class="dashboard-section active" id="subjects-section">
                    <div class="form-container" id="subject-form-container">
                        <h4>Fach anlegen/bearbeiten</h4>
                        <form id="subject-form" data-mode="create">
                             <?php \App\Core\Security::csrfInput(); // Add CSRF input field ?>
                            <input type="hidden" name="subject_id" id="subject_id">
                            <div class="form-group">
                                <label for="subject_name">Fachname*</label>
                                <input type="text" name="subject_name" id="subject_name" required>
                            </div>
                            <div class="form-group">
                                <label for="subject_shortcut">K√ºrzel*</label>
                                <input type="text" name="subject_shortcut" id="subject_shortcut" required>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">Speichern</button>
                                <button type="button" class="btn btn-secondary" id="cancel-edit-subject" style="display: none;">Abbrechen</button>
                            </div>
                        </form>
                    </div>
                    <div class="table-container">
                        <h3>Bestandsdaten F√§cher</h3>
                        <div class="table-responsive">
                            <table class="data-table" id="subjects-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Fachname</th>
                                        <th>K√ºrzel</th>
                                        <th>Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="4">Lade F√§cher...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="dashboard-section" id="rooms-section">
                     <div class="form-container" id="room-form-container">
                        <h4>Raum anlegen/bearbeiten</h4>
                        <form id="room-form" data-mode="create">
                             <?php \App\Core\Security::csrfInput(); // Add CSRF input field ?>
                            <input type="hidden" name="room_id" id="room_id">
                            <div class="form-group">
                                <label for="room_name">Raumname*</label>
                                <input type="text" name="room_name" id="room_name" required>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">Speichern</button>
                                <button type="button" class="btn btn-secondary" id="cancel-edit-room" style="display: none;">Abbrechen</button>
                            </div>
                        </form>
                    </div>
                    <div class="table-container">
                        <h3>Bestandsdaten R√§ume</h3>
                        <div class="table-responsive">
                            <table class="data-table" id="rooms-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Raumname</th>
                                        <th>Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="3">Lade R√§ume...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="dashboard-section" id="teachers-section">
                    <div class="form-container" id="teacher-form-container">
                        <h4>Lehrer anlegen/bearbeiten</h4>
                        <form id="teacher-form" data-mode="create">
                             <?php \App\Core\Security::csrfInput(); // Add CSRF input field ?>
                            <input type="hidden" name="teacher_id" id="teacher_id">
                             <div class="form-group">
                                <label for="teacher_shortcut">K√ºrzel*</label>
                                <input type="text" name="teacher_shortcut" id="teacher_shortcut" required>
                            </div>
                            <div class="form-group">
                                <label for="first_name">Vorname*</label>
                                <input type="text" name="first_name" id="first_name" required>
                            </div>
                            <div class="form-group">
                                <label for="last_name">Nachname*</label>
                                <input type="text" name="last_name" id="last_name" required>
                            </div>
                            <div class="form-group">
                                <label for="email">E-Mail</label>
                                <input type="email" name="email" id="email">
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">Speichern</button>
                                <button type="button" class="btn btn-secondary" id="cancel-edit-teacher" style="display: none;">Abbrechen</button>
                            </div>
                        </form>
                    </div>
                    <div class="table-container">
                        <h3>Bestandsdaten Lehrer</h3>
                        <div class="table-responsive">
                            <table class="data-table" id="teachers-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>K√ºrzel</th>
                                        <th>Vorname</th>
                                        <th>Nachname</th>
                                        <th>E-Mail</th>
                                        <th>Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="6">Lade Lehrer...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="dashboard-section" id="classes-section">
                    <div class="form-container" id="class-form-container">
                        <h4>Klasse anlegen/bearbeiten</h4>
                        <form id="class-form" data-mode="create">
                             <?php \App\Core\Security::csrfInput(); // Add CSRF input field ?>
                             <!-- Hidden input for class_id when updating -->
                             <input type="hidden" name="class_id" id="class_id_hidden">
                            <div class="form-group">
                                <label for="class_id_input">Klassennummer (ID)*</label>
                                <input type="number" name="class_id_input" id="class_id_input" required> <!-- Name changed to avoid conflict -->
                                <small class="form-hint">Diese ID ist eindeutig und kann nach dem Erstellen nicht mehr ge√§ndert werden.</small>
                            </div>
                            <div class="form-group">
                                <label for="class_name">Klassen-Akronym*</label>
                                <input type="text" name="class_name" id="class_name" required>
                            </div>
                            <div class="form-group">
                                <label for="class_teacher_id">Klassenlehrer</label>
                                <select name="class_teacher_id" id="class_teacher_id">
                                    <option value="">Kein Klassenlehrer</option>
                                    </select>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">Speichern</button>
                                <button type="button" class="btn btn-secondary" id="cancel-edit-class" style="display: none;">Abbrechen</button>
                            </div>
                        </form>
                    </div>
                    <div class="table-container">
                        <h3>Bestandsdaten Klassen</h3>
                        <div class="table-responsive">
                            <table class="data-table" id="classes-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Klassen-Akronym</th>
                                        <th>Klassenlehrer</th>
                                        <th>Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="4">Lade Klassen...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
<?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\stammdaten.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\system_health.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper admin-dashboard-wrapper">
    <h1 class="main-title">System-Status</h1>
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; ?>
        <main class="dashboard-content" id="system-health-management">
            <div class="dashboard-section active">
                <div class="health-grid">
                    <div class="health-widget widget-server">
                        <h3>Server & Datenbank</h3>
                        <ul class="health-list">
                            <li>
                                <span class="health-label">PHP Version</span>
                                <span class="health-value"><?php echo htmlspecialchars($data['phpVersion']); ?></span>
                            </li>
                            <li>
                                <span class="health-label">Server Software</span>
                                <span class="health-value"><?php echo htmlspecialchars($data['serverSoftware']); ?></span>
                            </li>
                            <li>
                                <span class="health-label">Datenbank-Status</span>
                                <?php if ($data['dbStatus']['status'] === 'ok'): ?>
                                    <span class="health-value status-ok">
                                        <i class="icon-check"></i> <?php echo htmlspecialchars($data['dbStatus']['message']); ?>
                                    </span>
                                <?php else: ?>
                                    <span class="health-value status-error">
                                        <i class="icon-x"></i> <?php echo htmlspecialchars($data['dbStatus']['message']); ?>
                                    </span>
                                <?php endif; ?>
                            </li>
                             <li>
                                <span class="health-label">Wartungsmodus</span>
                                <?php if ($data['settings']['maintenance_mode']): ?>
                                    <span class="health-value status-warn">
                                        <i class="icon-tool"></i> Aktiviert
                                    </span>
                                <?php else: ?>
                                    <span class="health-value status-ok">
                                        <i class="icon-check"></i> Deaktiviert
                                    </span>
                                <?php endif; ?>
                            </li>
                        </ul>
                    </div>
                    <div class="health-widget widget-extensions">
                        <h3>PHP-Erweiterungen</h3>
                        <ul class="health-list">
                            <?php foreach ($data['extensions'] as $ext => $isLoaded): ?>
                            <li>
                                <span class="health-label"><?php echo htmlspecialchars($ext); ?></span>
                                <?php if ($isLoaded): ?>
                                    <span class="health-value status-ok">
                                        <i class="icon-check"></i> Geladen
                                    </span>
                                <?php else: ?>
                                    <span class="health-value status-error">
                                        <i class="icon-x"></i> Nicht geladen
                                    </span>
                                <?php endif; ?>
                            </li>
                            <?php endforeach; ?>
                        </ul>
                    </div>
                    <div class="health-widget widget-permissions">
                        <h3>Verzeichnis-Berechtigungen</h3>
                        <ul class="health-list">
                             <?php foreach ($data['directoryStatus'] as $name => $dir): ?>
                            <li>
                                <span class="health-label"><?php echo htmlspecialchars($name); ?></span>
                                <?php if ($dir['status'] === 'ok'): ?>
                                    <span class="health-value status-ok">
                                        <i class="icon-check"></i> <?php echo htmlspecialchars($dir['message']); ?>
                                    </span>
                                <?php else: ?>
                                    <span class="health-value status-error">
                                        <i class="icon-x"></i> <?php echo htmlspecialchars($dir['message']); ?>
                                    </span>
                                <?php endif; ?>
                            </li>
                            <?php endforeach; ?>
                        </ul>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
<?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\system_health.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\users.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper admin-dashboard-wrapper">
    <h1 class="main-title">Benutzerverwaltung</h1>
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; ?>
        <main class="dashboard-content" id="user-management">
            <div class="dashboard-section active" id="user-import-section">
                <div class="section-header">
                    <h3>Benutzer-Massenimport (CSV)</h3>
                </div>
                <div class="form-container" style="background-color: var(--color-surface-alt);">
                    <form id="user-import-form" enctype="multipart/form-data" method="POST">
                        <?php \App\Core\Security::csrfInput(); // Add CSRF input field ?>
                        <div class="form-group">
                            <label for="csv_file">CSV-Datei ausw√§hlen*</label>
                            <input type="file" name="csv_file" id="csv_file" accept=".csv" required>
                            <small class="form-hint">
                                Die CSV-Datei muss exakt die Spalten der Vorlage enthalten.
                                <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/csv-template')); ?>" target="_blank" class="template-download-link">
                                    CSV-Vorlage
                                </a>
                            </small>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary" id="user-import-btn">Import starten</button>
                        </div>
                    </form>
                    <div id="import-results-container" style="display: none; margin-top: 20px;">
                        <h4>Importergebnisse:</h4>
                        <pre id="import-results" class="import-results-box"></pre>
                    </div>
                </div>
            </div>
            <div class="dashboard-section active" id="user-list-section">
                <div class="section-header">
                    <h3>Alle Benutzer</h3>
                </div>
                <div>
                    <div class="table-container">
                        <div class="table-responsive">
                            <table class="data-table" id="users-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Rolle</th>
                                        <th>Details</th>
                                        <th>Community</th> <th>Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="6">Lade Benutzer...</td></tr> </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="form-container">
                        <h4 id="user-form-title">Neuen Benutzer anlegen</h4>
                        <form id="user-form" data-mode="create">
                            <?php \App\Core\Security::csrfInput(); // Add CSRF input field ?>
                            <input type="hidden" name="user_id" id="user_id">
                            <div class="form-grid-col-2">
                                <div class="form-group">
                                    <label for="first_name">Vorname*</label>
                                    <input type="text" name="first_name" id="first_name" required>
                                </div>
                                <div class="form-group">
                                    <label for="last_name">Nachname*</label>
                                    <input type="text" name="last_name" id="last_name" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="username">Benutzername*</label>
                                <input type="text" name="username" id="username" required>
                            </div>
                            <div class="form-group">
                                <label for="email">E-Mail*</label>
                                <input type="email" name="email" id="email" required>
                            </div>
                            <div class="form-group">
                                <label for="password">Passwort</label>
                                <input type="password" name="password" id="password" placeholder="Beim Bearbeiten leer lassen">
                                <small class="form-hint">Mindestens 8 Zeichen. Nur beim Erstellen erforderlich.</small>
                            </div>
                            <div class="form-group">
                                <label for="birth_date">Geburtsdatum</label>
                                <input type="date" name="birth_date" id="birth_date">
                            </div>
                            <hr>
                            <div class="form-group">
                                <label for="role">Rolle*</label>
                                <select name="role" id="role" required>
                                </select>
                            </div>
                            <div id="role-specific-fields">
                                <div class="form-group" id="class-select-container" style="display: none;">
                                    <label for="class_id">Klasse</label>
                                    <select name="class_id" id="class_id">
                                    </select>
                                </div>
                                <div class="form-group" id="teacher-select-container" style="display: none;">
                                    <label for="teacher_id">Lehrerprofil</label>
                                    <select name="teacher_id" id="teacher_id">
                                    </select>
                                </div>
                                <div class="form-group" id="community-ban-container" style="display: none;">
                                    <label class="checkbox-label" for="is_community_banned">
                                        <input type="checkbox" name="is_community_banned" id="is_community_banned" value="1">
                                        F√ºr Schwarzes Brett sperren
                                    </label>
                                    <small class="form-hint">Wenn angehakt, kann dieser Sch√ºler keine Beitr√§ge sehen oder erstellen.</small>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" id="cancel-edit-user" style="display: none;">Abbrechen</button>
                                <button type="submit" class="btn btn-primary">Speichern</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
<?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\admin\users.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\auth\login.php ---
<?php
include_once __DIR__ . '/../partials/header.php';
?>
<div class="page-wrapper" style="padding-top: 100px;">
    <div class="auth-container">
        <h1 class="main-title">Login</h1>
        <?php if (!empty($message)): ?>
            <p class="message error"><?php echo htmlspecialchars($message); ?></p>
        <?php endif; ?>
        <form action="<?php echo \App\Core\Utils::url('login/process'); ?>" method="post">
            <?php \App\Core\Security::csrfInput(); // Add CSRF input field ?>
            <p>
                <label for="identifier">Benutzername oder E-Mail</label>
                <input type="text" id="identifier" name="identifier" required>
            </p>
            <p>
                <label for="password">Passwort</label>
                <input type="password" id="password" name="password" required>
            </p>
            <p>
                <input type="submit" value="Anmelden" class="btn btn-primary" style="width: 100%;">
            </p>
        </form>
    </div>
</div>
<?php
include_once __DIR__ . '/../partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\auth\login.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\errors\404.php ---
<?php
global $config;
?>
<div class="container text-center">
    <h1 class="main-title" style="font-size: 5rem; margin-bottom: 0;">404</h1>
    <p style="font-size: 1.5rem; color: var(--color-text-muted); margin-top: 0;">Stunde entfallen!</p>
    <p>Ups! Diese Seite scheint heute auszufallen. Bitte beachten Sie den digitalen Vertretungsplan und kehren Sie zur Startseite zur√ºck.</p>
    <a href="<?php echo htmlspecialchars($config['base_url']); ?>/" class="btn btn-primary" style="width: auto; margin-top: 20px;">Zur√ºck zum Stundenplan</a>
</div>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\errors\404.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\errors\503.php ---
<?php
global $config;
?>
<div class="page-wrapper" style="padding-top: 100px;">
    <div class="auth-container" style="max-width: 600px; text-align: center;">
        <h1 class="main-title" style="font-size: 2.5rem; color: var(--color-warning);">üîß Wartungsarbeiten</h1>
        <p style="font-size: 1.1rem; line-height: 1.6; color: var(--color-text-muted);">
            <?php echo nl2br(htmlspecialchars($maintenance_message ?? 'Die Anwendung wird gerade gewartet. Bitte versuchen Sie es sp√§ter erneut.')); ?>
        </p>
        <?php // Admins einen einfachen Weg zum Login geben ?>
         <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('login')); ?>" class="btn btn-secondary" style="width: auto; margin-top: 25px;">
             Zum Admin-Login
         </a>
    </div>
</div>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\errors\503.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\partials\footer.php ---
</main> <?php // Closes <main class="page-wrapper"> from header.php ?>
    <footer class="site-footer">
        <div class="footer-content container">
            <div class="copyright">
                 &copy; <?php echo date('Y'); ?> <?php echo htmlspecialchars(\App\Core\Utils::getSettings()['site_title']); ?>
                 - Ein Produkt des PMI.
            </div>
            <div class="imprint">
                <button id="imprint-toggle" class="imprint-toggle">Impressum &amp; Rechtliches</button>
                <div id="imprint-details" class="imprint-details">
                    <p>
                        <strong>Angaben gem√§√ü ¬ß 5 TMG:</strong><br>
                        Der Ultramodulare, Responsiv-Agile Kognitionsarchitekt und Interaktionsoptimierer f√ºr Gro√üsprachmodelle ‚Äì Prompt-Engineering-Meisterschafts-Zentrum<br>
                        kurz: <strong>PMI - Prompt Meister Institut</strong>
                    </p>
                    <p>
                        Future-Allee 1<br>
                        69115 Heidelberg<br>
                        Deutschland
                        </p>
                    <p>
                        <strong>Vertreten durch:</strong><br>
                        [Name des Vertretungsberechtigten]
                        </p>
                    <p>
                        <strong>Kontakt:</strong><br>
                        Telefon: +49 (0) 6221 / [Ihre Nummer]<br>
                        E-Mail: kontakt@prompt-meister-institut.de
                        </p>
                    <p>
                        <strong>Registereintrag:</strong><br>
                         Eintragung im Handelsregister.<br>
                        Registergericht: Amtsgericht Mannheim<br>
                        Registernummer: HRB [Ihre Nummer]
                         </p>
                    <p>
                        <strong>Umsatzsteuer-ID:</strong><br>
                         Umsatzsteuer-Identifikationsnummer gem√§√ü ¬ß27a Umsatzsteuergesetz:<br>
                        DE[Ihre USt-IdNr.]
                         </p>
                    <p>
                        <a href="#placeholder-privacy">Datenschutzerkl√§rung</a> |
                        <a href="#placeholder-terms">Nutzungsbedingungen</a>
                         </p>
                     <button id="imprint-close" class="imprint-close">&times; Schlie√üen</button>
                </div>
            </div>
        </div>
    </footer>
    <script type="module" src="<?php echo rtrim($config['base_url'], '/'); ?>/assets/js/main.js"></script>
</body>
</html>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\partials\footer.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\partials\header.php ---
<?php
$settings = \App\Core\Utils::getSettings();
global $config; // Ensure $config is accessible
$faviconPath = !empty($settings['site_favicon_path'])
    ? htmlspecialchars(\App\Core\Utils::url($settings['site_favicon_path']))
    : null; // Oder ein Pfad zu einem Standard-Favicon
$logoPath = !empty($settings['site_logo_path'])
    ? htmlspecialchars(\App\Core\Utils::url($settings['site_logo_path']))
    : null;
$cacheBuster = "?v=" . time();
if ($faviconPath) $faviconPath .= $cacheBuster;
if ($logoPath) $logoPath .= $cacheBuster;
?>
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="<?php echo htmlspecialchars(\App\Core\Security::getCsrfToken()); ?>">
    <title><?php echo htmlspecialchars($page_title ?? $settings['site_title']); ?></title>
    <?php // NEU: Dynamisches Favicon ?>
    <?php if ($faviconPath): ?>
        <link rel="icon" href="<?php echo $faviconPath; ?>">
    <?php endif; ?>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Oswald:wght@700&display=swap" rel="stylesheet">
    
    <!-- FullCalendar (bereits vorhanden) -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.14/index.global.min.js'></script>
    
    <!-- NEU: Flatpickr (f√ºr Datumsauswahl) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/de.js"></script>

    <script>
        (function() {
            const defaultTheme = <?php echo json_encode($settings['default_theme'] ?? 'light'); ?>;
            const theme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : defaultTheme);
            if (theme === 'dark') {
                document.documentElement.classList.add('dark-mode');
            }
        })();
        window.APP_CONFIG = {
            baseUrl: '<?php echo rtrim($config['base_url'], '/'); ?>',
            userRole: '<?php echo $_SESSION['user_role'] ?? ''; ?>',
            userId: <?php echo $_SESSION['user_id'] ?? 'null'; ?>, // Added userId for potential JS checks
            settings: <?php echo json_encode($settings); ?>
        };
    </script>
    <!-- === MODULAR CSS START (ITCSS/CUBE) === -->
    <?php
    $css_version_path = $_SERVER['DOCUMENT_ROOT'] . rtrim($config['base_url'], '/') . '/assets/css/1-settings/variables.css';
    $css_version = file_exists($css_version_path) ? filemtime($css_version_path) : time();
    $base_url = rtrim($config['base_url'], '/');
    $css_files = [
        '1-settings/variables.css',
        '3-generic/reset.css',
        '4-base/globals.css',
        '4-base/typography.css',
        '5-layout/page.css',
        '5-layout/header.css',
        '5-layout/footer.css',
        '5-layout/grid.css',
        '5-layout/sidebar.css',
        '6-components/button.css',
        '6-components/form.css',
        '6-components/table.css',
        '6-components/tabs.css',
        '6-components/messages.css',
        '6-components/modal.css',
        '6-components/widget.css',
        '6-components/post.css',
        '6-components/timetable.css',
        '6-components/user-menu.css',
        '6-components/status.css',
        '7-utilities/spacing.css',
        '7-utilities/flex.css',
        '7-utilities/helpers.css', 
        '8-pages/auth.css',
        '8-pages/admin-dashboard.css',
        '8-pages/admin-users.css',
        '8-pages/admin-announcements.css',
        '8-pages/admin-community.css',
        '8-pages/admin-settings.css',
        '8-pages/admin-audit-log.css',
        '8-pages/admin-system-health.css',
        '8-pages/admin-csv-template.css',
        '8-pages/planer-layout.css',
        '8-pages/dashboard-cockpit.css'
    ];
    ?>
    <!-- Lade alle CSS-Dateien -->
    <?php foreach ($css_files as $file): ?>
<link rel="stylesheet" href="<?php echo $base_url; ?>/assets/css/<?php echo $file; ?>?v=<?php echo $css_version; ?>">
    <?php endforeach; ?>
    <!-- === MODULAR CSS END === -->
</head>
<body class="<?php echo htmlspecialchars($body_class ?? ''); ?> role-<?php echo htmlspecialchars($_SESSION['user_role'] ?? 'guest'); ?>"> <?php  ?>
    <?php // Impersonation Banner ?>
    <?php if (isset($_SESSION['impersonator_id'])): ?>
        <div class="impersonation-banner">
            <div class="page-wrapper" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 20px;">
                <span>
                    <strong>Achtung:</strong> Sie sind angemeldet als 
                    <strong><?php echo htmlspecialchars($_SESSION['username'] ?? 'Benutzer'); ?></strong> 
                    (Rolle: <?php echo htmlspecialchars($_SESSION['user_role'] ?? 'N/A'); ?>).
                </span>
                <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('logout/revert')); ?>" class="btn btn-secondary btn-small" style="width: auto; margin-bottom: 0;">
                    Zur√ºck zum Admin-Konto
                </a>
            </div>
        </div>
    <?php endif; ?>
    <header class="page-header">
        <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('/')); ?>" class="site-logo">
            <?php // NEU: Logo-Logik ?>
            <?php if ($logoPath): ?>
                <img src="<?php echo $logoPath; ?>" alt="<?php echo htmlspecialchars($settings['site_title']); ?> Logo" class="site-logo-image" id="header-logo-img">
            <?php else: ?>
                <span id="header-logo-text"><?php echo htmlspecialchars($settings['site_title']); ?></span>
            <?php endif; ?>
        </a>
        <nav class="header-nav" id="header-nav">
            <div class="nav-right">
                <button id="theme-toggle" class="theme-toggle" title="Theme umschalten">
                    <img class="sun-icon" src="<?php echo htmlspecialchars(rtrim($config['base_url'], '/')); ?>/assets/images/sun.png" alt="Light Mode">
                    <img class="moon-icon" src="<?php echo htmlspecialchars(rtrim($config['base_url'], '/')); ?>/assets/images/moon.png" alt="Dark Mode">
                </button>
                <span class="nav-separator"></span> <?php if (isset($_SESSION['user_id'])):
                    $userRole = $_SESSION['user_role'] ?? '';
                ?>
                    <div class="user-menu">
                        <?php // KORREKTUR: id="user-menu-btn" hinzugef√ºgt ?>
                        <button id="user-menu-btn" class="user-menu-toggle" aria-haspopup="true" aria-expanded="false">
                            <span>Hallo, <?php echo htmlspecialchars($_SESSION['username']); ?></span>
                            <svg class="chevron-down" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                        </button>
                        <?php // KORREKTUR: id="user-menu-dropdown" hinzugef√ºgt ?>
                        <div id="user-menu-dropdown" class="user-menu-dropdown">
                            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('dashboard')); ?>">Mein Dashboard</a>
                            <?php if ($userRole === 'admin'): ?>
                                <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/dashboard')); ?>">Admin Bereich</a>
                            <?php elseif ($userRole === 'planer'): ?>
                                <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('planer/dashboard')); ?>">Planer Bereich</a>
                            <?php endif; ?>
                            <?php if (in_array($userRole, ['admin', 'planer', 'lehrer'])): ?>
                                <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/announcements')); ?>">Ank√ºndigungen</a>
                            <?php endif; ?>
                            <div class="dropdown-divider"></div>
                            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('logout')); ?>">Abmelden</a>
                        </div>
                    </div>
                <?php else: ?>
                    <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('login')); ?>" class="header-link">Anmelden</a>
                    <?php endif; ?>
            </div>
        </nav>
        <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-controls="header-nav" aria-expanded="false">
            <span class="visually-hidden">Men√º</span>
            <span class="hamburger-box"><span class="hamburger-inner"></span></span>
        </button>
    </header>
    <main class="page-wrapper">
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\partials\header.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\partials\_timetable_grid.php ---
<?php
$settings = \App\Core\Utils::getSettings();
global $config; // Ensure $config is accessible
$faviconPath = !empty($settings['site_favicon_path'])
    ? htmlspecialchars(\App\Core\Utils::url($settings['site_favicon_path']))
    : null; // Oder ein Pfad zu einem Standard-Favicon
$logoPath = !empty($settings['site_logo_path'])
    ? htmlspecialchars(\App\Core\Utils::url($settings['site_logo_path']))
    : null;
$cacheBuster = "?v=" . time();
if ($faviconPath) $faviconPath .= $cacheBuster;
if ($logoPath) $logoPath .= $cacheBuster;
?>
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="<?php echo htmlspecialchars(\App\Core\Security::getCsrfToken()); ?>">
    <title><?php echo htmlspecialchars($page_title ?? $settings['site_title']); ?></title>
    <?php // NEU: Dynamisches Favicon ?>
    <?php if ($faviconPath): ?>
        <link rel="icon" href="<?php echo $faviconPath; ?>">
    <?php endif; ?>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Oswald:wght@700&display=swap" rel="stylesheet">
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.14/index.global.min.js'></script>
    <script>
        (function() {
            const defaultTheme = <?php echo json_encode($settings['default_theme'] ?? 'light'); ?>;
            const theme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : defaultTheme);
            if (theme === 'dark') {
                document.documentElement.classList.add('dark-mode');
            }
        })();
        window.APP_CONFIG = {
            baseUrl: '<?php echo rtrim($config['base_url'], '/'); ?>',
            userRole: '<?php echo $_SESSION['user_role'] ?? ''; ?>',
            userId: <?php echo $_SESSION['user_id'] ?? 'null'; ?>, // Added userId for potential JS checks
            settings: <?php echo json_encode($settings); ?>
        };
    </script>
    <!-- === MODULAR CSS START (ITCSS/CUBE) === -->
    <?php
    $css_version_path = $_SERVER['DOCUMENT_ROOT'] . rtrim($config['base_url'], '/') . '/assets/css/1-settings/variables.css';
    $css_version = file_exists($css_version_path) ? filemtime($css_version_path) : time();
    $base_url = rtrim($config['base_url'], '/');
    $css_files = [
        '1-settings/variables.css',
        '3-generic/reset.css',
        '4-base/globals.css',
        '4-base/typography.css',
        '5-layout/page.css',
        '5-layout/header.css',
        '5-layout/footer.css',
        '5-layout/grid.css',
        '5-layout/sidebar.css',
        '6-components/button.css',
        '6-components/form.css',
        '6-components/table.css',
        '6-components/tabs.css',
        '6-components/messages.css',
        '6-components/modal.css',
        '6-components/widget.css',
        '6-components/post.css',
        '6-components/timetable.css',
        '6-components/user-menu.css',
        '6-components/status.css',
        '7-utilities/spacing.css',
        '7-utilities/flex.css',
        '7-utilities/helpers.css', // HINZUGEF√úGT
        '8-pages/auth.css',
        '8-pages/admin-dashboard.css',
        '8-pages/admin-users.css',
        '8-pages/admin-announcements.css',
        '8-pages/admin-community.css',
        '8-pages/admin-settings.css',
        '8-pages/admin-audit-log.css',
        '8-pages/admin-system-health.css',
        '8-pages/admin-csv-template.css',
        '8-pages/planer-layout.css',
        '8-pages/dashboard-cockpit.css'
    ];
    ?>
    <!-- Lade alle CSS-Dateien -->
    <?php foreach ($css_files as $file): ?>
<link rel="stylesheet" href="<?php echo $base_url; ?>/assets/css/<?php echo $file; ?>?v=<?php echo $css_version; ?>">
    <?php endforeach; ?>
    <!-- === MODULAR CSS END === -->
    <!-- <link rel="stylesheet" href="<?php echo htmlspecialchars(rtrim($config['base_url'], '/')); ?>/assets/css/main.css"> --> <!-- ALT, ERSETZT -->
</head>
<body class="<?php echo htmlspecialchars($body_class ?? ''); ?> role-<?php echo htmlspecialchars($_SESSION['user_role'] ?? 'guest'); ?>"> <?php  ?>
    <?php // Impersonation Banner ?>
    <?php if (isset($_SESSION['impersonator_id'])): ?>
        <div class="impersonation-banner">
            <div class="page-wrapper" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 20px;">
                <span>
                    <strong>Achtung:</strong> Sie sind angemeldet als 
                    <strong><?php echo htmlspecialchars($_SESSION['username'] ?? 'Benutzer'); ?></strong> 
                    (Rolle: <?php echo htmlspecialchars($_SESSION['user_role'] ?? 'N/A'); ?>).
                </span>
                <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('logout/revert')); ?>" class="btn btn-secondary btn-small" style="width: auto; margin-bottom: 0;">
                    Zur√ºck zum Admin-Konto
                </a>
            </div>
        </div>
    <?php endif; ?>
    <header class="page-header">
        <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('/')); ?>" class="site-logo">
            <?php // NEU: Logo-Logik ?>
            <?php if ($logoPath): ?>
                <img src="<?php echo $logoPath; ?>" alt="<?php echo htmlspecialchars($settings['site_title']); ?> Logo" class="site-logo-image" id="header-logo-img">
            <?php else: ?>
                <span id="header-logo-text"><?php echo htmlspecialchars($settings['site_title']); ?></span>
            <?php endif; ?>
        </a>
        <nav class="header-nav" id="header-nav">
            <div class="nav-right">
                <button id="theme-toggle" class="theme-toggle" title="Theme umschalten">
                    <img class="sun-icon" src="<?php echo htmlspecialchars(rtrim($config['base_url'], '/')); ?>/assets/images/sun.png" alt="Light Mode">
                    <img class="moon-icon" src="<?php echo htmlspecialchars(rtrim($config['base_url'], '/')); ?>/assets/images/moon.png" alt="Dark Mode">
                </button>
                <span class="nav-separator"></span> <?php if (isset($_SESSION['user_id'])):
                    $userRole = $_SESSION['user_role'] ?? '';
                ?>
                    <div class="user-menu">
                        <?php // KORREKTUR: id="user-menu-btn" hinzugef√ºgt ?>
                        <button id="user-menu-btn" class="user-menu-toggle" aria-haspopup="true" aria-expanded="false">
                            <span>Hallo, <?php echo htmlspecialchars($_SESSION['username']); ?></span>
                            <svg class="chevron-down" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                        </button>
                        <?php // KORREKTUR: id="user-menu-dropdown" hinzugef√ºgt ?>
                        <div id="user-menu-dropdown" class="user-menu-dropdown">
                            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('dashboard')); ?>">Mein Dashboard</a>
                            <?php if ($userRole === 'admin'): ?>
                                 <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/dashboard')); ?>">Admin Bereich</a>
                            <?php elseif ($userRole === 'planer'): ?>
                                 <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('planer/dashboard')); ?>">Planer Bereich</a>
                            <?php endif; ?>
                            <?php if (in_array($userRole, ['admin', 'planer', 'lehrer'])): ?>
                                 <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/announcements')); ?>">Ank√ºndigungen</a>
                            <?php endif; ?>
                            <div class="dropdown-divider"></div>
                            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('logout')); ?>">Abmelden</a>
                        </div>
                    </div>
                <?php else: ?>
                    <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('login')); ?>" class="header-link">Anmelden</a>
                    <?php endif; ?>
            </div>
        </nav>
        <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-controls="header-nav" aria-expanded="false">
            <span class="visually-hidden">Men√º</span>
            <span class="hamburger-box"><span class="hamburger-inner"></span></span>
        </button>
    </header>
    <main class="page-wrapper">
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\partials\_timetable_grid.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\planer\partials\_sidebar.php ---
<?php
?>
<aside class="dashboard-sidebar">
    <h2>Planer-Werkzeuge</h2>
    <nav class="dashboard-nav">
        <?php
        $currentUrl = $_SERVER['REQUEST_URI'];
        $userRole = $_SESSION['user_role'] ?? '';
        ?>
        <?php if (in_array($userRole, ['admin', 'planer'])): ?>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('planer/dashboard')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'planer/dashboard') ? 'active' : ''); ?>">
                Stundenplan-Editor
            </a>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('planer/absences')); ?>"
               class="dashboard-nav-item <?php echo (str_contains($currentUrl, 'planer/absences') ? 'active' : ''); ?>">
                Lehrer-Abwesenheiten
            </a>
            <!-- Zuk√ºnftige Planer-Links k√∂nnen hier hinzugef√ºgt werden -->
        <?php endif; ?>
        <?php if (in_array($userRole, ['admin'])): ?>
             <div class="dropdown-divider" style="margin: 15px 0; border-color: var(--color-border);"></div>
            <a href="<?php echo htmlspecialchars(\App\Core\Utils::url('admin/dashboard')); ?>"
               class="dashboard-nav-item">
                &laquo; Zur√ºck zum Admin-Dashboard
            </a>
        <?php endif; ?>
    </nav>
</aside>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\planer\partials\_sidebar.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\planer\absences.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper planer-dashboard-wrapper">
    <h1 class="main-title">Lehrer-Abwesenheiten</h1>
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; // Planer-Sidebar einbinden ?>
        <main class="dashboard-content" id="absence-management">
            <div class="dashboard-section active">
                <div class="dashboard-widget-grid" id="absence-grid">
                    <div class="dashboard-widget" id="widget-add-absence" style="grid-column: 1 / -1;">
                        <h3 id="absence-form-title">Neue Abwesenheit eintragen</h3>
                        <div class="form-container" style="background: transparent; border: none; padding: 0; box-shadow: none; margin: 0;">
                            <form id="absence-form" data-mode="create" class="absence-form-layout">
                                <?php \App\Core\Security::csrfInput(); // CSRF-Token ?>
                                <div class="form-group" id="absence-teacher-group">
                                    <label for="absence-teacher-id">Lehrer*</label>
                                    <select name="teacher_id" id="absence-teacher-id" required>
                                        <option value="">-- Lehrer w√§hlen --</option>
                                        <?php foreach ($availableTeachers as $teacher): ?>
                                            <?php // SGL herausfiltern ?>
                                            <?php if ($teacher['teacher_shortcut'] !== 'SGL'): ?>
                                                <option value="<?php echo htmlspecialchars($teacher['teacher_id']); ?>">
                                                    <?php echo htmlspecialchars($teacher['last_name'] . ', ' . $teacher['first_name'] . ' (' . $teacher['teacher_shortcut'] . ')'); ?>
                                                </option>
                                            <?php endif; ?>
                                        <?php endforeach; ?>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="absence-start-date">Von Datum*</label>
                                    <input type="date" name="start_date" id="absence-start-date" required>
                                </div>
                                <div class="form-group">
                                    <label for="absence-end-date">Bis Datum*</label>
                                    <input type="date" name="end_date" id="absence-end-date" required>
                                </div>
                                <div class="form-group">
                                    <label for="absence-reason">Grund*</label>
                                    <select name="reason" id="absence-reason" required>
                                        <option value="">-- Grund w√§hlen --</option>
                                        <?php foreach ($absenceTypes as $type): ?>
                                            <option value="<?php echo htmlspecialchars($type); ?>">
                                                <?php echo htmlspecialchars($type); ?>
                                            </option>
                                        <?php endforeach; ?>
                                    </select>
                                </div>
                                <div class="form-group" id="absence-comment-group">
                                    <label for="absence-comment">Kommentar (optional)</label>
                                    <input type="text" name="comment" id="absence-comment" placeholder="z.B. Details zur Fortbildung...">
                                </div>
                                <input type="hidden" name="absence_id" id="absence-id">
                                <div class="form-actions" id="absence-actions-group">
                                    <button type="submit" class="btn btn-primary" id="absence-save-btn">Speichern</button>
                                    <button type="button" class="btn btn-secondary" id="absence-cancel-edit-btn" style="display: none;">Abbrechen</button>
                                    <button type="button" class="btn btn-danger" id="absence-delete-btn" style="display: none; margin-left: auto;">L√∂schen</button>
                                    <span id="absence-save-spinner" class="loading-spinner small" style="display: none; margin-left: 10px;"></span>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="dashboard-widget" id="widget-absence-calendar" style="grid-column: 1 / -1;">
                        <h3>Abwesenheits-Kalender</h3>
                        <div id="absence-calendar" style="min-height: 600px; margin-top: 20px;">
                            <div class="loading-spinner"></div>
                            </div>
                    </div>
                </div>
            </div>
        </main>
    </div> </div> <?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\planer\absences.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\planer\dashboard.php ---
<?php
include_once dirname(__DIR__) . '/partials/header.php';
?>
<div class="page-wrapper planer-dashboard-wrapper">
    <!-- Main header section for the planner view -->
    <div class="planer-header">
        <h1 class="main-title">Stundenplan-Verwaltung</h1>
        <!-- Wrapper for all control elements on the right side -->
        <div class="planer-actions-wrapper">
            <!-- Filter controls section -->
            <div class="planer-controls">
                <!-- View mode switcher (Class/Teacher) -->
                <div class="form-group view-switcher">
                    <label for="view-mode-selector">Ansicht:</label>
                    <select id="view-mode-selector">
                        <option value="class" selected>Klassenansicht</option>
                        <option value="teacher">Lehreransicht</option>
                    </select>
                </div>
                 <!-- Class selector dropdown -->
                <div class="form-group" id="class-selector-container">
                    <label for="class-selector">Klasse:</label>
                    <select id="class-selector"></select>
                </div>
                 <!-- Teacher selector dropdown (initially hidden) -->
                <div class="form-group hidden" id="teacher-selector-container">
                    <label for="teacher-selector">Lehrer:</label>
                    <select id="teacher-selector"></select>
                </div>
                 <!-- Year selector -->
                <div class="form-group">
                    <label for="year-selector">Jahr:</label>
                    <select id="year-selector"></select>
                </div>
                <!-- Week selector -->
                <div class="form-group">
                    <label for="week-selector">KW:</label>
                    <select id="week-selector"></select>
                </div>
            </div> <!-- End planer-controls -->
            <!-- Publish controls section -->
            <div class="publish-controls">
                 <!-- Display area for the current week's publish status -->
                 <div class="publish-status">
                    Status KW <span id="publish-week-label">--</span>:
                    <span id="publish-status-student" class="status-indicator">Sch√ºler: ?</span>
                    <span id="publish-status-teacher" class="status-indicator">Lehrer: ?</span>
                 </div>
                 <!-- Action buttons for publishing/unpublishing -->
                 <div class="publish-actions">
                    <button id="publish-student-btn" class="btn btn-success btn-small">F√ºr Sch√ºler ver√∂ffentlichen</button>
                    <button id="publish-teacher-btn" class="btn btn-success btn-small">F√ºr Lehrer ver√∂ffentlichen</button>
                    <button id="unpublish-student-btn" class="btn btn-warning btn-small hidden">Sch√ºler zur√ºckziehen</button>
                    <button id="unpublish-teacher-btn" class="btn btn-warning btn-small hidden">Lehrer zur√ºckziehen</button>
                 </div>
            </div> <!-- End publish-controls -->
        </div> <!-- End planer-actions-wrapper -->
    </div> <!-- End planer-header -->
    <!-- NEU: Grid-Layout f√ºr Sidebar und Hauptinhalt -->
    <div class="dashboard-grid">
        <?php include_once __DIR__ . '/partials/_sidebar.php'; // NEU: Planer-Sidebar einbinden ?>
        <main class="dashboard-content" id="planer-main-content">
            <!-- Container where the timetable grid will be rendered -->
            <div class="timetable-container" id="timetable-container">
                <div class="loading-spinner"></div> <!-- Loading indicator -->
            </div>
            <!-- Massenbearbeitung MOVED HERE -->
            <div class="bulk-actions-controls" style="margin-top: 20px;"> <!-- Added margin-top for spacing -->
                <button id="copy-week-btn" class="btn btn-secondary btn-small">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z"/></svg>
                    Woche kopieren...
                </button>
                <!-- NEUE Buttons f√ºr Vorlagen -->
                <button id="create-template-btn" class="btn btn-secondary btn-small">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1m1 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m0 2h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m0 2h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1"/></svg>
                    Vorlage erstellen...
                </button>
                <button id="apply-template-btn" class="btn btn-secondary btn-small">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0zM5 5.5A1.5 1.5 0 0 0 3.5 7v1A1.5 1.5 0 0 0 5 9.5h6a1.5 1.5 0 0 0 1.5-1.5v-1A1.5 1.5 0 0 0 11 5.5zM3.5 11A1.5 1.5 0 0 0 2 12.5v1A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5v-1A1.5 1.5 0 0 0 12.5 11z"/></svg>
                    Vorlage anwenden...
                </button>
                <button id="manage-templates-btn" class="btn btn-secondary btn-small">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M6 1v3H1V1zM1 0a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1zm14 12v3H10v-3zm-1-1a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1zM6 8v7H1V8zM1 7a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1zm14-6v7H10V1zm-1-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
                    Vorlagen verwalten...
                </button>
                <!-- Platzhalter f√ºr zuk√ºnftige Aktionen wie "Drucken" -->
            </div>
        </main>
    </div> <!-- Ende .dashboard-grid -->
    <!-- Modal for editing/creating timetable entries -->
     <div id="timetable-modal" class="modal-overlay">
         <div class="modal-box">
             <h2 id="modal-title">Eintrag bearbeiten</h2>
             <form id="timetable-entry-form">
                 <?php \App\Core\Security::csrfInput(); // Add CSRF input field ?>
                 <!-- Hidden fields to store context -->
                 <input type="hidden" id="entry_id" name="entry_id">
                 <input type="hidden" id="block_id" name="block_id">
                 <input type="hidden" id="substitution_id" name="substitution_id">
                 <input type="hidden" id="modal_day_of_week" name="day_of_week">
                 <input type="hidden" id="modal_period_number" name="period_number">
                 <input type="hidden" id="original_subject_id" name="original_subject_id">
                 <input type="hidden" id="modal_editing_template" name="editing_template" value="false"> <!-- NEU: Flag f√ºr Template-Editor -->
                 <!-- Tabs to switch between regular entry and substitution -->
                 <div class="modal-tabs">
                     <button type="button" class="tab-button active" data-mode="regular">Regul√§re Stunde</button>
                     <button type="button" class="tab-button" data-mode="substitution">Vertretung/√Ñnderung</button>
                 </div>
                 <!-- Fields for regular timetable entry -->
                 <div id="regular-fields" class="modal-tab-content active">
                     <!-- Klassen-Auswahl f√ºr Template-Editor (wird nur dort angezeigt) -->
                     <div class="form-group" id="template-class-select-container" style="display: none;">
                         <!-- KORRIGIERTES LABEL UND HILFETEXT -->
                         <label for="template_class_id">Standard-Klasse (f√ºr Lehrer-Vorlagen)</label>
                         <select id="template_class_id" name="class_id" class="conflict-check"></select>
                         <small class="form-hint">N√∂tig, wenn Vorlage auf Lehrer angewendet wird. Wird ignoriert, wenn Vorlage auf Klasse angewendet wird.</small>
                     </div>
                    <div class="form-group">
                        <label for="subject_id">Fach</label>
                        <select id="subject_id" name="subject_id" class="conflict-check" required></select>
                    </div>
                    <div class="form-group">
                        <label for="teacher_id">Lehrer</label>
                        <select id="teacher_id" name="teacher_id" class="conflict-check" required></select>
                    </div>
                    <div class="form-group">
                        <label for="room_id">Raum</label>
                        <select id="room_id" name="room_id" class="conflict-check" required></select>
                    </div>
                    <div class="form-group">
                        <label for="regular_comment">Kommentar (optional)</label>
                        <input type="text" id="regular_comment" name="comment" placeholder="z.B. Klausur, Besonderheit">
                    </div>
                 </div>
                 <!-- Fields for substitution entry -->
                 <div id="substitution-fields" class="modal-tab-content">
                     <!-- Substitution Fields bleiben wie gehabt -->
                      <div class="form-group">
                        <label for="substitution_type">Art der √Ñnderung</label>
                        <select id="substitution_type" name="substitution_type">
                            <option value="Vertretung">Vertretung</option>
                            <option value="Raum√§nderung">Raum√§nderung</option>
                            <option value="Entfall">Entfall</option>
                            <option value="Sonderevent">Sonderevent</option>
                        </select>
                    </div>
                    <!-- Dynamically shown fields based on substitution type -->
                    <div id="substitution-details">
                        <div class="form-group sub-field" data-types='["Vertretung", "Sonderevent"]'>
                            <label for="new_subject_id">Neues Fach (optional)</label>
                            <select id="new_subject_id" name="new_subject_id"></select>
                        </div>
                        <div class="form-group sub-field" data-types='["Vertretung"]'>
                            <label for="new_teacher_id">Neuer Lehrer</label>
                            <select id="new_teacher_id" name="new_teacher_id"></select>
                        </div>
                        <div class="form-group sub-field" data-types='["Vertretung", "Raum√§nderung", "Sonderevent"]'>
                            <label for="new_room_id">Neuer Raum</label>
                            <select id="new_room_id" name="new_room_id"></select>
                        </div>
                         <div class="form-group sub-field" data-types='["Vertretung", "Sonderevent", "Entfall", "Raum√§nderung"]'>
                            <label for="substitution_comment">Kommentar</label>
                            <input type="text" id="substitution_comment" name="comment" placeholder="z.B. Aula-Veranstaltung, Grund f√ºr Entfall">
                        </div>
                    </div>
                 </div>
                 <!-- Konflikt-Warnungs-Box (wird im Template-Editor deaktiviert) -->
                 <div class="modal-conflict-warning" id="modal-conflict-warning" style="display: none;">
                     <!-- Konfliktmeldungen werden hier per JS eingef√ºgt -->
                 </div>
                 <!-- Modal action buttons -->
                 <div class="modal-actions">
                     <button type="button" class="btn btn-danger" id="delete-entry-btn">L√∂schen</button>
                     <div class="modal-actions-right">
                         <button type="button" class="btn btn-secondary" id="modal-cancel-btn">Abbrechen</button>
                         <button type="submit" class="btn btn-primary" id="modal-save-btn">Speichern</button>
                     </div>
                 </div>
             </form>
         </div>
     </div> <!-- End timetable-modal -->
    <!-- Modal f√ºr Wochenkopie -->
    <div id="copy-week-modal" class="modal-overlay">
        <!-- Inhalt bleibt unver√§ndert -->
         <div class="modal-box">
             <h2 id="copy-week-modal-title">Stundenplan kopieren</h2>
             <form id="copy-week-form">
                 <p>Kopiere den Plan von der aktuell ausgew√§hlten Woche nach:</p>
                 <div class="copy-week-form">
                     <div class="form-group copy-from">
                         <label>Von (Quelle):</label>
                         <input type="text" id="copy-source-display" readonly disabled>
                     </div>
                     <div class="arrow-separator">&rarr;</div>
                     <div class="form-group">
                         <label for="copy-target-year">Ziel-Jahr*</label>
                         <select id="copy-target-year" required></select>
                     </div>
                      <div class="form-group">
                         <label for="copy-target-week">Ziel-KW*</label>
                         <select id="copy-target-week" required></select>
                     </div>
                 </div>
                 <div class="modal-conflict-warning" id="copy-week-warning">
                     <strong>Achtung:</strong> Alle vorhandenen Stundenplan-Eintr√§ge f√ºr die ausgew√§hlte Klasse/Lehrer in der Zielwoche werden √ºberschrieben. Vertretungen werden nicht kopiert.
                 </div>
                 <div class="modal-actions">
                     <button type="button" class="btn btn-secondary" id="copy-week-cancel-btn">Abbrechen</button>
                     <button type="submit" class="btn btn-primary" id="copy-week-confirm-btn">Kopieren & √úberschreiben</button>
                 </div>
             </form>
         </div>
     </div>
     <!-- ENDE Modal f√ºr Wochenkopie -->
    <!-- Modal zum Erstellen/Verwalten von Vorlagen -->
    <div id="manage-templates-modal" class="modal-overlay">
        <div class="modal-box"> <!-- Style wurde in planer.css angepasst (breiter) -->
            <h2 id="manage-templates-modal-title">Vorlagen verwalten</h2>
            <!-- Container f√ºr die Ansichten: Liste vs. Editor -->
            <div id="manage-templates-view-container">
                <!-- Ansicht 1: Liste der Vorlagen + Erstellen-Optionen -->
                <div id="template-list-view" class="manage-templates-view active">
                    <form id="create-template-form">
                         <h4>Neue Vorlage aus aktueller Woche erstellen</h4>
                         <div style="display: flex; gap: 15px; align-items: flex-end; margin-bottom: 15px;">
                             <div class="form-group" style="flex-grow: 1;">
                                 <label for="template-name">Vorlagenname*</label>
                                 <input type="text" id="template-name" name="template-name" required placeholder="z.B. Standardwoche A, Projektwoche">
                             </div>
                             <div class="form-group" style="flex-grow: 2;">
                                 <label for="template-description">Beschreibung (optional)</label>
                                 <input type="text" id="template-description" name="template-description" placeholder="Kurze Info, was diese Vorlage enth√§lt">
                                 <!-- Ersetzt Textarea durch Input f√ºr Einzeiligkeit -->
                             </div>
                             <div class="form-actions" style="margin-top: 0; margin-bottom: 0;">
                                 <button type="submit" class="btn btn-success">Aus Woche speichern</button>
                             </div>
                         </div>
                    </form>
                    <hr style="margin: 25px 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                         <h4>Bestehende Vorlagen</h4>
                         <button type="button" id="create-empty-template-btn" class="btn btn-primary btn-small">
                             <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zM2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z"/></svg>
                             Neue leere Vorlage
                         </button>
                    </div>
                    <div id="templates-list-container" style="max-height: 300px; overflow-y: auto;">
                         <!-- Liste wird per JS gef√ºllt -->
                         <p>Lade Vorlagen...</p>
                    </div>
                </div>
                <!-- Ansicht 2: Editor f√ºr eine neue/bestehende Vorlage (Initial hidden) -->
                <div id="template-editor-view" class="manage-templates-view" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                         <h4 id="template-editor-title">Leere Vorlage erstellen</h4>
                         <div>
                             <button type="button" id="back-to-template-list-btn" class="btn btn-secondary btn-small">Zur√ºck zur Liste</button>
                             <button type="button" id="save-template-editor-btn" class="btn btn-success btn-small">Vorlage speichern</button>
                         </div>
                    </div>
                    <!-- Vorlagen-Details (Name, Beschreibung) -->
                    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                         <div class="form-group" style="flex-grow: 1;">
                             <label for="template-editor-name">Vorlagenname*</label>
                             <input type="text" id="template-editor-name" required>
                         </div>
                         <div class="form-group" style="flex-grow: 2;">
                             <label for="template-editor-description">Beschreibung</label>
                             <input type="text" id="template-editor-description">
                         </div>
                    </div>
                    <p style="color: var(--color-text-muted); font-size: 0.9em; margin-top: 10px;">
                         Klicken Sie auf eine Zelle, um einen Eintrag hinzuzuf√ºgen/zu bearbeiten. Die Klasse wird beim Anwenden der Vorlage auf eine Klasse automatisch angepasst.
                         Wenn Sie die Vorlage auf einen Lehrer anwenden, wird die hier gew√§hlte Klasse verwendet (relevant f√ºr Vertretungen etc.).
                    </p>
                    <!-- Container f√ºr das simplifizierte Grid -->
                    <div id="template-editor-grid-container" style="margin-top: 15px; border: 1px solid var(--color-border); border-radius: 8px; overflow: hidden;">
                         <!-- Grid wird hier per JS eingef√ºgt -->
                         <div class="loading-spinner"></div>
                    </div>
                </div>
            </div> <!-- Ende View Container -->
            <div class="modal-actions" style="margin-top: 25px;">
                <button type="button" class="btn btn-secondary" id="manage-templates-close-btn">Schlie√üen</button>
            </div>
        </div>
    </div>
    <!-- ENDE Modal zum Erstellen/Verwalten -->
    <!-- Modal zum Anwenden einer Vorlage -->
    <div id="apply-template-modal" class="modal-overlay">
        <!-- Inhalt bleibt unver√§ndert -->
        <div class="modal-box">
            <h2 id="apply-template-modal-title">Vorlage anwenden</h2>
            <form id="apply-template-form">
                 <p>W√§hle eine Vorlage aus, die auf die aktuell ausgew√§hlte Woche angewendet werden soll.</p>
                 <div class="form-group">
                     <label for="apply-template-select">Vorlage ausw√§hlen*</label>
                     <select id="apply-template-select" name="templateId" required>
                         <option value="">Lade Vorlagen...</option>
                         <!-- Optionen werden per JS gef√ºllt -->
                     </select>
                 </div>
                 <div class="modal-conflict-warning">
                     <strong>Achtung:</strong> Alle vorhandenen Stundenplan-Eintr√§ge f√ºr die ausgew√§hlte Klasse/Lehrer in der aktuellen Woche werden durch die Vorlage √ºberschrieben. Vertretungen bleiben unber√ºhrt.
                 </div>
                 <div class="modal-actions">
                     <button type="button" class="btn btn-secondary" id="apply-template-cancel-btn">Abbrechen</button>
                     <button type="submit" class="btn btn-primary" id="apply-template-confirm-btn">Vorlage anwenden & √úberschreiben</button>
                 </div>
            </form>
        </div>
    </div>
    <!-- ENDE Modal zum Anwenden -->
</div> <!-- End page-wrapper -->
<?php
include_once dirname(__DIR__) . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\planer\dashboard.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\pages\dashboard.php ---
<?php
include_once __DIR__ . '/partials/header.php';
$role = $_SESSION['user_role'] ?? 'guest'; // Rolle holen
?>
<div class="page-wrapper dashboard-wrapper">
    <h1 class="main-title">Mein Dashboard</h1>

    <nav class="tab-navigation">
        <button class="tab-button active" data-target="section-my-day">üóìÔ∏è Mein Tag</button>
        <button class="tab-button" data-target="section-weekly-plan">üìÖ Wochenplan</button>
        <button class="tab-button" data-target="section-announcements">üì¢ Ank√ºndigungen</button>

        <?php // NEU: Pr√ºfe, ob das Community Board global aktiviert ist ?>
        <?php if ($role === 'schueler' && $settings['community_board_enabled']): ?>
            <button class="tab-button" data-target="section-community-board">üì∞ Schwarzes Brett</button>
            <button class="tab-button" data-target="section-my-posts">‚úçÔ∏è Deine Beitr√§ge</button>
        <?php endif; ?>

        <?php // NEU: Eigener Block f√ºr Sprechstunden (unabh√§ngig vom Community Board) ?>
        <?php if ($role === 'schueler'): ?>
            <button class="tab-button" data-target="section-book-appointment">üó£Ô∏è Sprechstunde buchen</button>
        <?php endif; ?>

        <?php if ($role === 'lehrer'): ?>
            <button class="tab-button" data-target="section-attendance">‚úÖ Anwesenheit</button>
            <button class="tab-button" data-target="section-events">üìö Aufgaben/Klausuren</button>
            <button class="tab-button" data-target="section-office-hours">üó£Ô∏è Sprechzeiten</button>
            <button class="tab-button" data-target="section-colleague-search">üßë‚Äçü§ù‚Äçüßë Kollegensuche</button>
        <?php endif; ?>
    </nav>

    <div class="tab-content">
        <div class="dashboard-section active" id="section-my-day">
            <h2 class="section-title-hidden">Mein Tag <small>(<?php echo $dayOfWeekName . ', ' . $dateFormatted; ?>)</small></h2>
            <div id="today-schedule-container" class="today-schedule-container">
                <div class="loading-spinner small"></div>
            </div>
        </div>

        <div class="dashboard-section" id="section-weekly-plan">
            <section class="weekly-timetable-section" id="weekly-timetable-section-printable">
                <div class="dashboard-header">
                    <h2 class="section-title-hidden">Mein Wochenplan</h2>
                    <div class="plan-controls">
                        <div class="form-group">
                            <label for="year-selector">Jahr:</label>
                            <select id="year-selector"></select>
                        </div>
                        <div class="form-group">
                            <label for="week-selector">KW:</label>
                            <select id="week-selector"></select>
                        </div>
                        <div class="print-export-actions form-group">
                            <button id="export-pdf-btn" class="btn btn-primary" title="Als PDF exportieren">
                                PDF Export
                            </button>
                        </div>
                    </div>
                </div>
                <div id="plan-header-info" class="plan-header-info"></div>
                <div class="timetable-container" id="timetable-container">
                    <div class="loading-spinner"></div>
                </div>
            </section>
            
            <?php if (isset($icalSubscriptionUrl)): ?>
            <div class="ical-subscription-box" style="margin-top: 25px;">
                <label for="ical-url">Dein pers√∂nlicher Kalender-Feed:</label>
                <div class="input-group">
                    <input type="text" id="ical-url" value="<?php echo htmlspecialchars($icalSubscriptionUrl); ?>" readonly>
                    <button id="copy-ical-url" class="btn btn-secondary btn-small" title="Link kopieren">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M13 0H6a2 2 0 0 0-2 2 2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2 2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm0 13a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h7a1 1 0 0 1 1 1v9ZM2 2a1 1 0 0 1 1-1h7a1 1 0 0 1 1 1v1H2V2Z"/>
                        </svg>
                    </button>
                </div>
                <small class="form-hint">F√ºge diese URL zu deiner Kalender-App hinzu (z.B. Google Kalender, Outlook, Apple Kalender), um deinen Stundenplan zu abonnieren.</small>
            </div>
            <?php endif; ?>
        </div>

        <div class="dashboard-section" id="section-announcements">
            <div id="announcements-list" class="sidebar-widget-content">
                <div class="loading-spinner"></div>
            </div>
        </div>

        <?php if ($role === 'schueler' && $settings['community_board_enabled']): ?>
            <div class="dashboard-section" id="section-community-board">
                <h4>Digitales Schwarzes Brett</h4>
                <p class="form-hint" style="margin-bottom: 20px;">Informeller Feed f√ºr Fundsachen, AGs, Nachhilfe, etc. Beitr√§ge von Sch√ºlern werden vor der Ver√∂ffentlichung gepr√ºft.</p>
                
                <form id="community-post-form" class="form-container" style="background-color: var(--color-surface-alt); padding: 15px; margin-bottom: 25px;">
                    <?php \App\Core\Security::csrfInput(); ?>
                    <h5>Neuen Beitrag erstellen</h5>
                    <div class="form-group" style="margin-bottom: 10px;">
                        <label for="post-title">Titel*</label>
                        <input type="text" id="post-title" name="title" required placeholder="z.B. Nachhilfe in Mathe gesucht">
                    </div>
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label for="post-content">Inhalt*</label>
                        <textarea id="post-content" name="content" rows="4" required placeholder="Beschreibe dein Anliegen..."></textarea>
                        <small class="form-hint">Sie k√∂nnen <a href="https://www.markdownguide.org/basic-syntax/" target="_blank">Markdown</a> f√ºr die Formatierung verwenden.</small>
                    </div>
                    <div class="form-actions" style="margin-top: 0; justify-content: flex-end;">
                        <button type="submit" class="btn btn-primary btn-small" id="create-post-btn" style="width: auto;">Beitrag einreichen</button>
                        <span id="post-create-spinner" class="loading-spinner small" style="display: none; margin-left: 10px;"></span>
                    </div>
                </form>

                <div id="community-posts-list" class="posts-list-container" style="max-height: 60vh; overflow-y: auto;">
                    <div class="loading-spinner"></div>
                </div>
            </div>

            <div class="dashboard-section" id="section-my-posts">
                <h4>Deine Beitr√§ge</h4>
                <p class="form-hint" style="margin-bottom: 20px;">Hier siehst du den Status deiner eingereichten Beitr√§ge und kannst sie bearbeiten. Bearbeitete Beitr√§ge werden erneut zur Moderation vorgelegt.</p>
                <div id="my-posts-list" class="posts-list-container my-posts-container" style="max-height: 60vh; overflow-y: auto;">
                    <div class="loading-spinner"></div>
                </div>
            </div>
        <?php endif; ?>
        
        <?php // Gesamter Block f√ºr Sch√ºler-Sprechstundenbuchung ?>
        <?php if ($role === 'schueler'): ?>
        <div class="dashboard-section" id="section-book-appointment">
            <div class="cockpit-feature" id="appointment-booking-widget">
                <h4>Sprechstunde buchen</h4>
                <p class="form-hint" style="margin-bottom: 20px; margin-top: 0;">Suche nach einem Lehrer, um verf√ºgbare Termine zu sehen.</p>
                
                <form id="appointment-booking-form" class="form-container" style="background-color: var(--color-surface-alt); padding: 15px;">
                    <?php \App\Core\Security::csrfInput(); ?>
                    <input type="hidden" id="selected-teacher-id">

                    <div class="form-group" style="margin-bottom: 15px; position: relative;">
                        <label for="teacher-search-input">1. Lehrer suchen*</label>
                        <input type="text" id="teacher-search-input" placeholder="Name oder K√ºrzel..." autocomplete="off">
                        <div class="search-results-dropdown" id="teacher-search-results">
                            <!-- Ergebnisse werden per JS eingef√ºgt -->
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label for="appointment-date-picker">2. Datum ausw√§hlen*</label>
                        <input type="text" id="appointment-date-picker" name="appointment_date" placeholder="Bitte zuerst einen Lehrer ausw√§hlen." readonly>
                        <small class="form-hint">Nur Tage mit freien Terminen sind w√§hlbar.</small>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label>3. Verf√ºgbaren Slot ausw√§hlen*</label>
                        <div class="available-slots-container" id="available-slots-container">
                            <small class="form-hint">Bitte Lehrer und Datum ausw√§hlen.</small>
                        </div>
                    </div>

                    <div class="form-group" id="appointment-notes-container" style="display: none; margin-bottom: 15px;">
                        <label for="appointment-notes">4. Anmerkung f√ºr den Lehrer (optional)</label>
                        <textarea id="appointment-notes" name="notes" rows="2" placeholder="z.B. Thema: Notenbesprechung, Projekt..."></textarea>
                    </div>

                    <div class="form-actions" style="margin-top: 0; justify-content: flex-end;">
                        <button type="submit" class="btn btn-primary btn-small" id="book-appointment-btn" style="width: auto;" disabled>Termin buchen</button>
                        <span id="appointment-book-spinner" class="loading-spinner small" style="display: none; margin-left: 10px;"></span>
                    </div>
                </form>
            </div>
        </div>
        <?php endif; ?>

        <?php // Cockpit-Tabs f√ºr Lehrer ?>
        <?php if ($role === 'lehrer'): ?>
            <div id="teacher-cockpit" style="display: contents;">
                <div class="dashboard-section" id="section-attendance">
                    <div class="cockpit-feature" id="attendance-feature">
                        <h4>Digitale Anwesenheit</h4>
                        <div id="attendance-current-lesson">
                            <div class="loading-spinner small"></div>
                        </div>
                        <div class="attendance-list-container" id="attendance-list-container" style="display: none;">
                            <div class="attendance-list-header">
                                <span>Sch√ºler/in</span>
                                <span>Status</span>
                            </div>
                            <ul id="attendance-student-list" class="attendance-student-list"></ul>
                            <div class="form-actions" style="margin-top: 15px;">
                                <button class="btn btn-primary" id="save-attendance-btn" style="width: 100%;">
                                    Anwesenheit speichern
                                </button>
                                <span id="attendance-save-spinner" class="loading-spinner small" style="display: none; margin-left: 10px;"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-section" id="section-events">
                    <div class="cockpit-feature" id="academic-events-feature">
                        <h4>Aufgaben & Klausuren verwalten</h4>
                        <form id="academic-event-form" class="form-container" style="background-color: var(--color-surface-alt); padding: 15px; margin-bottom: 20px;">
                            <?php \App\Core\Security::csrfInput(); ?>
                            <div class="form-group" style="margin-bottom: 10px;">
                                <label for="event-type">Typ*</label>
                                <select name="event_type" id="event-type" required>
                                    <option value="aufgabe">Aufgabe</option>
                                    <option value="klausur">Klausur / Test</option>
                                    <option value="info">Info</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom: 10px;">
                                <label for="event-class-id">Klasse*</label>
                                <select name="class_id" id="event-class-id" required>
                                    <option value="">Lade Klassen...</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom: 10px;">
                                <label for="event-subject-id">Fach (optional)</label>
                                <select name="subject_id" id="event-subject-id">
                                    <option value="">Kein Fach</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom: 10px;">
                                <label for="event-title">Titel* (Kurzbeschreibung)</label>
                                <input type="text" name="title" id="event-title" required placeholder="z.B. Test: 1. Quartal, S. 42 lesen">
                            </div>
                            <div class="form-group" style="margin-bottom: 10px;">
                                <label for="event-due-date">Datum* (F√§lligkeit/Termin)</label>
                                <input type="date" name="due_date" id="event-due-date" required>
                            </div>
                            <div class="form-group" style="margin-bottom: 15px;">
                                <label for="event-description">Beschreibung (optional)</label>
                                <textarea name="description" id="event-description" rows="2" placeholder="Weitere Details..."></textarea>
                            </div>
                            <div class="form-actions" style="margin-top: 0;">
                                <button type="submit" class="btn btn-primary btn-small" id="save-event-btn" style="width: auto;">Eintrag erstellen</button>
                                <span id="event-save-spinner" class="loading-spinner small" style="display: none;"></span>
                            </div>
                        </form>

                        <h5>Meine Eintr√§ge (N√§chste 14 Tage):</h5>
                        <div class="event-list-container" id="teacher-event-list">
                            <div class="loading-spinner small"></div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-section" id="section-office-hours">
                    <div class="cockpit-feature" id="office-hours-feature">
                        <!-- NEUE TAB-NAVIGATION (Inner-Tabs) -->
                        <nav class="tab-navigation inner-tabs">
                            <button class="tab-button active" data-target="office-hours-manage-view">
                                üóìÔ∏è Fenster verwalten
                            </button>
                            <button class="tab-button" data-target="office-hours-booked-view">
                                ‚úîÔ∏è Gebuchte Termine <span id="booked-appointments-count">(0)</span>
                            </button>
                        </nav>
                        
                        <!-- NEUER TAB-CONTENT (Inner-Tabs) -->
                        <div class="tab-content inner-tab-content">
                            
                            <!-- Ansicht 1: Fenster verwalten (Bestehendes Markup) -->
                            <div class="dashboard-section active" id="office-hours-manage-view" style="padding: 20px 0 0 0;">
                                <h4>Sprechstunden verwalten</h4>
                                <p class="form-hint" style="margin-bottom: 15px; margin-top: 0;">Definieren Sie hier Ihre w√∂chentlich wiederkehrenden Zeitfenster, die Sch√ºler buchen k√∂nnen.</p>
                                
                                <form id="office-hours-form" class="form-container office-hours-form-grid" style="background-color: var(--color-surface-alt); padding: 15px; margin-bottom: 20px;">
                                    <?php \App\Core\Security::csrfInput(); ?>
                                    <div class="form-group">
                                        <label for="office-day">Wochentag*</label>
                                        <select name="day_of_week" id="office-day" required>
                                            <option value="1">Montag</option>
                                            <option value="2">Dienstag</option>
                                            <option value="3">Mittwoch</option>
                                            <option value="4">Donnerstag</option>
                                            <option value="5">Freitag</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="office-start-time">Von*</label>
                                        <input type="time" name="start_time" id="office-start-time" step="900" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="office-end-time">Bis*</label>
                                        <input type="time" name="end_time" id="office-end-time" step="900" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="office-location">Raum/Ort*</label>
                                        <input type="text" name="location" id="office-location" required placeholder="z.B. Raum 201, Online">
                                    </div>
                                    <div class="form-group">
                                        <label for="office-slot-duration">Slot (Min)*</label>
                                        <input type="number" name="slot_duration" id="office-slot-duration" value="15" min="5" max="60" step="5" required>
                                    </div>
                                    <div class="form-actions" style="margin-top: 0;">
                                        <button type="submit" class="btn btn-primary btn-small" id="save-office-hours-btn" style="width: 100%;">
                                            Hinzuf√ºgen
                                        </button>
                                        <span id="office-hours-save-spinner" class="loading-spinner small" style="display: none;"></span>
                                    </div>
                                </form>

                                <h5>Meine Sprechzeitenfenster:</h5>
                                <div class="office-hours-list-container" id="teacher-office-hours-list">
                                    <div class="loading-spinner small"></div>
                                </div>
                            </div>

                            <!-- Ansicht 2: Gebuchte Termine (Neu) -->
                            <div class="dashboard-section" id="office-hours-booked-view" style="padding: 20px 0 0 0;">
                                <h4>Ihre gebuchten Sprechstunden</h4>
                                <!-- HINWEISTEXT GE√ÑNDERT -->
                                <p class="form-hint" style="margin-bottom: 15px; margin-top: 0;">Liste aller zuk√ºnftigen und heutigen gebuchten Termine. Vergangene Termine werden ausgeblendet.</p>
                                <div class="booked-appointments-list-container" id="booked-appointments-list-container">
                                    <div class="loading-spinner"></div>
                                    <!-- Inhalt wird per JS geladen -->
                                </div>
                            </div>
                            
                        </div> <!-- Ende inner-tab-content -->
                    </div>
                </div>

                <div class="dashboard-section" id="section-colleague-search">
                    <div class="cockpit-feature" id="find-colleague-feature">
                        <h4>Wo ist...? (Kollegensuche)</h4>
                        <div class="form-group" style="margin-bottom: 10px; position: relative;">
                            <label for="colleague-search-input">Kollege/Kollegin suchen:</label>
                            <input type="text" id="colleague-search-input" placeholder="Name oder K√ºrzel suchen...">
                            <div class="search-results-dropdown" id="colleague-search-results">
                            </div>
                        </div>
                        <div class="search-result-display" id="colleague-result-display" style="display: none;">
                            <div class="loading-spinner small" style="display: none;"></div>
                            <p></p>
                        </div>
                    </div>
                </div>
            </div> <?php // End #teacher-cockpit ?>
        <?php endif; ?>

    </div> <?php // End .tab-content ?>
</div> <?php // End .page-wrapper ?>

<?php // --- Modal f√ºr Stundenplan-Details (GILT F√úR ALLE) --- ?>
<div id="plan-detail-modal" class="modal-overlay">
    <div class="modal-box small-modal">
        <h2 id="plan-detail-title">Stunden-Details</h2>
        <div class="plan-detail-content">
            <div class="detail-row">
                <span class="detail-label">Status:</span>
                <span id="detail-status" class="detail-value"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Zeit:</span>
                <span id="detail-time" class="detail-value"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Fach:</span>
                <span id="detail-subject" class="detail-value"></span>
            </div>
            
            <?php // Dynamisch anzeigen, je nach Rolle ?>
            <?php if ($role === 'schueler'): ?>
            <div class="detail-row">
                <span class="detail-label">Lehrer:</span>
                <span id="detail-teacher" class="detail-value"></span>
            </div>
            <?php elseif ($role === 'lehrer'): ?>
             <div class="detail-row">
                <span class="detail-label">Klasse:</span>
                <span id="detail-class" class="detail-value"></span>
            </div>
            <?php endif; ?>
            
            <div class="detail-row">
                <span class="detail-label">Raum:</span>
                <span id="detail-room" class="detail-value"></span>
            </div>
            <div class="detail-row detail-comment" id="detail-comment-row" style="display: none;">
                <span class="detail-label">Kommentar:</span>
                <span id="detail-comment" class="detail-value"></span>
            </div>
            
            <?php // --- Platzhalter f√ºr Notizen (nur f√ºr Sch√ºler) --- ?>
            <?php if ($role === 'schueler'): ?>
            <div class="detail-row detail-notes" id="detail-notes-row" style="display: none; flex-direction: column; align-items: stretch; border-bottom: none; padding-bottom: 0;">
                <label for="detail-notes-input" class="detail-label" style="margin-bottom: 8px;">Meine private Notiz:</label>
                <textarea id="detail-notes-input" rows="3" placeholder="Notiz hinzuf√ºgen (z.B. Hausaufgaben, Material)..."></textarea>
                <span id="note-save-spinner" class="loading-spinner small" style="display: none; margin-top: 5px;"></span>
            </div>
            <?php endif; ?>
        </div>
        <div class="modal-actions" style="margin-top: 20px;">
            <button type="button" class="btn btn-secondary" id="plan-detail-close-btn">Schlie√üen</button>
            <?php // --- Notiz-Speichern-Button (nur f√ºr Sch√ºler) --- ?>
            <?php if ($role === 'schueler'): ?>
            <button type="button" class="btn btn-primary" id="plan-detail-save-note-btn">Notiz speichern</button>
            <?php endif; ?>
        </div>
    </div>
</div>
<?php // --- ENDE Modal --- ?>

<?php // --- Modal f√ºr "Meine Beitr√§ge" (Bearbeiten) --- ?>
<?php if ($role === 'schueler' && $settings['community_board_enabled']): ?>
<div id="my-post-edit-modal" class="modal-overlay">
    <div class="modal-box">
        <button type="button" class="modal-close-btn" id="my-post-edit-close-btn">&times;</button>
        <h2 id="my-post-edit-title">Beitrag bearbeiten</h2>
        <form id="my-post-edit-form" class="form-container" style="padding: 0; border: none; background: none; box-shadow: none;">
            <input type="hidden" name="post_id" id="edit-post-id">
            <div class="form-group" style="margin-bottom: 10px;">
                <label for="edit-post-title">Titel*</label>
                <input type="text" id="edit-post-title" name="title" required>
            </div>
            <div class="form-group" style="margin-bottom: 15px;">
                <label for="edit-post-content">Inhalt*</label>
                <textarea id="edit-post-content" name="content" rows="6" required></textarea>
                <small class="form-hint">Der Beitrag wird nach dem Speichern erneut zur Moderation vorgelegt.</small>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="my-post-edit-cancel-btn">Abbrechen</button>
                <button type="submit" class="btn btn-primary" id="my-post-edit-save-btn">Speichern & Einreichen</button>
                <span id="my-post-edit-spinner" class="loading-spinner small" style="display: none; margin-left: 10px;"></span>
            </div>
        </form>
    </div>
</div>
<?php endif; ?>
<?php // --- ENDE Modal --- ?>

<?php
include_once __DIR__ . '/partials/footer.php';
?>
--- END FILE: C:\xampp\htdocs\files\PAUSE\pages\dashboard.php ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\1-settings\variables.css ---
/* public/assets/css/1-settings/variables.css */
:root {
    --color-primary: #390099;
    --color-secondary: #9e0059;
    --color-danger: #ff0054;
    --color-success: #28a745;
    --color-warning: #ffbd00;

    --font-display: 'Oswald', sans-serif;
    --font-body: 'Inter', sans-serif;

    /* Helle Modus-Farben */
    --color-background: #f4f7f6;
    --color-surface: #ffffff;
    --color-surface-alt: #f8f9fa;
    --color-text: #212529;
    --color-text-muted: #6c757d;
    --color-border: #dee2e6;

    /* NEU: Flie√üende Typografie-Variablen */
    /* Basis-Schriftgr√∂√üe (Absatz): 16px -> 18px */
    --font-size-base: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);
    /* h4-Gr√∂√üe: 18px -> 20px */
    --font-size-lg: clamp(1.125rem, 1.05rem + 0.35vw, 1.25rem);
    /* h3-Gr√∂√üe: 20px -> 24px */
    --font-size-xl: clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem);
    /* h2-Gr√∂√üe: 24px -> 32px */
    --font-size-2xl: clamp(1.5rem, 1.25rem + 1.25vw, 2rem);
    /* h1 / .main-title Gr√∂√üe: 32px -> 40px */
    --font-size-3xl: clamp(2rem, 1.75rem + 1.25vw, 2.5rem);
}

.dark-mode {
    --color-primary: #a972ff;
    --color-secondary: #f07167;
    --color-danger: #f85149;
    --color-success: #3fb950;
    --color-warning: #ffca2c;

    --color-background: #0d1117;
    --color-surface: #161b22;
    --color-surface-alt: #21262d;
    --color-text: #e6edf3;
    --color-text-muted: #8b949e;
    --color-border: #30363d;
}

body {
    background-color: var(--color-background);
    color: var(--color-text);
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\1-settings\variables.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\3-generic\reset.css ---
/* 1. Set default box-sizing */
*,
*::before,
*::after {
    box-sizing: border-box;
}

/* 2. Remove default margins and padding */
body,
h1, h2, h3, h4, h5, h6,
p,
ul, ol, li,
figure, figcaption, blockquote,
dl, dd {
    margin: 0;
    padding: 0;
}

/* 3. Set core root defaults */
html {
    scroll-behavior: smooth;
    -webkit-text-size-adjust: 100%;
}

/* 4. Set core body defaults */
body {
    min-height: 100vh;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
}

/* 5. Make images and videos easier to work with */
img, video, canvas, svg {
    display: block;
    max-width: 100%;
}

/* 6. Remove built-in form typography styles */
input, button, textarea, select {
    font: inherit;
    color: inherit;
    margin: 0;
}

/* 7. Remove list styles (to be added by components) */
ul, ol {
    list-style: none;
}

/* 8. Fix anchor text decoration */
a {
    text-decoration: none;
    color: inherit;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\3-generic\reset.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\4-base\globals.css ---
/* public/assets/css/4-base/globals.css */
body {
    background-color: var(--color-background);
    color: var(--color-text);
    font-family: var(--font-body);
    margin: 0;
    padding-top: 80px; /* Platz f√ºr den fixierten Header */
    display: flex;
    flex-direction: column;
    

    min-height: 100vh; 
    box-sizing: border-box; 
    font-size: var(--font-size-base);
}

a {
    color: var(--color-primary);
    text-decoration: none;
    transition: color 0.2s ease, text-decoration 0.2s ease;
}

a:hover {
    color: var(--color-secondary);
    text-decoration: underline;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\4-base\globals.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\4-base\typography.css ---
/* public/assets/css/4-base/typography.css */
h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-display);
    color: var(--color-text);
    margin-top: 0;
    margin-bottom: 0.75rem;
    line-height: 1.3;
}

/* NEU: Zuweisung der flie√üenden Gr√∂√üen */
h1 { font-size: var(--font-size-3xl); }
h2 { font-size: var(--font-size-2xl); }
h3 { font-size: var(--font-size-xl); }
h4 { font-size: var(--font-size-lg); }
h5, h6 { 
    font-size: var(--font-size-base);
    font-weight: 700; /* Stellt sicher, dass sie sich von <p> abheben */
}

.main-title {
    color: var(--color-primary);
    /* ALT: font-size: 2.5rem; */
    /* NEU: Verwendet die h1-Variable */
    font-size: var(--font-size-3xl); 
    margin-bottom: 1.5rem;
}

.dark-mode .main-title {
    color: var(--color-primary);
}

p {
    line-height: 1.6;
    margin-top: 0;
    margin-bottom: 1rem;
    /* Basis-Schriftgr√∂√üe wird von 'body' in globals.css geerbt */
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\4-base\typography.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\5-layout\footer.css ---
.site-footer {
    background-color: #1a1a1a; 
    color: #a0a0a0; 
    padding: 30px 0;
    margin-top: auto; 
    font-size: 0.9rem;
    line-height: 1.6;
}
.dark-mode .site-footer {
     background-color: #080808; 
     color: #888;
}
.footer-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    max-width: 800px; 
    margin: 0 auto;
    padding: 0 20px;
    text-align: center;
}
.copyright {
    opacity: 0.8;
}
.imprint {
    position: relative; 
}
.imprint-toggle {
    background: none;
    border: none;
    color: var(--color-primary); 
    text-decoration: underline;
    cursor: pointer;
    font-size: 0.9rem;
    padding: 5px;
    transition: color 0.2s ease;
}
.imprint-toggle:hover {
    color: var(--color-secondary); 
    text-decoration: none;
}
.dark-mode .imprint-toggle {
     color: var(--color-primary); 
}
.dark-mode .imprint-toggle:hover {
     color: var(--color-secondary);
}
.imprint-details {
    display: none; 
    position: fixed; 
    bottom: 0;
    left: 50%;
    transform: translateX(-50%) translateY(100%); 
    width: 90%;
    max-width: 600px;
    max-height: 70vh; 
    overflow-y: auto;
    background-color: var(--color-surface);
    color: var(--color-text);
    padding: 30px;
    border-radius: 12px 12px 0 0; 
    box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.2);
    z-index: 1050; 
    text-align: left;
    transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); 
}
.imprint-details.visible {
    transform: translateX(-50%) translateY(0); 
    display: block;
}
.dark-mode .imprint-details {
     background-color: #1e1e1e; 
     color: var(--color-text);
     box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.5);
}
.imprint-details p {
    margin-bottom: 1rem;
}
.imprint-details strong {
    color: var(--color-primary);
}
.dark-mode .imprint-details strong {
    color: var(--color-primary);
}
.imprint-details a {
    color: var(--color-secondary);
    text-decoration: none;
}
.imprint-details a:hover {
    text-decoration: underline;
}
.imprint-close {
    position: absolute;
    top: 10px;
    right: 15px;
    background: none;
    border: none;
    font-size: 1.8rem;
    color: var(--color-text-muted);
    cursor: pointer;
    padding: 5px;
    line-height: 1;
}
.imprint-close:hover {
    color: var(--color-danger);
}
@media (min-width: 769px) {
    .footer-content {
        flex-direction: row;
        justify-content: space-between;
        text-align: left;
    }
     .copyright {
         order: 1; 
     }
     .imprint {
         order: 2;
     }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\5-layout\footer.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\5-layout\grid.css ---
/* public/assets/css/5-layout/grid.css */
.dashboard-grid {
    display: grid;
    grid-template-columns: minmax(220px, 20%) 1fr;
    gap: 30px;
    align-items: start;
}

.dashboard-content {
    background-color: var(--color-surface);
    border-radius: 12px;
    padding: 0;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.05);
    overflow: hidden; /* Beh√§lt border-radius f√ºr innere Elemente (Tabs) */
    border: none;
    min-width: 0; 
}

.dashboard-widget-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 25px;
    margin-top: 15px;
    padding: 10px;
}

.health-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 25px;
    padding: 10px;
}


@media (max-width: 992px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .dashboard-widget-grid {
        grid-template-columns: 1fr;
    }
    .health-grid {
        grid-template-columns: 1fr;
    }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\5-layout\grid.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\5-layout\header.css ---
.page-header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    padding: 10px 20px;
    box-sizing: border-box;
    z-index: 1002;
    display: flex;
    justify-content: space-between;
    align-items: center;
    min-height: 60px; 
    background-color: rgba(57, 0, 153, 0.85); 
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px); 
    border-bottom: 1px solid rgba(255, 255, 255, 0.1); 
}
.impersonation-banner {
    background-color: var(--color-warning);
    color: #000;
    padding: 12px 0;
    font-size: 0.9rem;
    position: sticky; 
    top: 0;
    z-index: 1050; 
    border-bottom: 2px solid rgba(0,0,0,0.2);
}
.impersonation-banner strong {
    font-weight: 700;
}
.impersonation-banner a.btn {
    background-color: rgba(255,255,255,0.8);
    color: #000;
    border-color: rgba(0,0,0,0.2);
    font-weight: 700;
}
.impersonation-banner a.btn:hover {
    background-color: #fff;
    color: #000;
}
body:has(.impersonation-banner) .page-header {
    top: 52px; 
}
body:has(.impersonation-banner) .dashboard-sidebar {
    top: 152px; 
}
.site-logo {
    font-size: 1.6rem;
    font-weight: bold;
    color: white;
    text-decoration: none;
    font-family: var(--font-display);
    transition: transform 0.3s ease;
    display: flex; 
    align-items: center; 
}
.site-logo:hover {
    transform: scale(1.03);
    text-decoration: none;
}
.site-logo-image {
    height: 40px; 
    width: auto; 
    max-width: 150px; 
    margin-right: 10px; 
    object-fit: contain;
}
.page-header .header-link {
    color: #ffffff;
    text-decoration: none;
    font-weight: 600;
    transition: color 0.2s ease;
    white-space: nowrap;
}
.page-header .header-link:hover {
    color: var(--color-warning);
    text-decoration: none;
}
.page-header .header-link.active {
    color: var(--color-warning);
    font-weight: 700;
}
.header-nav {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(42, 0, 75, 0.95); 
    backdrop-filter: blur(5px); 
    -webkit-backdrop-filter: blur(5px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    box-sizing: border-box;
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    transition: opacity 0.3s ease, visibility 0.3s ease;
    z-index: 1001; 
}
.header-nav.is-open {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
}
.nav-left, .nav-right {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
    width: 100%; 
}
.nav-right {
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid rgba(255,255,255,0.1);
    width: 80%;
    max-width: 300px;
}
.header-nav .header-link {
    font-size: 1.5rem; 
    font-family: var(--font-body);
    font-weight: 600;
    color: rgba(255, 255, 255, 0.8);
    padding: 10px;
}
.header-nav .header-link:hover {
    color: #fff;
}
.header-nav .header-link.active {
    color: var(--color-warning);
}
@media (min-width: 769px) {
    .page-header {
        padding: 10px 40px; 
        min-height: 70px; 
    }
    .site-logo {
        font-size: 1.8rem;
    }
    .site-logo-image {
        height: 50px; 
    }
    .header-nav {
        position: static;
        width: auto;
        height: auto;
        background: none;
        backdrop-filter: none; 
        -webkit-backdrop-filter: none;
        padding: 0;
        z-index: auto;
        border: none;
        opacity: 1;
        visibility: visible;
        pointer-events: auto;
        flex-direction: row;
        justify-content: flex-end; 
        gap: 25px;
    }
    .nav-left, .nav-right {
        flex-direction: row;
        width: auto;
        gap: 25px;
        margin-top: 0;
        padding-top: 0;
        border-top: none;
        align-items: center; 
    }
    .header-nav .header-link {
        font-size: 1rem; 
        font-family: var(--font-body);
    }
}
.mobile-menu-toggle {
    display: block; 
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 10px;
    margin: -10px; 
    z-index: 1002; 
}
.hamburger-box {
    width: 30px;
    height: 24px;
    display: inline-block;
    position: relative;
}
.hamburger-inner,
.hamburger-inner::before,
.hamburger-inner::after {
    width: 100%;
    height: 3px;
    background-color: #fff; 
    border-radius: 4px;
    position: absolute;
    transition-property: transform;
    transition-duration: 0.15s;
    transition-timing-function: ease;
}
.hamburger-inner::before,
.hamburger-inner::after {
    content: "";
    display: block;
    transition: top 0.1s 0.15s ease-in, bottom 0.1s 0.15s ease-in, transform 0.15s cubic-bezier(0.55, 0.055, 0.675, 0.19), opacity 0s 0.15s;
}
.hamburger-inner {
    top: 50%;
    transform: translateY(-50%);
    transition: background-color 0s 0.15s linear;
}
.hamburger-inner::before {
    top: -10px;
}
.hamburger-inner::after {
    bottom: -10px;
}
.mobile-menu-toggle.is-open .hamburger-inner {
    transform: rotate(225deg); 
    transition-delay: 0s;
    transition-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
    background-color: var(--color-warning); 
}
.mobile-menu-toggle.is-open .hamburger-inner::before {
    top: 0;
    transform: rotate(-45deg); 
    opacity: 0; 
    transition: top 0.1s ease-out, opacity 0.1s ease-out;
}
.mobile-menu-toggle.is-open .hamburger-inner::after {
    bottom: 0;
    transform: rotate(-90deg); 
    transition: bottom 0.1s ease-out, transform 0.15s 0.15s cubic-bezier(0.215, 0.61, 0.355, 1);
}
@media (min-width: 769px) {
    .mobile-menu-toggle {
        display: none;
    }
}
.theme-toggle {
    background: none;
    border: none;
    padding: 5px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease;
    width: 34px; 
    height: 34px;
}
.theme-toggle:hover {
    background-color: rgba(255, 255, 255, 0.15);
}
.theme-toggle img {
    width: 20px; 
    height: 20px;
    display: block;
}
.theme-toggle .moon-icon {
    display: none;
}
.theme-toggle .sun-icon {
    display: block;
}
.dark-mode .theme-toggle .moon-icon {
    display: block;
}
.dark-mode .theme-toggle .sun-icon {
    display: none;
}
.nav-separator {
    display: none; 
}
@media (min-width: 769px) {
    .nav-separator {
        display: block;
        width: 1px;
        height: 20px;
        background-color: rgba(255, 255, 255, 0.2);
    }
}
.visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}
body.menu-open {
    overflow: hidden;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\5-layout\header.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\5-layout\page.css ---
.page-wrapper {
    width: 100%;
    max-width: 1600px; 
    margin: 0 auto;
    padding: 20px;
    flex-grow: 1; 
    box-sizing: border-box;
}
.dashboard-wrapper {
    max-width: 100%; 
    padding: 20px 30px;
}
.dark-mode .dashboard-wrapper {
    background-color: #0d1117;
}
.container {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    margin: 20px auto;
    max-width: 500px;
}
@media (max-width: 768px) {
    .dashboard-wrapper {
        padding: 15px;
    }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\5-layout\page.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\5-layout\sidebar.css ---
.dashboard-sidebar {
    position: sticky;
    top: 100px; 
    background-color: var(--color-surface);
    border-radius: 12px; 
    padding: 20px;
    border: none;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.05);
}
.dashboard-sidebar h2 {
    font-size: 1.4rem;
    color: var(--color-text);
    margin-top: 0;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--color-border);
}
.dashboard-nav {
    display: flex;
    flex-direction: column;
    gap: 8px;
}
.dashboard-nav-item {
    display: block;
    padding: 12px 18px;
    text-decoration: none;
    color: #4a5568; 
    font-weight: 600;
    border-radius: 8px;
    transition: background-color 0.2s ease, color 0.2s ease, transform 0.2s ease;
    position: relative;
}
.dark-mode .dashboard-nav-item {
    color: var(--color-text-muted);
}
.dashboard-nav-item:hover {
    background-color: #f1f5f9;
    color: var(--color-primary);
    transform: translateX(5px);
}
.dark-mode .dashboard-nav-item:hover {
    background-color: #ffffff0d;
    color: #fff;
}
.dashboard-nav-item.active {
    background: linear-gradient(90deg, var(--color-primary), var(--color-secondary));
    color: white;
    font-weight: 700;
    box-shadow: 0 4px 15px rgba(158, 0, 89, 0.2);
}
.dark-mode .dashboard-nav-item.active {
    box-shadow: 0 4px 15px rgba(169, 114, 255, 0.2);
}
@media (max-width: 992px) {
    .dashboard-sidebar {
        position: static; 
        top: auto;
    }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\5-layout\sidebar.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\button.css ---
.btn {
    position: relative;
    overflow: hidden;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    gap: 8px; 
    color: white;
    padding: 12px 20px; 
    margin-bottom: 15px;
    border: none;
    border-radius: 8px; 
    cursor: pointer;
    font-size: 1rem;
    font-weight: 600;
    text-decoration: none;
    text-align: center;
    transition: all 0.2s ease-out;
    width: 100%;
    box-sizing: border-box;
    min-height: 44px; 
}
.btn:hover {
    text-decoration: none;
    transform: translateY(-2px); 
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}
.btn:active {
    transform: translateY(0);
    box-shadow: none;
}
.btn:disabled,
.btn.disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}
.btn:last-child {
    margin-bottom: 0;
}
.btn-primary {
    background-color: var(--color-primary);
    color: white;
}
.btn-primary:hover {
    background-color: #2d007a; 
}
.btn-success {
    background-color: var(--color-success);
    color: white;
}
.btn-success:hover {
    background-color: #218838;
}
.btn-warning {
    background-color: var(--color-warning);
    color: #333; 
}
.btn-warning:hover {
    background-color: #e6ac00;
}
.btn-danger {
    background-color: var(--color-danger);
    color: white;
}
.btn-danger:hover {
    background-color: #d60047;
}
.btn-secondary {
    background-color: var(--color-secondary);
    color: white;
}
.btn-secondary:hover {
    background-color: #84004a;
}
.btn-outline {
    background-color: transparent;
    border: 2px solid var(--color-border);
    color: var(--color-text-muted);
    padding: 10px 18px; 
}
.btn-outline:hover {
    background-color: var(--color-surface-alt);
    border-color: var(--color-text);
    color: var(--color-text);
}
.dark-mode .btn-outline {
    border-color: var(--color-border);
    color: var(--color-text-muted);
}
.dark-mode .btn-outline:hover {
    background-color: var(--color-surface-alt);
    border-color: var(--color-text);
    color: var(--color-text);
}
.btn-small {
    padding: 6px 12px;
    font-size: 0.85rem;
    font-weight: 600;
    min-height: 32px;
}
.btn .icon-user-check,
.btn .icon-edit,
.btn .icon-trash {
    display: inline-block;
    width: 1em;
    height: 1em;
    margin-right: 5px;
    font-family: 'feather'; 
}
.icon-user-check:before { content: '\e8a0'; } 
.icon-edit:before { content: '\e890'; }
.icon-trash:before { content: '\e891'; }
.publish-actions .btn-small {
    padding: 6px 10px;
    font-size: 0.85rem;
    min-width: 100px; 
    height: 36px; 
    display: flex; 
    justify-content: center;
    align-items: center;
    box-sizing: border-box; 
    margin-bottom: 0; 
}
.publish-actions .btn-small.btn-warning {
    background-color: var(--color-warning);
    color: #333; 
    border: 1px solid var(--color-warning);
}
.publish-actions .btn-small.btn-warning:hover {
    background-color: #e6ac00;
    border-color: #e6ac00;
}
.dark-mode .publish-actions .btn-small.btn-warning {
    background-color: #e6ac00;
    border-color: #e6ac00;
}
.dark-mode .publish-actions .btn-small.btn-warning:hover {
    background-color: var(--color-warning);
    border-color: var(--color-warning);
}
.bulk-actions-controls .btn-small {
    padding: 6px 12px;
    font-size: 0.85rem;
    height: 36px;
    width: auto;
    display: inline-flex;
    gap: 6px;
    align-items: center;
    background-color: #f8f9fa;
    color: var(--color-text);
    border: 1px solid var(--color-border);
    margin-bottom: 0;
}
.bulk-actions-controls .btn-small:hover {
    background-color: #e9ecef;
    color: var(--color-primary);
}
.dark-mode .bulk-actions-controls .btn-small {
    background-color: var(--color-surface-alt);
    color: var(--color-text);
    border-color: var(--color-border);
}
.dark-mode .bulk-actions-controls .btn-small:hover {
    background-color: #343a40;
    color: var(--color-primary);
}
.bulk-actions-controls .btn-small svg {
    margin-top: -2px; 
}
#absence-form .btn-danger {
    flex-grow: 0; 
    width: auto;
    margin-bottom: 0; 
}
#absence-form.absence-form-layout #absence-actions-group .btn {
    flex-grow: 0 !important;
    flex-basis: auto !important;
    width: auto !important;
    margin-bottom: 0; 
}
#absence-form.absence-form-layout #absence-actions-group #absence-delete-btn {
    margin-left: auto;
}
@media (max-width: 768px) {
    .bulk-actions-controls {
        flex-direction: column;
        align-items: stretch; 
    }
    .bulk-actions-controls .btn-small {
        width: 100%;
        justify-content: center;
    }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\button.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\form.css ---
.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: 600;
}

input[type="text"],
input[type="password"],
input[type="email"],
input[type="date"],
input[type="time"], /* HINZUGEF√úGT */
input[type="number"],
input[type="file"],
select,
textarea {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid var(--color-border);
    border-radius: 8px;
    box-sizing: border-box;
    background-color: var(--color-surface);
    color: var(--color-text);
    font-family: var(--font-body);
    font-size: 1rem;
    min-height: 44px; 
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

textarea {
    min-height: 120px;
    resize: vertical;
}

input:focus, 
select:focus, 
textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(57, 0, 153, 0.15);
}

.dark-mode input:focus, 
.dark-mode select:focus, 
.dark-mode textarea:focus {
    box-shadow: 0 0 0 3px rgba(169, 114, 255, 0.2);
}

select {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23333' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 16px;
    padding-right: 40px; 
}

.dark-mode select {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23CCC' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");
}

.form-actions {
    margin-top: 30px;
    display: flex;
    gap: 10px;
    justify-content: flex-end; 
}

.form-actions .btn-secondary,
.form-actions .btn-primary {
    flex-grow: 1;
    flex-basis: 0;
    width: 0;
}

.form-actions .btn-danger { 
    flex-grow: 0;
    width: auto;
}

.form-hint {
    font-size: 0.85rem;
    color: var(--color-text-muted);
    display: block;
    margin-top: 5px;
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    font-weight: normal; 
    padding: 10px;
    background-color: var(--color-surface-alt);
    border-radius: 8px;
    border: 1px solid var(--color-border);
}

.dark-mode .checkbox-label {
    background-color: var(--color-surface);
}

.checkbox-label input[type="checkbox"] {
    width: 1.2em; 
    height: 1.2em;
    margin: 0;
    flex-shrink: 0;
    accent-color: var(--color-primary);
}

.form-grid-col-2 {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
    gap: 15px;
}

.form-grid-col-3 {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); 
    gap: 15px;
}

.input-group {
    display: flex;
    align-items: center;
}

.input-group input[type="text"] {
    flex-grow: 1;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    border-right: none;
}

.input-group .btn {
    flex-shrink: 0;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    height: 44px; 
    width: auto;
    margin-bottom: 0;
    padding: 0 12px;
}

.form-container {
    background-color: var(--color-surface-alt);
    padding: 25px;
    border-radius: 8px;
    border: 1px solid var(--color-border);
    margin-bottom: 30px; 
}

.dark-mode .form-container {
    background-color: var(--color-background);
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\form.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\messages.css ---
.message {
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 8px;
    text-align: left;
    border: 1px solid transparent;
    font-weight: 500;
}
.message.error {
    background-color: rgba(255, 0, 84, 0.1); 
    color: var(--color-danger);
    border-color: rgba(255, 0, 84, 0.2);
}
.message.info {
    background-color: rgba(57, 0, 153, 0.05); 
    color: var(--color-primary);
    border-color: rgba(57, 0, 153, 0.1);
}
.message.success {
    background-color: rgba(40, 167, 69, 0.1); 
    color: #218838; 
    border-color: rgba(40, 167, 69, 0.2);
}
.dark-mode .message.success {
    color: var(--color-success);
}
.toast-notification {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translate(-50%, 100px); 
    padding: 15px 25px;
    border-radius: 8px;
    color: white;
    font-weight: 600;
    z-index: 2000; 
    transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1), opacity 0.4s ease;
    opacity: 0;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}
.toast-notification.visible {
    transform: translate(-50%, 0);
    opacity: 1;
}
.toast-notification.toast-success { background-color: var(--color-success); }
.toast-notification.toast-error { background-color: var(--color-danger); }
.toast-notification.toast-info { background-color: var(--color-primary); }
.confirm-overlay {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(5px);
    z-index: 1999; 
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    padding: 20px;
    box-sizing: border-box;
}
.confirm-overlay.visible {
    opacity: 1;
}
.confirm-box {
    background: var(--color-surface);
    padding: 30px;
    border-radius: 12px;
    width: 90%;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    transform: scale(0.95);
    transition: transform 0.3s cubic-bezier(0.165, 0.84, 0.44, 1);
}
.confirm-overlay.visible .confirm-box {
    transform: scale(1);
}
.confirm-box h2 { 
    margin-top: 0; 
    margin-bottom: 10px;
    color: var(--color-text);
}
.confirm-box p {
    color: var(--color-text-muted);
    font-size: 1rem;
    line-height: 1.6;
    margin-bottom: 0;
}
.confirm-box p strong {
    color: var(--color-primary);
}
.dark-mode .confirm-box p strong {
    color: var(--color-primary);
}
.confirm-actions {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 25px;
}
.confirm-actions .btn {
    flex-grow: 1; 
    flex-basis: 0; 
    width: 0; 
    margin-bottom: 0; 
}
.confirm-actions .btn-secondary {
    background-color: var(--color-surface-alt);
    color: var(--color-text-muted);
    border: 1px solid var(--color-border);
}
.confirm-actions .btn-secondary:hover {
    background-color: #e9ecef;
    color: var(--color-text);
    border-color: #dee2e6;
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
}
.dark-mode .confirm-actions .btn-secondary {
    background-color: var(--color-surface);
    border-color: var(--color-border);
}
.dark-mode .confirm-actions .btn-secondary:hover {
    background-color: #343a40;
    color: var(--color-text);
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\messages.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\modal.css ---
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    z-index: 1040; 
    display: none;
    justify-content: center;
    align-items: flex-start; 
    opacity: 0;
    transition: opacity 0.3s ease;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    padding: 5vh 0; 
    overflow-y: auto; 
}
.modal-overlay.visible { 
    display: flex; 
    opacity: 1; 
}
.modal-box {
    background: var(--color-surface);
    padding: 25px 30px; 
    border-radius: 12px;
    width: 90%; 
    max-width: 500px; 
    box-sizing: border-box;
    max-height: 90vh; 
    overflow-y: auto; 
    margin: 0;
    display: flex;
    flex-direction: column;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
}
.modal-box h2 { 
    margin-top: 0; 
    margin-bottom: 20px;
    color: var(--color-text);
}
.modal-actions {
    display: flex;
    gap: 15px;
    margin-top: 30px;
    justify-content: space-between; 
    align-items: center;
}
.modal-actions .btn {
    width: auto; 
    flex-grow: 0; 
    flex-basis: auto; 
    margin-bottom: 0;
}
.modal-actions-right {
    display: flex;
    gap: 15px;
    flex-grow: 1; 
}
.modal-actions-right .btn {
    flex-grow: 1; 
    width: 0;
    flex-basis: 0;
}
.modal-actions .btn-secondary {
    background-color: var(--color-surface-alt);
    color: var(--color-text-muted);
    border: 1px solid var(--color-border);
}
.modal-actions .btn-secondary:hover {
    background-color: #e9ecef;
    color: var(--color-text);
}
.dark-mode .modal-actions .btn-secondary {
    background-color: var(--color-surface);
    border-color: var(--color-border);
}
.dark-mode .modal-actions .btn-secondary:hover {
    background-color: #343a40;
}
#modal-conflict-warning {
    display: none;
    background-color: rgba(255, 0, 84, 0.1); 
    border: 1px solid var(--color-danger);
    color: var(--color-danger);
    padding: 15px;
    border-radius: 8px;
    margin-top: 20px;
    font-weight: 600;
}
#modal-conflict-warning div {
    margin-bottom: 5px;
}
#modal-conflict-warning div:last-child {
    margin-bottom: 0;
}
.dark-mode #modal-conflict-warning {
    color: #ff8984;
    border-color: #ff8984;
}
.modal-tabs { 
    display: flex; 
    border-bottom: 1px solid var(--color-border); 
    margin-bottom: 20px; 
}
.modal-tabs .tab-button { 
    padding: 10px 15px; 
    border: none; 
    background: transparent; 
    cursor: pointer; 
    font-size: 1rem; 
    font-weight: 600; 
    color: var(--color-text-muted); 
    border-bottom: 3px solid transparent; 
    transition: color 0.2s, border-color 0.2s; 
}
.modal-tabs .tab-button:hover { 
    color: var(--color-primary); 
}
.modal-tabs .tab-button.active { 
    color: var(--color-primary); 
    border-bottom-color: var(--color-primary); 
}
.modal-tab-content { display: none; }
.modal-tab-content.active { display: block; }
#manage-templates-modal {
    z-index: 1050; 
}
#manage-templates-modal .modal-box {
    max-width: 800px; 
    width: 95%; 
}
#timetable-modal {
    z-index: 1060; 
}
.manage-templates-view.active {
    display: flex; 
    flex-direction: column;
    flex: 1;
    min-height: 0;
}
#template-editor-view {
    display: none; 
    flex: 1;
    min-height: 0; 
    display: flex;
    flex-direction: column;
}
#template-editor-view > div:nth-of-type(2) {
    display: flex;
    flex-direction: column; 
    gap: 15px;
    margin-bottom: 15px;
    flex-shrink: 0; 
}
#template-editor-grid-container {
    margin-top: 15px;
    border: 1px solid var(--color-border);
    border-radius: 8px;
    overflow-x: auto; 
    overflow-y: hidden; 
    flex-shrink: 1; 
    min-height: 300px; 
}
@media (min-width: 600px) {
    #template-editor-view > div:nth-of-type(2) {
        flex-direction: row;
    }
}
@media (max-width: 768px) {
    #manage-templates-modal .modal-box {
        padding: 15px; 
        width: 95vw; 
    }
    #template-editor-view > div:nth-of-type(2) { 
        flex-direction: column; 
    }
}
.copy-week-form {
    display: grid;
    grid-template-columns: 1fr auto 1fr 1fr;
    gap: 15px;
    align-items: flex-end;
    margin-bottom: 20px;
}
.copy-week-form .form-group {
    margin-bottom: 0;
}
.copy-week-form input[readonly] {
    background-color: var(--color-surface-alt);
    color: var(--color-text-muted);
    font-weight: bold;
}
.dark-mode .copy-week-form input[readonly] {
    background-color: var(--color-background);
}
.copy-week-form .arrow-separator {
    font-size: 2rem;
    font-weight: bold;
    color: var(--color-text-muted);
    padding-bottom: 5px; 
}
#copy-week-warning {
    display: block; 
    background-color: rgba(255, 189, 0, 0.1);
    border: 1px solid var(--color-warning);
    color: #664d03; 
    margin-top: 0;
    margin-bottom: 20px;
    padding: 10px 15px;
    border-radius: 6px;
}
.dark-mode #copy-week-warning {
    color: var(--color-warning);
}
.modal-box.small-modal {
    max-width: 450px; 
    overflow-y: auto;
}
.plan-detail-content {
    display: flex;
    flex-direction: column;
    gap: 12px;
}
.detail-row {
    display: flex;
    font-size: 1rem;
    padding-bottom: 10px;
    border-bottom: 1px dashed var(--color-border);
}
.detail-row:last-child {
    border-bottom: none;
    padding-bottom: 0;
}
.detail-label {
    font-weight: 600;
    color: var(--color-text-muted);
    width: 100px; 
    flex-shrink: 0;
}
.detail-value {
    color: var(--color-text);
    font-weight: 500;
    word-break: break-word;
}
.detail-value.status-vertretung,
.detail-value.status-sonderevent {
    color: var(--color-danger);
    font-weight: 700;
}
.detail-value.status-raum√§nderung {
    color: var(--color-warning);
    font-weight: 700;
}
.detail-value.status-entfall {
    color: var(--color-text-muted);
    font-weight: 700;
    text-decoration: line-through;
}
.detail-row.detail-comment .detail-value {
    font-style: italic;
    color: var(--color-secondary);
}
.dark-mode .detail-row.detail-comment .detail-value {
    color: var(--color-primary);
}
.detail-row.detail-notes {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    border-bottom: none;
    padding-bottom: 0;
}
#detail-notes-input {
    margin-top: 5px;
    min-height: 80px; 
}
#note-save-spinner {
    display: none; 
    margin-top: 8px;
    margin-left: auto; 
}
#my-post-edit-modal .modal-box {
    max-width: 600px;
}
#my-post-edit-modal .modal-close-btn {
    position: absolute;
    top: 10px;
    right: 15px;
    background: none;
    border: none;
    font-size: 2rem;
    color: var(--color-text-muted);
    cursor: pointer;
    line-height: 1;
    padding: 5px;
}
#my-post-edit-modal .modal-close-btn:hover {
    color: var(--color-danger);
}
#my-post-edit-modal .modal-actions {
    justify-content: flex-end;
}
#my-post-edit-modal .btn-secondary {
    flex-grow: 0;
    width: auto;
    background-color: var(--color-surface-alt);
    color: var(--color-text-muted);
    border: 1px solid var(--color-border);
}
#my-post-edit-modal .btn-secondary:hover {
    background-color: #e9ecef;
}
.dark-mode #my-post-edit-modal .btn-secondary {
    background-color: var(--color-surface);
    border-color: var(--color-border);
}
.dark-mode #my-post-edit-modal .btn-secondary:hover {
    background-color: #343a40;
}
#my-post-edit-modal .btn-primary {
    flex-grow: 1;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\modal.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\post.css ---
.posts-list-container {
    display: flex;
    flex-direction: column;
    gap: 15px;
    overflow-y: auto;
    padding: 5px; 
}
.community-post-item,
.announcement-item,
.my-post-item {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.03);
    transition: box-shadow 0.2s ease;
    display: flex;
    flex-direction: column;
}
.community-post-item:hover,
.announcement-item:hover,
.my-post-item:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
}
.dark-mode .community-post-item,
.dark-mode .announcement-item,
.dark-mode .my-post-item {
    background-color: var(--color-surface-alt);
}
.post-header,
.announcement-header {
    padding: 15px 20px;
    border-bottom: 1px solid var(--color-border);
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 15px;
    flex-wrap: wrap; 
}
.post-title,
.announcement-header strong {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--color-primary);
    word-break: break-word; 
}
.post-meta,
.announcement-header small {
    font-size: 0.8rem;
    color: var(--color-text-muted);
    text-align: right;
    flex-shrink: 0;
    line-height: 1.5;
}
.announcement-header {
    align-items: center; 
}
.announcement-title-meta {
    display: flex;
    flex-direction: column;
    gap: 2px;
}
.announcement-badge {
    font-size: 0.7rem;
    font-weight: bold;
    padding: 3px 8px;
    border-radius: 4px;
    text-transform: uppercase;
    white-space: nowrap;
}
.announcement-badge.global {
    background-color: var(--color-secondary);
    color: white;
}
.announcement-badge.class {
    background-color: var(--color-surface-alt);
    color: var(--color-text-muted);
    border: 1px solid var(--color-border);
}
.dark-mode .announcement-badge.class {
    background-color: var(--color-surface);
}
.post-meta a {
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 600;
}
.post-meta a:hover {
    text-decoration: underline;
}
.dark-mode .post-meta a {
    color: var(--color-primary);
}
.post-content-preview,
.announcement-content {
    padding: 20px;
    font-size: 0.95rem;
    line-height: 1.6;
    color: var(--color-text);
    word-wrap: break-word;
}
.announcement-content {
    padding-top: 15px;
}
.dark-mode .post-content-preview,
.dark-mode .announcement-content {
    color: var(--color-text);
}
.post-content-preview p:first-child,
.announcement-content p:first-child { margin-top: 0; }
.post-content-preview p:last-child,
.announcement-content p:last-child { margin-bottom: 0; }
.post-content-preview ul, .post-content-preview ol,
.announcement-content ul, .announcement-content ol { 
    padding-left: 1.5em; 
    margin-bottom: 1em; 
}
.post-content-preview a,
.announcement-content a { color: var(--color-primary); }
.post-content-preview a:hover,
.announcement-content a:hover { color: var(--color-secondary); }
.dark-mode .post-content-preview a,
.dark-mode .announcement-content a { color: var(--color-primary); }
.dark-mode .post-content-preview a:hover,
.dark-mode .announcement-content a:hover { color: var(--color-warning); }
.announcement-attachment {
    padding: 10px 20px;
    margin: 0;
    border-top: 1px solid var(--color-border);
    background-color: var(--color-surface-alt);
}
.dark-mode .announcement-attachment {
    background-color: var(--color-background);
}
.announcement-attachment a {
    font-size: 0.9rem;
    font-weight: 600;
    text-decoration: none;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\post.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\status.css ---
.status-indicator {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 5px;
    font-size: 0.8rem;
    font-weight: 600;
}
.status-indicator.published {
    background-color: var(--color-success);
    color: white;
}
.status-indicator.not-published {
    background-color: #e9ecef;
    color: #6c757d;
}
.dark-mode .status-indicator.not-published {
    background-color: #343a40;
    color: #adb5bd;
}
.status-badge {
    font-size: 0.75rem;
    font-weight: 700;
    padding: 4px 8px;
    border-radius: 5px;
    text-transform: uppercase;
}
.status-badge.status-pending { 
    background-color: var(--color-warning);
    color: #333;
}
.status-badge.status-approved {
    background-color: var(--color-success);
    color: white;
}
.status-badge.status-rejected {
    background-color: var(--color-danger);
    color: white;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\status.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\table.css ---
/* public/assets/css/6-components/table.css */
.table-container {
    width: 100%;
    margin-top: 20px;
}

.table-responsive {
    overflow-x: auto;
    width: 100%;
    border: 1px solid var(--color-border);
    border-radius: 8px;
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
}

.data-table th,
.data-table td {
    padding: 12px 15px;
    border-bottom: 1px solid var(--color-border);
    text-align: left;
    vertical-align: middle;
    white-space: nowrap; /* Standard f√ºr Desktop */
}

.data-table th {
    background-color: var(--color-surface-alt);
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.dark-mode .data-table th {
    background-color: var(--color-surface-alt);
}

.data-table tbody tr:nth-child(even) {
    background-color: #fcfdff;
}

.dark-mode .data-table tbody tr:nth-child(even) {
    background-color: #ffffff05;
}

.data-table tbody tr:hover {
    background-color: #f1f5f9;
}

.dark-mode .data-table tbody tr:hover {
    background-color: #ffffff0d;
}

.data-table .actions {
    display: flex;
    gap: 8px;
    align-items: center;
}

.data-table .actions .btn-small {
    padding: 5px 10px;
    font-size: 0.8rem;
    width: auto;
    border-radius: 5px;
    flex-grow: 1;
    flex-basis: 0;
    text-align: center;
    margin-bottom: 0;
}

/* === NEU: Responsive Card-Ansicht f√ºr Tabellen === */

@media (max-width: 768px) {
    .table-responsive {
        border: none; /* Container-Rand entfernen */
        overflow-x: hidden; /* Kein horizontales Scrollen mehr */
    }

    .data-table {
        border: none;
        box-shadow: none;
    }

    .data-table thead {
        /* Wichtige Header verstecken */
        border: none;
        clip: rect(0 0 0 0);
        height: 1px;
        margin: -1px;
        overflow: hidden;
        padding: 0;
        position: absolute;
        width: 1px;
    }

    .data-table tr {
        /* Jede Zeile wird eine "Karte" */
        display: block;
        margin-bottom: 15px;
        border: 1px solid var(--color-border);
        border-radius: 8px;
        box-shadow: 0 3px 6px rgba(0,0,0,0.04);
        background-color: var(--color-surface);
        overflow: hidden; /* F√ºr abgerundete Ecken */
    }

    .dark-mode .data-table tr {
        background-color: var(--color-surface-alt);
    }
    
    .data-table tr:nth-child(even) {
        background-color: var(--color-surface); /* Einheitliche Hintergrundfarbe f√ºr alle "Karten" */
    }
    
    .dark-mode .data-table tr:nth-child(even) {
        background-color: var(--color-surface-alt);
    }

    .data-table td {
        display: flex; /* Flexbox f√ºr Label/Inhalt-Paarung */
        justify-content: space-between; /* Label links, Inhalt rechts */
        align-items: center;
        padding: 10px 15px;
        border-bottom: 1px solid var(--color-border);
        white-space: normal; /* Zeilenumbruch erlauben */
        text-align: right; /* Inhalt rechtsb√ºndig */
        font-size: 0.9rem;
    }
    
    .data-table td:last-child {
        border-bottom: none; /* Letzte Zelle hat keine Linie */
    }

    .data-table td::before {
        /* data-label Attribut als Label verwenden */
        content: attr(data-label);
        font-weight: 600;
        color: var(--color-text-muted);
        text-align: left;
        padding-right: 15px;
        white-space: nowrap;
    }

    /* Spezielle Behandlung f√ºr die Aktions-Spalte */
    .data-table td.actions {
        padding: 10px 15px;
        background-color: var(--color-surface-alt);
        justify-content: flex-end; /* Buttons rechtsb√ºndig */
    }
    
    .dark-mode .data-table td.actions {
         background-color: var(--color-surface);
    }

    .data-table td.actions::before {
        display: none; /* Kein Label f√ºr "Aktionen" */
    }
    
    .data-table .actions .btn-small {
        flex-grow: 0; /* Buttons nicht mehr strecken */
        flex-basis: auto;
        width: auto;
    }

    /* Anpassung f√ºr Audit-Log-Details */
    .log-details-cell {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }
    .log-details-cell::before {
        width: 100%;
        margin-bottom: 5px;
    }
    .log-details-cell details {
        width: 100%;
        text-align: left;
    }
    .log-details-cell pre {
        max-width: 100%;
        font-size: 0.7rem;
    }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\table.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\tabs.css ---
.tab-navigation {
    display: flex;
    flex-wrap: wrap; 
    background-color: var(--color-surface-alt);
    padding: 0 10px;
    border-bottom: 1px solid var(--color-border);
}
.dark-mode .tab-navigation {
    background-color: var(--color-surface-alt);
}
.tab-button {
    padding: 15px 20px;
    font-weight: 600;
    font-size: 0.95rem;
    border: none;
    border-bottom: 3px solid transparent; 
    background-color: transparent;
    cursor: pointer;
    color: var(--color-text-muted);
    transition: all 0.2s ease-in-out;
    position: relative;
    top: 1px; 
    white-space: nowrap;
}
.dark-mode .tab-button {
    color: var(--color-text-muted);
}
.tab-button:hover {
    color: var(--color-primary);
    background-color: var(--color-surface);
}
.dark-mode .tab-button:hover {
    color: #fff;
    background-color: var(--color-surface);
}
.tab-button.active {
    color: var(--color-primary);
    font-weight: 700;
    border-bottom-color: var(--color-primary); 
    background-color: var(--color-surface);
}
.dark-mode .tab-button.active {
    color: #fff;
    border-bottom-color: var(--color-primary);
    background-color: var(--color-surface);
}
.tab-content {
    background-color: var(--color-surface);
}
.tab-content .dashboard-section {
    display: none; 
    padding: 25px 30px;
    animation: fadeIn 0.4s ease;
}
.tab-content .dashboard-section.active {
    display: block; 
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}
@media (max-width: 768px) {
    .tab-navigation {
        overflow-x: auto;
        flex-wrap: nowrap;
        justify-content: flex-start;
    }
    .tab-button {
        font-size: 0.85rem;
        padding: 12px 10px;
    }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\tabs.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\timetable.css ---
.timetable-grid { 
    display: grid; 
    grid-template-columns: 70px repeat(5, 1fr); 
    grid-auto-rows: minmax(80px, auto); 
    gap: 2px; 
    background-color: var(--color-border);
    border: 1px solid var(--color-border);
    border-radius: 12px; 
    overflow: hidden; 
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.03);
}
.timetable-grid thead, .timetable-grid tbody, .timetable-grid tr {
    display: contents; 
}
.grid-header { 
    background-color: var(--color-surface); 
    font-weight: 700; 
    font-family: var(--font-display); 
    text-align: center; 
    padding: 10px; 
    font-size: 0.9rem;
    color: var(--color-text);
    display: flex;
    justify-content: center;
    align-items: center;
    vertical-align: middle; 
}
.dark-mode .grid-header { 
    background-color: var(--color-surface-alt); 
}
.grid-header.period-header { 
    grid-column: 1; 
    font-size: 0.8rem; 
    flex-direction: column;
    line-height: 1.4;
    padding: 4px 2px;
    color: var(--color-text-muted);
}
.grid-header.period-header .time-slot-time {
    font-size: 0.7rem;
    font-weight: normal;
    font-family: var(--font-body);
}
.grid-cell { 
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: stretch;
    gap: 0; 
    padding: 0; 
    position: relative;
    background-color: var(--color-surface); 
    min-height: 80px;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
}
.dark-mode .grid-cell { 
    background-color: var(--color-surface); 
}
.grid-cell[data-day="1"] { grid-column: 2; }
.grid-cell[data-day="2"] { grid-column: 3; }
.grid-cell[data-day="3"] { grid-column: 4; }
.grid-cell[data-day="4"] { grid-column: 5; }
.grid-cell[data-day="5"] { grid-column: 6; }
.cell-entries-container {
    display: flex;
    flex-direction: column;
    gap: 2px; 
    height: 100%;
    width: 100%;
    padding: 2px; 
    box-sizing: border-box;
}
.cell-entry,
.planner-entry {
    border-radius: 6px; 
    padding: 5px 8px; 
    border: 1px solid var(--color-border); 
    display: flex; 
    flex-direction: column; 
    justify-content: center; 
    align-items: center; 
    text-align: center; 
    word-break: break-word; 
    flex-grow: 1; 
    height: 100%; 
    box-sizing: border-box; 
    position: relative;
    background: var(--color-surface);
    border-top: 3px solid var(--color-primary); 
    box-shadow: 0 1px 3px rgba(0,0,0,0.03);
    transition: all 0.2s ease;
    pointer-events: none; 
}
.dark-mode .cell-entry,
.dark-mode .planner-entry { 
    background: var(--color-surface-alt); 
    border-color: #444c56; 
}
.grid-cell strong { 
    font-family: var(--font-display);
    font-size: 1.1rem; 
    font-weight: 700; 
    line-height: 1.2;
    color: var(--color-text);
}
.grid-cell span { 
    font-size: 0.8rem; 
    color: var(--color-text-muted); 
    font-weight: 600;
}
.grid-cell small { 
    font-size: 0.75rem; 
    color: var(--color-text-muted); 
}
.grid-cell small.entry-room { 
    font-weight: 700;
}
.grid-cell small.entry-comment { 
    display: block; 
    font-style: italic; 
    color: var(--color-secondary); 
    margin-top: 3px; 
    line-height: 1.2; 
    overflow: hidden; 
    text-overflow: ellipsis; 
    white-space: nowrap; 
    max-width: 90%; 
}
.planner-entry {
    align-items: stretch; 
    text-align: left;
    padding: 4px 8px; 
    gap: 1px;
}
.planner-entry .entry-line {
    text-align: left; 
    padding: 0; 
    pointer-events: none; 
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.planner-entry .entry-subject {
    font-family: var(--font-display);
    font-weight: 700;
    color: var(--color-text);
    font-size: 1rem; 
    line-height: 1.2;
}
.planner-entry .entry-main {
    color: var(--color-text-muted);
    font-size: 0.8rem; 
    font-weight: 600;
}
.planner-entry .entry-room {
    font-size: 0.8rem; 
    color: var(--color-text-muted);
    font-weight: 400;
}
.planner-entry .sub-type {
    font-weight: 700;
    font-size: 0.7rem;
    font-family: var(--font-body);
    text-transform: uppercase;
    margin-bottom: 2px;
    color: var(--color-text-muted);
}
.grid-cell.has-entry,
.grid-cell.is-empty { 
    cursor: pointer;
}
.grid-cell:hover {
    background-color: var(--color-surface);
    transform: scale(1.02);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    z-index: 5;
}
.dark-mode .grid-cell:hover {
    background-color: var(--color-surface-alt);
}
.grid-cell.is-empty:hover {
    transform: none;
    box-shadow: none;
    background-color: #f1f5f9;
}
.dark-mode .grid-cell.is-empty:hover {
    background-color: #ffffff1a;
}
.grid-cell.default-entry { 
    cursor: default; 
}
.grid-cell.default-entry:hover {
    background-color: #f8f9fa;
    transform: none;
    box-shadow: none;
}
.dark-mode .grid-cell.default-entry:hover {
    background-color: #21262d;
}
.grid-cell.selected {
    background-color: var(--color-surface); 
    outline: 2px solid var(--color-primary);
    outline-offset: -2px;
    z-index: 10;
}
.dark-mode .grid-cell.selected {
    background-color: var(--color-surface);
}
.grid-cell.dragging {
    opacity: 0.4;
    transform: scale(0.95);
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}
.timetable-grid.is-dragging .grid-cell {
    transition: background-color 0.3s ease;
}
.grid-cell.drop-target {
    background-color: rgba(57, 0, 153, 0.1);
    transform: scale(1.03);
    z-index: 15;
}
.grid-cell.drop-target-valid {
    background-color: rgba(40, 167, 69, 0.2);
    outline: 2px dashed var(--color-success);
    outline-offset: -2px;
}
.grid-cell.drop-target-invalid {
    background-color: rgba(255, 0, 84, 0.2);
    outline: 2px dashed var(--color-danger);
    outline-offset: -2px;
}
.grid-cell.has-note .cell-entry {
    position: relative;
}
.grid-cell .cell-entry .entry-note {
    position: absolute;
    top: 3px;
    left: 5px;
    font-size: 0.7rem;
    color: var(--color-primary);
}
.grid-cell .cell-entry .entry-note svg {
    width: 10px;
    height: 10px;
}
.dark-mode .grid-cell .cell-entry .entry-note {
    color: var(--color-primary);
}
.grid-cell.default-entry { 
    background-color: #f8f9fa; 
    color: #6c757d; 
    justify-content: center; 
    align-items: center; 
}
.grid-cell.default-entry .cell-entry,
.grid-cell.default-entry .planner-entry {
    flex-grow: 0; 
    height: auto; 
    background: transparent; 
    border: none; 
    box-shadow: none;
    min-height: 0;
    pointer-events: none;
}
.dark-mode .grid-cell.default-entry { 
    background-color: #21262d; 
    color: var(--color-text-muted); 
}
.grid-cell.default-entry strong, 
.grid-cell.default-entry span { 
    text-align: center; 
}
.grid-cell.default-entry .planner-entry .entry-subject,
.grid-cell.default-entry .cell-entry strong {
    color: inherit;
    font-size: 1rem;
    font-family: var(--font-display);
}
.grid-cell.substitution-Vertretung .cell-entry { border-top-color: var(--color-danger); background-color: #fff0f1; }
.grid-cell.substitution-Raum√§nderung .cell-entry { border-top-color: var(--color-warning); background-color: #fff9e6; }
.grid-cell.substitution-Sonderevent .cell-entry { border-top-color: #007bff; background-color: #e7f5ff; }
.grid-cell.substitution-Entfall .cell-entry { border-top-color: #6c757d; background-color: #f8f9fa; text-decoration: line-through; color: #6c757d; opacity: 0.8; }
.dark-mode .grid-cell.substitution-Vertretung .cell-entry { background-color: rgba(255, 0, 84, 0.1); }
.dark-mode .grid-cell.substitution-Raum√§nderung .cell-entry { background-color: rgba(255, 189, 0, 0.1); }
.dark-mode .grid-cell.substitution-Sonderevent .cell-entry { background-color: rgba(0, 123, 255, 0.1); }
.dark-mode .grid-cell.substitution-Entfall .cell-entry { background-color: rgba(108, 117, 125, 0.1); }
.planner-entry.vertretung {
    border-top-color: var(--color-danger);
}
.planner-entry.vertretung .sub-type {
    color: var(--color-danger);
}
.planner-entry.raum√§nderung {
    border-top-color: var(--color-warning);
}
.planner-entry.raum√§nderung .sub-type {
    color: var(--color-warning);
}
.planner-entry.raum√§nderung .entry-room {
    color: var(--color-warning);
    font-weight: 700;
}
.planner-entry.entfall {
    border-top-color: var(--color-text-muted);
    background-color: var(--color-surface-alt);
    opacity: 0.7;
    text-decoration: line-through;
}
.planner-entry.entfall .sub-type {
    color: var(--color-text-muted);
}
.dark-mode .planner-entry.entfall {
    background-color: var(--color-surface);
}
.planner-entry.sonderevent {
    border-top-color: #007bff;
}
.planner-entry.sonderevent .sub-type {
    color: #007bff;
}
.planner-entry.is-absent {
    outline: 1px dashed var(--color-danger);
    outline-offset: -2px;
    background-image: repeating-linear-gradient(
        -45deg,
        transparent,
        transparent 5px,
        rgba(255, 0, 84, 0.05) 5px,
        rgba(255, 0, 84, 0.05) 10px
    );
}
.dark-mode .planner-entry.is-absent {
    background-image: repeating-linear-gradient(
        -45deg,
        transparent,
        transparent 5px,
        rgba(255, 0, 84, 0.1) 5px,
        rgba(255, 0, 84, 0.1) 10px
    );
}
.planner-entry.is-absent .entry-main { 
    color: var(--color-danger);
    font-weight: 700;
}
.planner-entry .absence-warning { 
    font-size: 0.7rem !important;
    font-weight: 700;
    color: var(--color-danger) !important;
    display: block;
}
.grid-cell.block-start { 
    padding: 0; 
    justify-content: stretch; 
}
.grid-cell.block-start .cell-entries-container {
    padding: 2px 0 0 0; 
    gap: 2px;
}
.grid-cell.block-start .cell-entry,
.grid-cell.block-start .planner-entry { 
    border-radius: 0; 
    border: none; 
    width: 100%; 
    height: 100%; 
    padding: 6px 8px;
    border-top-width: 3px; 
}
.template-editor-grid.timetable-grid {
    min-width: 600px; 
    gap: 2px; 
}
.template-editor-grid.timetable-grid th.time-col {
    width: 100px; 
}
.template-editor-grid .grid-header {
    font-size: 0.8rem;
    padding: 5px;
    min-height: 40px;
}
.template-editor-grid .grid-header.period-header {
    font-size: 0.7rem;
    line-height: 1.2;
    padding: 4px 2px;
    grid-column: 1; 
}
.template-editor-grid .grid-cell {
    min-height: 60px; 
}
.template-editor-grid .grid-cell .planner-entry {
    padding: 2px 4px;
    min-height: 50px; 
}
.template-editor-grid .grid-cell .entry-subject { font-size: 0.8rem; }
.template-editor-grid .grid-cell .entry-main { font-size: 0.7rem; }
.template-editor-grid .grid-cell .entry-room { font-size: 0.65rem; }
@media (max-width: 768px) {
    .timetable-grid {
        grid-template-columns: 50px repeat(5, 1fr);
    }
    .grid-cell strong { font-size: 0.8rem; }
    .grid-cell span { font-size: 0.7rem; }
    .grid-cell small { font-size: 0.65rem; }
    .planner-entry .entry-subject { font-size: 0.8rem; }
    .planner-entry .entry-main { font-size: 0.7rem; }
    .planner-entry .entry-room { font-size: 0.7rem; }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\timetable.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\user-menu.css ---
.user-menu {
    position: relative; 
}
.user-menu-toggle {
    display: none; 
    align-items: center;
    gap: 8px;
    background: none;
    border: none;
    font-size: 1rem;
    cursor: pointer;
    color: #fff;
    font-weight: 600;
    padding: 5px; 
    border-radius: 4px;
    transition: background-color 0.2s ease;
}
.user-menu-toggle:hover {
    background-color: rgba(255, 255, 255, 0.1);
}
.user-menu-toggle span {
    white-space: nowrap; 
}
.user-menu-toggle .chevron-down {
    transition: transform 0.2s ease-in-out;
    stroke: #fff; 
}
.user-menu-toggle[aria-expanded="true"] .chevron-down {
    transform: rotate(180deg);
}
.user-menu-dropdown {
    display: none; 
    position: absolute;
    flex-direction: column;
    align-items: stretch; 
    gap: 0; 
    top: calc(100% + 10px); 
    right: 0;
    background-color: #4a0072; 
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
    min-width: 200px; 
    padding: 8px;
    z-index: 1001;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: opacity 0.2s ease, transform 0.2s ease, visibility 0.2s;
}
.user-menu-dropdown.is-open {
    display: flex; 
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}
.user-menu-dropdown a {
    color: rgba(255, 255, 255, 0.85);
    text-decoration: none;
    padding: 10px 15px; 
    border-radius: 5px;
    font-size: 0.95rem;
    font-weight: 500;
    transition: background-color 0.2s ease, color 0.2s ease;
    white-space: nowrap;
}
.user-menu-dropdown a:hover {
    background-color: var(--color-primary); 
    color: #ffffff;
    text-decoration: none;
}
.dropdown-divider {
    display: block;
    height: 1px;
    background-color: rgba(255, 255, 255, 0.15);
    margin: 8px 0; 
}
@media (max-width: 768px) {
    .user-menu {
        width: 100%; 
        display: flex; 
        flex-direction: column;
        align-items: center;
    }
    .user-menu-toggle {
        display: none; 
    }
    .user-menu-dropdown {
        display: flex; 
        position: static; 
        background: none;
        border: none;
        box-shadow: none;
        width: 100%;
        padding: 0;
        opacity: 1;
        visibility: visible;
        transform: none;
        align-items: center; 
        gap: 1.5rem; 
    }
    .user-menu-dropdown a {
        font-size: 1.2rem;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.7);
        padding: 5px; 
    }
    .user-menu-dropdown a:hover {
        background: none; 
        color: var(--color-warning);
    }
    .dropdown-divider {
        display: none; 
    }
}
@media (min-width: 769px) {
    .user-menu-toggle {
        display: flex; 
    }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\user-menu.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\widget.css ---
.dashboard-widget {
    background-color: var(--color-surface);
    border-radius: 10px;
    padding: 20px 25px; 
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
    border: 1px solid var(--color-border);
    display: flex;
    flex-direction: column;
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    position: relative; 
    user-select: none; 
}
.dark-mode .dashboard-widget {
    background-color: var(--color-surface-alt);
}
.dashboard-widget[draggable="true"] { 
    cursor: move; 
}
.dashboard-widget.dragging { 
    opacity: 0.5; 
    transform: scale(0.98); 
    box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
}
.widget-placeholder {
    background: rgba(57, 0, 153, 0.05); 
    border: 2px dashed var(--color-primary);
    border-radius: 10px; 
    margin: 0; 
    padding: 0; 
    transition: height 0.1s ease-out; 
    box-sizing: border-box;
}
.dark-mode .widget-placeholder { 
    background: rgba(169, 114, 255, 0.1); 
    border-color: var(--color-primary); 
}
.dashboard-widget h3, 
.dashboard-widget p, 
.dashboard-widget .stat-list, 
.dashboard-widget .system-info-list, 
.dashboard-widget .activity-list, 
.dashboard-widget .btn, 
.dashboard-widget .toggle-switch, 
.dashboard-widget a {
    cursor: auto; 
    user-select: text;
}
.dashboard-widget .slider { 
    cursor: pointer; 
}
.dashboard-widget h3 {
    font-size: 1.2rem; 
    margin-top: 0; 
    margin-bottom: 20px; 
    padding-bottom: 15px;
    border-bottom: 1px solid var(--color-border); 
    display: flex; 
    align-items: center; 
    gap: 8px;
}
.widget-link { 
    display: block; 
    text-align: right; 
    font-size: 0.85rem; 
    font-weight: 600; 
    margin-top: auto; 
    color: var(--color-primary); 
}
.widget-link:hover { 
    text-decoration: underline; 
}
.widget-action-footer { 
    margin-top: auto; 
    padding-top: 15px; 
    border-top: 1px solid var(--color-border); 
    display: flex; 
    align-items: center; 
    gap: 15px; 
}
.widget-action-footer .btn-small { 
    padding: 6px 12px; 
    font-size: 0.85rem; 
    width: auto; 
    margin-bottom: 0; 
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\6-components\widget.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\7-utilities\flex.css ---
.dashboard-widget {
    background-color: var(--color-surface);
    border-radius: 10px;
    padding: 20px 25px; 
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
    border: 1px solid var(--color-border);
    display: flex;
    flex-direction: column;
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    position: relative; 
    user-select: none; 
}
.dark-mode .dashboard-widget {
    background-color: var(--color-surface-alt);
}
.dashboard-widget[draggable="true"] { 
    cursor: move; 
}
.dashboard-widget.dragging { 
    opacity: 0.5; 
    transform: scale(0.98); 
    box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
}
.widget-placeholder {
    background: rgba(57, 0, 153, 0.05); 
    border: 2px dashed var(--color-primary);
    border-radius: 10px; 
    margin: 0; 
    padding: 0; 
    transition: height 0.1s ease-out; 
    box-sizing: border-box;
}
.dark-mode .widget-placeholder { 
    background: rgba(169, 114, 255, 0.1); 
    border-color: var(--color-primary); 
}
.dashboard-widget h3, 
.dashboard-widget p, 
.dashboard-widget .stat-list, 
.dashboard-widget .system-info-list, 
.dashboard-widget .activity-list, 
.dashboard-widget .btn, 
.dashboard-widget .toggle-switch, 
.dashboard-widget a {
    cursor: auto; 
    user-select: text;
}
.dashboard-widget .slider { 
    cursor: pointer; 
}
.dashboard-widget h3 {
    font-size: 1.2rem; 
    margin-top: 0; 
    margin-bottom: 20px; 
    padding-bottom: 15px;
    border-bottom: 1px solid var(--color-border); 
    display: flex; 
    align-items: center; 
    gap: 8px;
}
.widget-link { 
    display: block; 
    text-align: right; 
    font-size: 0.85rem; 
    font-weight: 600; 
    margin-top: auto; 
    color: var(--color-primary); 
}
.widget-link:hover { 
    text-decoration: underline; 
}
.widget-action-footer { 
    margin-top: auto; 
    padding-top: 15px; 
    border-top: 1px solid var(--color-border); 
    display: flex; 
    align-items: center; 
    gap: 15px; 
}
.widget-action-footer .btn-small { 
    padding: 6px 12px; 
    font-size: 0.85rem; 
    width: auto; 
    margin-bottom: 0; 
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\7-utilities\flex.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\7-utilities\helpers.css ---
.hidden {
    display: none !important;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\7-utilities\helpers.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\7-utilities\spacing.css ---
.hidden {
    display: none !important;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\7-utilities\spacing.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-announcements.css ---
#announcement-form textarea {
    min-height: 120px;
    font-family: inherit;
    font-size: 1rem;
    padding: 10px 12px;
    border: 1px solid var(--color-border);
    border-radius: 8px;
    box-sizing: border-box;
    background-color: var(--color-surface);
    color: var(--color-text);
    width: 100%;
}
#announcement-form textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(57, 0, 153, 0.15);
}
.target-group-fieldset {
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
}
.target-group-fieldset legend {
    padding: 0 10px;
    font-weight: 600;
}
.checkbox-group {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 15px;
}
#current-attachment-info a {
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 600;
}
#current-attachment-info a:hover {
    text-decoration: underline;
}
#current-attachment-info label {
    font-weight: normal;
    margin-left: 5px; 
    cursor: pointer;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-announcements.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-audit-log.css ---
.filter-form {
    padding: 15px;
    margin: 0;
}
.filter-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    align-items: flex-end;
}
.filter-grid .form-group {
    margin-bottom: 0;
}
.filter-form .form-actions {
    margin-top: 20px;
    justify-content: flex-start;
}
.filter-form .form-actions .btn {
    width: auto;
    flex-grow: 0;
    margin-bottom: 0;
}
.pagination-summary {
    font-size: 0.9rem; 
    color: var(--color-text-muted);
}
.pagination-controls {
    margin-top: 20px; 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    gap: 10px;
}
.pagination-controls .btn-small {
    width: auto;
    margin-bottom: 0;
}
.pagination-info {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--color-text-muted);
}
.log-details-cell {
    white-space: normal;
    min-width: 250px;
}
.log-details summary {
    cursor: pointer;
    font-size: 0.85rem;
    color: var(--color-primary);
    font-weight: 600;
}
.log-details pre {
    background-color: var(--color-surface-alt);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    padding: 10px;
    margin-top: 8px;
    font-size: 0.75rem;
    max-height: 200px;
    overflow: auto;
}
.dark-mode .log-details pre {
    background-color: var(--color-background);
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-audit-log.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-community.css ---
.moderation-actions {
    padding: 15px 20px;
    background-color: var(--color-surface-alt);
    border-top: 1px solid var(--color-border);
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    border-radius: 0 0 7px 7px;
}
.dark-mode .moderation-actions {
     background-color: var(--color-background);
}
.moderation-actions .btn-small {
    width: auto;
    flex-grow: 0;
    margin-bottom: 0;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-community.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-csv-template.css ---
.csv-preview-table th,
.csv-preview-table td {
    font-size: 0.85rem;
    white-space: nowrap;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-csv-template.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-dashboard.css ---
.widget-stats .stat-grid { 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); 
    gap: 15px; 
    margin-bottom: 10px; 
}
.widget-stats .stat-item { 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    justify-content: center; 
    text-align: center; 
    padding: 10px 5px; 
    background-color: var(--color-surface-alt); 
    border-radius: 8px; 
    border: 1px solid var(--color-border); 
}
.dark-mode .widget-stats .stat-item { 
    background-color: var(--color-surface); 
}
.widget-stats .stat-value { 
    font-size: 2.2rem; 
    font-weight: 700; 
    font-family: var(--font-display); 
    color: var(--color-primary); 
    line-height: 1.1; 
}
.widget-stats .stat-label { 
    font-size: 0.8rem; 
    font-weight: 600; 
    color: var(--color-text-muted); 
    text-transform: uppercase; 
    letter-spacing: 0.5px; 
}
.widget-stats .stat-item.main-stat { 
    grid-column: 1 / -1; 
    padding: 15px; 
    background-color: var(--color-primary); 
    color: white; 
    border-color: var(--color-primary); 
}
.widget-stats .stat-item.main-stat .stat-value { 
    font-size: 2.8rem; 
    color: white; 
}
.widget-stats .stat-item.main-stat .stat-label { 
    color: rgba(255, 255, 255, 0.8); 
}
.widget-stats .stat-item.sub-stat .stat-value { 
    font-size: 1.8rem; 
    color: var(--color-secondary); 
}
.dark-mode .widget-stats .stat-item.sub-stat .stat-value { 
    color: var(--color-secondary); 
}
.widget-stats .stat-divider { 
    border: 0; 
    height: 1px; 
    background-color: var(--color-border); 
    margin: 10px 0 15px 0; 
}
.widget-stats .bottom-grid { 
    grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); 
}
.widget-stats .bottom-grid .stat-value { 
    font-size: 1.8rem; 
    color: var(--color-text); 
}
.dark-mode .widget-stats .bottom-grid .stat-value { 
    color: var(--color-text); 
}
.widget-maintenance .setting-control { 
    margin-bottom: 5px; 
    justify-content: space-between;
}
.widget-maintenance .toggle-status { 
    font-size: 1rem; 
}
.widget-maintenance p { 
    margin-bottom: 10px; 
    line-height: 1.5; 
    font-size: 0.85rem;
}
.widget-activity .activity-list { 
    list-style: none; 
    padding: 0; 
    margin: 0 0 15px 0; 
    font-size: 0.85rem; 
    max-height: 160px; 
    overflow-y: auto; 
}
.widget-activity .activity-list li { 
    margin-bottom: 8px; 
    padding-bottom: 8px; 
    border-bottom: 1px dashed var(--color-border); 
    line-height: 1.4; 
}
.widget-activity .activity-list li:last-child { 
    margin-bottom: 0; 
    padding-bottom: 0; 
    border-bottom: none; 
}
.widget-activity .log-time { 
    color: var(--color-text-muted); 
    margin-right: 5px; 
    font-weight: 600; 
}
.widget-activity .log-user { 
    font-weight: 600; 
    color: var(--color-primary); 
    margin-right: 5px; 
}
.dark-mode .widget-activity .log-user { 
    color: var(--color-primary); 
}
.widget-activity .log-action { 
    color: var(--color-text); 
}
.widget-activity .log-target { 
    color: #6c757d; 
    font-style: italic; 
    margin-left: 5px; 
}
.widget-quicklinks .quicklink-buttons { 
    display: grid; 
    grid-template-columns: 1fr 1fr; 
    gap: 10px; 
}
.widget-quicklinks .quicklink-buttons .btn { 
    width: 100%; 
    margin: 0; 
    padding: 10px; 
    font-size: 0.9rem; 
    background-color: #f8f9fa; 
    color: var(--color-text); 
    border: 1px solid var(--color-border); 
}
.widget-quicklinks .quicklink-buttons .btn svg { 
    width: 16px; 
    height: 16px; 
    flex-shrink: 0; 
}
.widget-quicklinks .quicklink-buttons .btn:hover { 
    background-color: #e9ecef; 
    color: var(--color-primary); 
    border-color: #dee2e6; 
}
.dark-mode .widget-quicklinks .quicklink-buttons .btn { 
    background-color: var(--color-surface); 
    color: var(--color-text); 
    border-color: var(--color-border); 
}
.dark-mode .widget-quicklinks .quicklink-buttons .btn:hover { 
    background-color: #343a40; 
    color: #fff; 
    border-color: #495057; 
}
.widget-system-info .system-info-list { 
    display: flex; 
    flex-direction: column; 
    gap: 12px; 
    margin: 0; 
    padding: 0; 
}
.widget-system-info .info-item { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    font-size: 0.9rem; 
    padding-bottom: 8px; 
    border-bottom: 1px dashed var(--color-border); 
}
.widget-system-info .info-item:last-child { 
    border-bottom: none; 
    padding-bottom: 0; 
}
.widget-system-info .info-label { 
    font-weight: 600; 
    color: var(--color-text-muted); 
}
.widget-system-info .info-value { 
    font-weight: 600; 
    color: var(--color-text); 
    background-color: var(--color-surface-alt); 
    padding: 3px 8px; 
    border-radius: 5px; 
    font-family: monospace; 
    font-size: 0.85rem; 
}
.dark-mode .widget-system-info .info-value { 
    background-color: var(--color-surface); 
    color: var(--color-text); 
}
.widget-publish-status .publish-status-group { 
    margin-bottom: 15px; 
}
.widget-publish-status .publish-status-group strong { 
    display: block; 
    margin-bottom: 8px; 
    font-size: 0.9rem; 
    color: var(--color-text); 
}
.widget-publish-status .status-indicators { 
    display: flex; 
    gap: 10px; 
}
.widget-system-status .system-check-list { 
    list-style: none; 
    padding: 0; 
    margin: 0 0 15px 0; 
    cursor: help; 
}
.widget-system-status .system-check-list li { 
    display: flex; 
    align-items: flex-start; 
    justify-content: space-between; 
    font-size: 0.9rem; 
    margin-bottom: 8px; 
    padding-bottom: 8px; 
    border-bottom: 1px dashed var(--color-border); 
    gap: 15px; 
}
.widget-system-status .system-check-list li:last-child { 
    margin-bottom: 0; 
    padding-bottom: 0; 
    border-bottom: none; 
}
.widget-system-status .status-info { 
    display: flex; 
    align-items: flex-start; 
    flex-shrink: 0; 
    margin-right: 10px; 
    flex-basis: auto; 
    min-width: 0; 
    word-break: break-word; 
}
.widget-system-status .status-icon { 
    font-size: 1.1rem; 
    margin-right: 10px; 
    flex-shrink: 0; 
    margin-top: 2px; 
}
.widget-system-status .status-label { 
    font-weight: 600; 
    color: var(--color-text); 
}
.widget-system-status .status-message { 
    color: var(--color-text-muted); 
    font-weight: 600; 
    margin-left: auto; 
    text-align: right; 
    word-break: break-word; 
    flex-shrink: 0; 
    padding-left: 10px; 
}
.widget-system-status li.status-ok .status-icon { 
    color: var(--color-success); 
}
.widget-system-status li.status-fail .status-icon { 
    color: var(--color-danger); 
}
.widget-system-status li.status-fail .status-message { 
    color: var(--color-danger); 
    font-weight: 700; 
}
@media (max-width: 768px) {
    .widget-quicklinks .quicklink-buttons { 
        grid-template-columns: 1fr; 
    }
}
.dashboard-content .section-header {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
}
.dashboard-content .section-header h3 {
     margin-bottom: 5px; 
     padding-bottom: 0;
     border-bottom: none;
}
.dashboard-content .section-header .btn {
    width: auto;
    margin-bottom: 0;
}
.dashboard-content h4 {
    font-size: 1.3rem;
    margin-bottom: 20px;
}
.form-container {
    background-color: var(--color-surface-alt);
    padding: 25px;
    border-radius: 8px;
    border: 1px solid var(--color-border);
    margin-bottom: 30px; 
}
.dark-mode .form-container {
    background-color: var(--color-background);
}
.form-container .form-actions {
    justify-content: flex-end; 
}
.form-container .form-actions .btn {
    flex-grow: 1;
    flex-basis: 0;
    width: 0;
}
.form-container .form-actions .btn-secondary {
    flex-grow: 0;
    width: auto;
    background-color: var(--color-surface);
    color: var(--color-text-muted);
    border: 1px solid var(--color-border);
}
.form-container .form-actions .btn-secondary:hover {
    background-color: #e9ecef;
}
.dark-mode .form-container .form-actions .btn-secondary {
    background-color: var(--color-surface);
    border-color: var(--color-border);
}
.dark-mode .form-container .form-actions .btn-secondary:hover {
    background-color: #343a40;
}
.target-group-fieldset {
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
}
.target-group-fieldset legend {
    padding: 0 10px;
    font-weight: 600;
}
.checkbox-group {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 15px;
}
#current-attachment-info a {
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 600;
}
#current-attachment-info a:hover {
    text-decoration: underline;
}
#current-attachment-info label {
    font-weight: normal;
    margin-left: 5px; 
    cursor: pointer;
}
.filter-form {
    padding: 15px;
    margin: 0;
}
.filter-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    align-items: flex-end;
}
.filter-grid .form-group {
    margin-bottom: 0;
}
.filter-form .form-actions {
    margin-top: 20px;
    justify-content: flex-start;
}
.filter-form .form-actions .btn {
    width: auto;
    flex-grow: 0;
    margin-bottom: 0;
}
.pagination-summary {
    font-size: 0.9rem; 
    color: var(--color-text-muted);
}
.pagination-controls {
    margin-top: 20px; 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    gap: 10px;
}
.pagination-controls .btn-small {
    width: auto;
    margin-bottom: 0;
}
.pagination-info {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--color-text-muted);
}
.log-details-cell {
    white-space: normal;
    min-width: 250px;
}
.log-details summary {
    cursor: pointer;
    font-size: 0.85rem;
    color: var(--color-primary);
    font-weight: 600;
}
.log-details pre {
    background-color: var(--color-surface-alt);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    padding: 10px;
    margin-top: 8px;
    font-size: 0.75rem;
    max-height: 200px;
    overflow: auto;
}
.dark-mode .log-details pre {
    background-color: var(--color-background);
}
.settings-section.form-container {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    padding: 25px;
    margin: 0 0 25px 0; 
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
}
.dark-mode .settings-section.form-container {
    background-color: var(--color-surface-alt);
}
.setting-row {
    display: grid; 
    grid-template-columns: 1fr 1fr; 
    gap: 30px;
    padding: 25px 0; 
    border-bottom: 1px solid var(--color-border); 
    align-items: center;
}
.setting-row:first-of-type { 
    padding-top: 10px; 
}
.setting-row:last-of-type { 
    border-bottom: none; 
    padding-bottom: 10px; 
}
.setting-info label { 
    font-size: 1.1rem; 
    font-weight: 600; 
    color: var(--color-text); 
}
.setting-info p { 
    font-size: 0.9rem; 
    color: var(--color-text-muted); 
    margin-bottom: 0; 
    line-height: 1.5; 
}
.setting-control { 
    display: flex; 
    align-items: center; 
    gap: 15px; 
}
.setting-control input[type="text"],
.setting-control input[type="number"],
.setting-control textarea,
.setting-control select {
    max-width: 450px; 
    margin-bottom: 0; 
    width: 100%;
}
.setting-control.file-upload-control { 
    flex-direction: column; 
    align-items: flex-start; 
    gap: 10px; 
}
.setting-control input[type="file"] { 
    width: 100%; 
    max-width: 450px; 
}
.file-preview { 
    font-size: 0.9rem; 
    color: var(--color-text-muted); 
    display: flex; 
    align-items: center; 
    gap: 10px; 
    min-height: 30px; 
}
.file-preview img.logo-preview { 
    max-height: 40px; 
    width: auto; 
    border: 1px solid var(--color-border); 
    border-radius: 4px; 
    background: #f8f9fa; 
}
.dark-mode .file-preview img.logo-preview { 
    background: #30363d; 
}
.file-preview img.favicon-preview { 
    height: 24px; 
    width: 24px; 
    border: 1px solid var(--color-border); 
    border-radius: 4px; 
    background: #f8f9fa; 
}
.dark-mode .file-preview img.favicon-preview { 
    background: #30363d; 
}
.remove-file-label { 
    font-size: 0.8rem; 
    color: var(--color-danger); 
    cursor: pointer; 
    font-weight: 600; 
}
.remove-file-label input { 
    margin-right: 4px; 
}
.toggle-switch { 
    position: relative; 
    display: inline-block; 
    width: 60px; 
    height: 34px; 
    flex-shrink: 0; 
}
.toggle-switch input { 
    opacity: 0; 
    width: 0; 
    height: 0; 
}
.slider { 
    position: absolute; 
    cursor: pointer; 
    top: 0; left: 0; right: 0; bottom: 0; 
    background-color: #ccc; 
    transition: .4s; 
    border-radius: 34px; 
}
.dark-mode .slider { 
    background-color: #30363d; 
}
.slider:before { 
    position: absolute; 
    content: ""; 
    height: 26px; 
    width: 26px; 
    left: 4px; 
    bottom: 4px; 
    background-color: white; 
    transition: .4s; 
    border-radius: 50%; 
}
input:checked + .slider { 
    background-color: var(--color-success); 
}
input:checked + .slider:before { 
    transform: translateX(26px); 
}
.toggle-status { 
    font-weight: 600; 
    font-size: 0.9rem; 
    color: var(--color-text-muted); 
    transition: color 0.4s; 
}
input:checked ~ .toggle-status { 
    color: var(--color-success); 
}
@media (max-width: 768px) {
    .setting-row { 
        grid-template-columns: 1fr; 
        gap: 15px; 
    }
    .setting-control input[type="text"],
    .setting-control input[type="number"],
    .setting-control textarea,
    .setting-control select { 
        max-width: 100%; 
    }
}
.health-widget {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 12px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
}
.dark-mode .health-widget {
    background-color: var(--color-surface-alt);
}
.health-widget h3 {
    font-size: 1.3rem;
    margin: 0;
    padding: 20px 25px;
    border-bottom: 1px solid var(--color-border);
}
.health-list {
    list-style: none;
    padding: 25px;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 18px;
}
.health-list li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 1rem;
    padding-bottom: 18px;
    border-bottom: 1px dashed var(--color-border);
}
.health-list li:last-child {
    border-bottom: none;
    padding-bottom: 0;
}
.health-label {
    font-weight: 600;
    color: var(--color-text-muted);
}
.health-value {
    font-weight: 600;
    font-family: var(--font-display);
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    gap: 6px;
}
.health-value.status-ok {
    color: var(--color-success);
}
.health-value.status-error {
    color: var(--color-danger);
}
.health-value.status-warn {
    color: var(--color-warning);
}
.health-widget.widget-permissions .health-label {
    font-family: monospace;
    font-size: 0.9rem;
    color: var(--color-text);
}
.dark-mode .health-widget.widget-permissions .health-label {
     color: var(--color-text-muted);
}
.csv-preview-table th,
.csv-preview-table td {
    font-size: 0.85rem;
    white-space: nowrap;
}
.import-results-box {
    background-color: var(--color-background);
    border: 1px solid var(--color-border);
    padding: 15px;
    border-radius: 4px;
    max-height: 200px;
    overflow-y: auto;
    font-size: 0.85rem;
    line-height: 1.6;
}
.dark-mode .import-results-box {
    background-color: #000;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-dashboard.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-settings.css ---
.settings-section.form-container {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    padding: 25px;
    margin-top: 0; 
    margin-bottom: 25px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
}
.dark-mode .settings-section.form-container {
    background-color: var(--color-surface-alt);
    border-color: var(--color-border);
}
#settings-management .form-container:not(.settings-section) {
    padding: 0; margin: 0; background: transparent; border: none; box-shadow: none;
}
.setting-row {
    display: grid; grid-template-columns: 1fr 1fr; gap: 30px;
    padding: 25px 0; border-bottom: 1px solid var(--color-border); align-items: center;
}
.setting-row:first-of-type { padding-top: 10px; }
.setting-row:last-of-type { border-bottom: none; padding-bottom: 10px; }
.setting-info label { font-size: 1.1rem; font-weight: 600; color: var(--color-text); }
.setting-info p { font-size: 0.9rem; color: var(--color-text-muted); margin-bottom: 0; line-height: 1.5; }
.setting-control { display: flex; align-items: center; gap: 15px; }
.setting-control input[type="text"],
.setting-control input[type="number"],
.setting-control textarea,
.setting-control select {
    max-width: 450px; margin-bottom: 0; width: 100%;
}
.setting-control.file-upload-control { flex-direction: column; align-items: flex-start; gap: 10px; }
.setting-control input[type="file"] { width: 100%; max-width: 450px; }
.file-preview { font-size: 0.9rem; color: var(--color-text-muted); display: flex; align-items: center; gap: 10px; min-height: 30px; }
.file-preview img.logo-preview { max-height: 40px; width: auto; border: 1px solid var(--color-border); border-radius: 4px; background: #f8f9fa; }
.dark-mode .file-preview img.logo-preview { background: #30363d; }
.file-preview img.favicon-preview { height: 24px; width: 24px; border: 1px solid var(--color-border); border-radius: 4px; background: #f8f9fa; }
.dark-mode .file-preview img.favicon-preview { background: #30363d; }
.remove-file-label { font-size: 0.8rem; color: var(--color-danger); cursor: pointer; font-weight: 600; }
.remove-file-label input { margin-right: 4px; }
.toggle-switch { position: relative; display: inline-block; width: 60px; height: 34px; flex-shrink: 0; }
.toggle-switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
.dark-mode .slider { background-color: #30363d; }
.slider:before { position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
input:checked + .slider { background-color: var(--color-success); }
input:checked + .slider:before { transform: translateX(26px); }
.toggle-status { font-weight: 600; font-size: 0.9rem; color: var(--color-text-muted); transition: color 0.4s; }
input:checked ~ .toggle-status { color: var(--color-success); }
@media (max-width: 768px) {
    .setting-row { grid-template-columns: 1fr; gap: 15px; }
    .setting-control input[type="text"],
    .setting-control input[type="number"],
    .setting-control textarea,
    .setting-control select { max-width: 100%; }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-settings.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-system-health.css ---
.health-widget {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 12px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
}
.dark-mode .health-widget {
    background-color: var(--color-surface-alt);
}
.health-widget h3 {
    font-size: 1.3rem;
    margin: 0;
    padding: 20px 25px;
    border-bottom: 1px solid var(--color-border);
}
.health-list {
    list-style: none;
    padding: 25px;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 18px;
}
.health-list li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 1rem;
    padding-bottom: 18px;
    border-bottom: 1px dashed var(--color-border);
}
.health-list li:last-child {
    border-bottom: none;
    padding-bottom: 0;
}
.health-label {
    font-weight: 600;
    color: var(--color-text-muted);
}
.health-value {
    font-weight: 600;
    font-family: var(--font-display);
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    gap: 6px;
}
.health-value.status-ok {
    color: var(--color-success);
}
.health-value.status-error {
    color: var(--color-danger);
}
.health-value.status-warn {
    color: var(--color-warning);
}
.health-widget.widget-permissions .health-label {
    font-family: monospace;
    font-size: 0.9rem;
    color: var(--color-text);
}
.dark-mode .health-widget.widget-permissions .health-label {
     color: var(--color-text-muted);
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-system-health.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-users.css ---
.import-results-box {
    background-color: var(--color-background);
    border: 1px solid var(--color-border);
    padding: 15px;
    border-radius: 4px;
    max-height: 200px;
    overflow-y: auto;
    font-size: 0.85rem;
    line-height: 1.6;
}
.dark-mode .import-results-box {
    background-color: #000;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\admin-users.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\auth.css ---
.auth-container {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    padding: 30px 40px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    margin: 40px auto;
    max-width: 400px;
    width: 90%;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\auth.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\dashboard-cockpit.css ---
.dashboard-section .section-title-hidden {
    display: none; 
}

.dashboard-section h4 {
    font-size: 1.5rem;
    font-family: var(--font-display);
    margin: 0 0 10px 0;
    color: var(--color-text);
}

#section-announcements {
    padding: 0; 
}

#announcements-list {
    max-height: 80vh; 
    overflow-y: auto;
    padding: 0; 
}

#announcements-list .loading-spinner { 
    margin-top: 20px; 
}

#section-my-day {
    background-color: var(--color-surface-alt);
}

.dark-mode #section-my-day {
    background-color: var(--color-background);
}

#today-schedule-container {
    margin-top: 0; 
    max-height: none; 
    overflow-y: visible;
    padding-right: 0;
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-height: 50px;
}

.today-entry {
    display: grid;
    grid-template-columns: 60px 1fr auto; 
    gap: 10px 15px;
    padding: 12px 15px;
    border-radius: 8px;
    background-color: var(--color-surface); 
    border-left: 4px solid var(--color-primary);
    align-items: center;
}

.dark-mode .today-entry {
    background-color: var(--color-surface);
    border-left-color: var(--color-primary);
}

.today-entry .entry-actions {
    display: flex;
    align-items: center;
    gap: 8px;
    justify-content: flex-end;
}

.today-entry .time { 
    font-weight: 600; 
    font-size: 0.85rem; 
    color: var(--color-text-muted); 
    text-align: right; 
}

.today-entry .details strong { 
    font-size: 1rem; 
    display: block; 
    margin-bottom: 2px; 
}

.today-entry .details span { 
    font-size: 0.85rem; 
    color: var(--color-text-muted); 
}

.today-entry .details span + span::before { 
    content: " ‚Ä¢ "; 
    margin: 0 4px; 
}

.today-entry .details small.entry-comment { 
    display: block; 
    font-size: 0.8rem; 
    color: var(--color-secondary); 
    margin-top: 3px; 
    font-style: italic; 
}

.today-entry .cancel-appointment-btn {
    padding: 2px 6px;
    font-size: 0.9rem;
    line-height: 1;
    height: 24px;
    width: 24px;
    margin-left: 5px;
    background-color: transparent;
    border: 1px solid transparent;
    color: var(--color-text-muted);
}

.today-entry .cancel-appointment-btn:hover {
    color: var(--color-danger);
    background-color: rgba(255, 0, 84, 0.1);
    border-color: rgba(255, 0, 84, 0.3);
}

.today-entry .btn-ics {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 2px 6px;
    height: 24px;
    width: 24px;
    font-size: 0.9rem;
    line-height: 1;
    color: var(--color-text-muted);
    background-color: transparent;
    border: 1px solid transparent;
    border-radius: 4px;
    text-decoration: none;
    transition: all 0.2s ease;
}

.today-entry .btn-ics:hover {
    color: var(--color-primary);
    background-color: rgba(57, 0, 153, 0.1);
    border-color: rgba(57, 0, 153, 0.3);
    text-decoration: none;
}

.today-entry .btn-ics svg {
    width: 14px;
    height: 14px;
}

.today-entry .details small.entry-note {
    display: block;
    font-size: 0.8rem;
    color: var(--color-primary);
    font-style: italic;
    margin-top: 4px;
    font-weight: 600;
}

.today-entry .details small.entry-note svg {
    width: 12px;
    height: 12px;
    margin-right: 4px;
    vertical-align: -2px;
}

.dark-mode .today-entry .details small.entry-note {
    color: var(--color-primary);
}

.today-entry .type-badge { 
    font-size: 0.7rem; 
    font-weight: bold; 
    padding: 3px 8px; 
    border-radius: 4px; 
    text-transform: uppercase; 
    white-space: nowrap; 
}

.today-entry.type-regular { border-left-color: var(--color-primary); }
.today-entry.type-Vertretung { border-left-color: var(--color-danger); background-color: #fff0f1; }
.today-entry.type-Raum√§nderung { border-left-color: var(--color-warning); background-color: #fff9e6; }
.today-entry.type-Sonderevent { border-left-color: #007bff; background-color: #e7f5ff; }
.today-entry.type-Entfall { border-left-color: #6c757d; background-color: #f8f9fa; text-decoration: line-through; opacity: 0.7; }

.dark-mode .today-entry.type-Vertretung { background-color: rgba(255, 0, 84, 0.1); }
.dark-mode .today-entry.type-Raum√§nderung { background-color: rgba(255, 189, 0, 0.1); }
.dark-mode .today-entry.type-Sonderevent { background-color: rgba(0, 123, 255, 0.1); }
.dark-mode .today-entry.type-Entfall { background-color: rgba(108, 117, 125, 0.1); }

.today-entry .type-badge.type-regular { background-color: var(--color-primary); color: white; }
.today-entry .type-badge.type-Vertretung { background-color: var(--color-danger); color: white; }
.today-entry .type-badge.type-Raum√§nderung { background-color: var(--color-warning); color: #333; }
.today-entry .type-badge.type-Sonderevent { background-color: #007bff; color: white; }
.today-entry .type-badge.type-Entfall { background-color: #6c757d; color: white; }

.today-entry.type-klausur { border-left-color: var(--color-danger); background-color: #fff0f1; }
.dark-mode .today-entry.type-klausur { background-color: rgba(255, 0, 84, 0.1); }
.today-entry .type-badge.type-klausur { background-color: var(--color-danger); color: white; }
.today-entry.type-klausur .time { color: var(--color-danger); font-weight: 700; font-size: 0.8rem; }

.today-entry.type-aufgabe { border-left-color: var(--color-primary); background-color: #f0f0ff; }
.dark-mode .today-entry.type-aufgabe { background-color: rgba(57, 0, 153, 0.1); }
.today-entry .type-badge.type-aufgabe { background-color: var(--color-primary); color: white; }
.today-entry.type-aufgabe .time { color: var(--color-primary); font-weight: 700; font-size: 0.8rem; }

.today-entry.type-info { border-left-color: var(--color-success); background-color: #e6f7ec; }
.dark-mode .today-entry.type-info { background-color: rgba(40, 167, 69, 0.1); }
.today-entry .type-badge.type-info { background-color: var(--color-success); color: white; }
.today-entry.type-info .time { color: var(--color-success); font-weight: 700; font-size: 0.8rem; }

.today-entry.type-appointment { border-left-color: var(--color-secondary); background-color: #fdf0f7; }
.dark-mode .today-entry.type-appointment { background-color: rgba(158, 0, 89, 0.1); }
.today-entry .type-badge.type-appointment { background-color: var(--color-secondary); color: white; }
.today-entry .type-appointment .time { color: var(--color-secondary); font-weight: 700; }
.today-entry .type-appointment .details small.entry-comment { color: var(--color-text-muted); font-style: normal; }


.today-schedule-container .loading-spinner.small { height: 30px; width: 30px; margin: 10px auto; }
.today-schedule-container .message.info { padding: 15px; margin: 0; text-align: center; }

#section-weekly-plan .dashboard-header { 
    display: flex; 
    flex-wrap: wrap; 
    justify-content: space-between; 
    align-items: center; 
    gap: 15px; 
    margin-bottom: 15px; 
    padding-bottom: 15px; 
    border-bottom: 1px solid var(--color-border); 
}

#section-weekly-plan .dashboard-header .section-title { 
    margin-bottom: 0; 
    border-bottom: none; 
    padding-bottom: 0; 
}

.plan-controls { 
    display: flex; 
    gap: 15px; 
}
.plan-controls .form-group { 
    margin-bottom: 0; 
}
.plan-controls .form-group label { 
    font-size: 0.8rem; 
}
.plan-controls select, .plan-controls input { 
    min-height: 38px; 
    padding-top: 0; 
    padding-bottom: 0; 
}

.plan-header-info { 
    font-weight: 600; 
    color: var(--color-text-muted); 
    margin-bottom: 1.5rem; 
    text-align: center; 
    font-size: 0.9rem; 
}

.ical-subscription-box {
    margin-top: 25px; 
    margin-bottom: 0; 
    padding: 15px;
    background-color: var(--color-surface-alt); 
    border-radius: 8px;
    border: 1px solid var(--color-border);
}

.dark-mode .ical-subscription-box {
    background-color: var(--color-surface-alt);
    border-color: var(--color-border);
}

.ical-subscription-box label { 
    display: block; 
    font-weight: 600; 
    margin-bottom: 8px; 
    font-size: 0.9rem; 
    color: var(--color-text); 
}
.ical-subscription-box .form-hint { 
    margin-top: 8px; 
    font-size: 0.8rem; 
}

.print-export-actions {
    display: flex;
    gap: 10px;
    align-items: flex-end; 
}
.print-export-actions .btn {
    margin-bottom: 0; 
    width: auto; 
    padding: 8px 15px; 
    height: 38px;
    font-size: 0.9rem;
}
body.role-admin .print-export-actions {
    display: none !important;
}

.cockpit-feature {
    position: relative; 
    margin-bottom: 20px;
}

.cockpit-feature h4 {
    font-size: 1.5rem;
    font-family: var(--font-display);
    margin: 0 0 20px 0;
    color: var(--color-text);
    border-bottom: 1px solid var(--color-border);
    padding-bottom: 10px;
}

.cockpit-feature .form-container {
    margin: 0 0 20px 0; 
    border: 1px solid var(--color-border);
    padding: 20px;
    background-color: var(--color-surface-alt);
    border-radius: 8px;
}

.dark-mode .cockpit-feature .form-container {
    background-color: var(--color-background);
}

.office-hours-form-grid {
    display: grid;
    /* KORRIGIERT: 3 Spalten Layout (2fr 1fr 1fr) */
    grid-template-columns: 2fr 1fr 1fr; 
    gap: 15px 20px;
    align-items: flex-end;
}
.office-hours-form-grid .form-group { margin: 0; padding: 0; }
.office-hours-form-grid .form-actions { margin: 0; padding: 0; }

/* KORRIGIERT: Layout-Regeln */
/* Zeile 1 */
.office-hours-form-grid .form-group:nth-of-type(1) { grid-column: 1 / 2; } /* Wochentag */
.office-hours-form-grid .form-group:nth-of-type(2) { grid-column: 2 / 3; } /* Von */
.office-hours-form-grid .form-group:nth-of-type(3) { grid-column: 3 / 4; } /* Bis */

/* Zeile 2 */
.office-hours-form-grid .form-group:nth-of-type(4) { grid-column: 1 / 3; } /* Raum/Ort (spannt √ºber 2 Spalten) */
.office-hours-form-grid .form-group:nth-of-type(5) { grid-column: 3 / 4; } /* Slot */

/* Zeile 3 */
.office-hours-form-grid .form-actions { 
    grid-column: 3 / 4; /* Button (unter Slot) */
    padding-bottom: 0; 
}


@media (max-width: 992px) {
    /* KORRIGIERT: Tablet-Fallback (2 Spalten) */
    .office-hours-form-grid { 
        grid-template-columns: 1fr 1fr; 
    }
    .office-hours-form-grid .form-group:nth-of-type(1) { grid-column: 1 / -1; } /* Wochentag (volle Breite) */
    .office-hours-form-grid .form-group:nth-of-type(2) { grid-column: 1 / 2; } /* Von */
    .office-hours-form-grid .form-group:nth-of-type(3) { grid-column: 2 / 3; } /* Bis */
    .office-hours-form-grid .form-group:nth-of-type(4) { grid-column: 1 / -1; } /* Raum/Ort (volle Breite) */
    .office-hours-form-grid .form-group:nth-of-type(5) { grid-column: 1 / 2; } /* Slot */
    .office-hours-form-grid .form-actions { grid-column: 2 / 3; } /* Button */
}
@media (max-width: 576px) {
    /* Mobile-Fallback (1 Spalte) */
    .office-hours-form-grid { grid-template-columns: 1fr; }
    .office-hours-form-grid .form-group,
    .office-hours-form-grid .form-actions { grid-column: 1 / -1; }
}

.office-hours-list-container {
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: 10px;
    background-color: var(--color-surface-alt);
}
.dark-mode .office-hours-list-container {
    background-color: var(--color-background);
}
.office-hours-list-container .message {
    margin-bottom: 0; 
}

.office-hour-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    border-bottom: 1px solid var(--color-border);
    font-size: 0.9rem;
    background-color: var(--color-surface);
}
.dark-mode .office-hour-item {
    background-color: var(--color-surface);
}
.office-hour-item:first-child {
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
}
.office-hour-item:last-child {
    border-bottom: none;
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
}
.office-hour-details {
    display: flex;
    align-items: center;
    gap: 15px;
}
.office-hour-day-badge {
    font-family: var(--font-display);
    font-size: 1rem;
    font-weight: 700;
    color: var(--color-primary);
    background-color: #f0f0ff;
    border-radius: 6px;
    padding: 8px 12px;
    min-width: 60px;
    text-align: center;
}
.dark-mode .office-hour-day-badge {
    background-color: rgba(169, 114, 255, 0.1);
    color: var(--color-primary);
}
.office-hour-time-info strong {
    font-weight: 600;
    color: var(--color-text);
    font-size: 1rem;
}
.office-hour-time-info span {
    font-size: 0.85rem;
    color: var(--color-text-muted);
    display: block;
    margin-top: 2px;
    font-weight: 500;
}
.office-hour-item .delete-office-hour-btn {
    padding: 2px 8px;
    font-size: 1rem;
    line-height: 1;
    height: 28px;
    width: 28px;
}

.search-results-dropdown {
    display: none; position: absolute; top: 100%; left: 0; right: 0;
    background-color: var(--color-surface); border: 1px solid var(--color-border);
    border-top: none; border-radius: 0 0 8px 8px; box-shadow: 0 8px 15px rgba(0,0,0,0.08);
    z-index: 100; max-height: 250px; overflow-y: auto;
}
.search-results-dropdown.visible { display: block; }
.search-result-item { padding: 12px 15px; cursor: pointer; border-bottom: 1px solid var(--color-border); font-size: 0.9rem; }
.search-result-item:last-child { border-bottom: none; }
.search-result-item:hover { background-color: var(--color-surface-alt); color: var(--color-primary); }
.dark-mode .search-result-item:hover { background-color: #ffffff0d; }
.search-result-item.none { color: var(--color-text-muted); cursor: default; }

.search-result-display { margin-top: 15px; padding: 15px; background-color: var(--color-surface-alt); border-radius: 8px; border: 1px solid var(--color-border); min-height: 60px; display: flex; align-items: center; gap: 10px; }
.dark-mode .search-result-display { background-color: var(--color-background); }
.search-result-display p { margin: 0; line-height: 1.5; color: var(--color-text); }
.search-result-display p strong { color: var(--color-primary); }
.search-result-display .loading-spinner.small { height: 24px; width: 24px; flex-shrink: 0; }

#attendance-current-lesson { padding: 15px; background-color: var(--color-surface-alt); border-radius: 8px; border: 1px solid var(--color-border); margin-bottom: 15px; min-height: 50px; display: flex; align-items: center; }
.dark-mode #attendance-current-lesson { background-color: var(--color-background); }
#attendance-current-lesson .lesson-info { font-size: 1.1rem; font-weight: 600; }
#attendance-current-lesson .lesson-info strong { color: var(--color-primary); font-family: var(--font-display); font-size: 1.3rem; }
#attendance-current-lesson .message.info { margin: 0; padding: 0; background: transparent; border: none; text-align: left; }

.attendance-list-container { border: 1px solid var(--color-border); border-radius: 8px; overflow: hidden; }
.attendance-list-header { display: flex; justify-content: space-between; padding: 10px 15px; background-color: var(--color-surface-alt); border-bottom: 1px solid var(--color-border); font-weight: 600; font-size: 0.8rem; color: var(--color-text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
.dark-mode .attendance-list-header { background-color: var(--color-background); }
.attendance-student-list { list-style: none; margin: 0; padding: 0; max-height: 400px; overflow-y: auto; }
.student-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; border-bottom: 1px solid var(--color-border); }
.student-row:last-child { border-bottom: none; }
.student-row .student-name { font-weight: 600; color: var(--color-text); }
.attendance-toggles { display: flex; gap: 5px; }
.attendance-toggles .btn-toggle { font-size: 0.8rem; font-weight: 700; padding: 5px 10px; border: 1px solid var(--color-border); background-color: var(--color-surface); color: var(--color-text-muted); border-radius: 5px; cursor: pointer; transition: all 0.2s ease; }
.dark-mode .attendance-toggles .btn-toggle { background-color: var(--color-surface-alt); border-color: #444; }
.attendance-toggles .btn-toggle:hover { background-color: #f0f0f0; }
.dark-mode .attendance-toggles .btn-toggle:hover { background-color: #333; }
.attendance-toggles .btn-toggle.status-anwesend.active { background-color: var(--color-success); color: white; border-color: var(--color-success); }
.attendance-toggles .btn-toggle.status-abwesend.active { background-color: var(--color-danger); color: white; border-color: var(--color-danger); }
.attendance-toggles .btn-toggle.status-verspaetet.active { background-color: var(--color-warning); color: #333; border-color: var(--color-warning); }
.attendance-toggles .btn-toggle.status-entschuldigt.active { background-color: var(--color-primary); color: white; border-color: var(--color-primary); }

#academic-events-feature h5 { font-size: 1rem; font-weight: 600; color: var(--color-text-muted); margin: 20px 0 10px 0; padding-bottom: 5px; border-bottom: 1px solid var(--color-border); }
.event-list-container { max-height: 300px; overflow-y: auto; border: 1px solid var(--color-border); border-radius: 8px; }
.event-group { margin-bottom: 10px; }
.event-group:last-child { margin-bottom: 0; }
.event-group-date { font-size: 0.85rem; font-weight: 600; color: var(--color-text-muted); padding: 8px 12px; background-color: var(--color-surface-alt); border-bottom: 1px solid var(--color-border); position: sticky; top: 0; z-index: 1; }
.dark-mode .event-group-date { background-color: var(--color-background); }
.event-list-items { list-style: none; padding: 0; margin: 0; }
.event-list-item { display: flex; align-items: center; gap: 10px; padding: 10px 12px; border-bottom: 1px solid var(--color-border); }
.event-list-item:last-child { border-bottom: none; }
.event-list-item .event-icon { font-size: 1.2rem; flex-shrink: 0; width: 24px; text-align: center; }
.event-list-item .event-details { flex-grow: 1; font-size: 0.9rem; line-height: 1.4; }
.event-list-item .event-details strong { display: block; color: var(--color-text); }
.event-list-item .event-details span { font-size: 0.8rem; color: var(--color-text-muted); }
.event-list-item .event-details small { font-size: 0.8rem; color: #555; font-style: italic; display: block; margin-top: 3px; }
.dark-mode .event-list-item .event-details small { color: #aaa; }
.event-list-item .delete-event-btn { flex-shrink: 0; padding: 2px 8px; font-size: 1rem; line-height: 1; height: 28px; width: 28px; background-color: transparent; border: 1px solid transparent; color: var(--color-text-muted); }
.event-list-item .delete-event-btn:hover { color: var(--color-danger); background-color: rgba(255, 0, 84, 0.1); border-color: rgba(255, 0, 84, 0.3); }
.event-list-item.type-klausur .event-icon { color: var(--color-danger); }
.event-list-item.type-aufgabe .event-icon { color: var(--color-primary); }
.event-list-item.type-info .event-icon { color: var(--color-success); }

.my-posts-container {
    max-height: 70vh; 
}
.my-post-item .post-content-preview {
    flex-grow: 1;
}
.my-post-meta {
    padding: 12px 20px;
    background-color: var(--color-surface-alt);
    border-top: 1px solid var(--color-border);
    display: flex;
    flex-wrap: wrap; 
    justify-content: space-between;
    align-items: center;
    gap: 10px;
    border-radius: 0 0 7px 7px;
}
.dark-mode .my-post-meta {
    background-color: var(--color-surface);
}
.my-post-meta .post-status {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.85rem;
    color: var(--color-text-muted);
    flex-wrap: wrap; 
}
.my-post-meta .post-actions {
    display: flex;
    gap: 10px;
}
.my-post-meta .btn-small { 
    margin-bottom: 0;
    width: auto; 
    padding: 6px 12px;
    flex-grow: 0; 
}

@media (max-width: 992px) {
    .my-post-meta {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
    }
    .my-post-meta .post-status {
        align-items: flex-start;
        flex-direction: column;
        gap: 8px;
    }
    .my-post-meta .post-actions {
        width: 100%;
        display: grid;
        grid-template-columns: 1fr 1fr;
    }
    .my-post-meta .post-actions .btn-small {
        width: 100%; 
    }
}
@media (max-width: 500px) {
    .my-post-meta {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
    }
    .my-post-meta .post-status {
        align-items: flex-start;
        flex-direction: column;
        gap: 8px;
    }
    .my-post-meta .post-actions {
        width: 100%;
        display: grid;
        grid-template-columns: 1fr 1fr;
    }
    .my-post-meta .post-actions .btn-small {
        width: 100%; 
    }
}

.modal-box.small-modal {
    max-width: 450px; 
    overflow-y: auto;
}
.plan-detail-content {
    display: flex;
    flex-direction: column;
    gap: 12px;
}
.detail-row {
    display: flex;
    font-size: 1rem;
    padding-bottom: 10px;
    border-bottom: 1px dashed var(--color-border);
}
.detail-row:last-child {
    border-bottom: none;
    padding-bottom: 0;
}
.detail-label {
    font-weight: 600;
    color: var(--color-text-muted);
    width: 100px; 
    flex-shrink: 0;
}
.detail-value {
    color: var(--color-text);
    font-weight: 500;
    word-break: break-word;
}
.detail-value.status-vertretung,
.detail-value.status-sonderevent {
    color: var(--color-danger);
    font-weight: 700;
}
.detail-value.status-raum√§nderung {
    color: var(--color-warning);
    font-weight: 700;
}
.detail-value.status-entfall {
    color: var(--color-text-muted);
    font-weight: 700;
    text-decoration: line-through;
}
.detail-row.detail-comment .detail-value {
    font-style: italic;
    color: var(--color-secondary);
}
.dark-mode .detail-row.detail-comment .detail-value {
    color: var(--color-primary);
}

.detail-row.detail-notes {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    border-bottom: none;
    padding-bottom: 0;
}
#detail-notes-input {
    margin-top: 5px;
    min-height: 80px; 
}
#note-save-spinner {
    display: none; 
    margin-top: 8px;
    margin-left: auto; 
}

#my-post-edit-modal .modal-box {
    max-width: 600px;
}
#my-post-edit-modal .modal-close-btn {
    position: absolute;
    top: 10px;
    right: 15px;
    background: none;
    border: none;
    font-size: 2rem;
    color: var(--color-text-muted);
    cursor: pointer;
    line-height: 1;
    padding: 5px;
}
#my-post-edit-modal .modal-close-btn:hover {
    color: var(--color-danger);
}
#my-post-edit-modal .modal-actions {
    justify-content: flex-end;
}
#my-post-edit-modal .btn-secondary {
    flex-grow: 0;
    width: auto;
    background-color: var(--color-surface-alt);
    color: var(--color-text-muted);
    border: 1px solid var(--color-border);
}
#my-post-edit-modal .btn-secondary:hover {
    background-color: #e9ecef;
}
.dark-mode #my-post-edit-modal .btn-secondary {
    background-color: var(--color-surface);
    border-color: var(--color-border);
}
.dark-mode #my-post-edit-modal .btn-secondary:hover {
    background-color: #343a40;
}
#my-post-edit-modal .btn-primary {
    flex-grow: 1;
}

@media (max-width: 768px) {
    .today-entry {
        grid-template-columns: 45px 1fr auto;
        gap: 8px 10px;
        padding: 10px;
    }
    .today-entry .time { font-size: 0.75rem; }
    .today-entry .details strong { font-size: 0.9rem; }
    .today-entry .details span { font-size: 0.8rem; }

    .student-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
    }
}

/* Styling f√ºr Sprechstunden-Buchung (Sch√ºler) */
#appointment-booking-widget .form-container {
    padding: 20px;
    margin: 0;
}
#teacher-search-input {
    position: relative;
}

.available-slots-container {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    padding: 10px;
    background-color: var(--color-background);
    border-radius: 6px;
    min-height: 40px;
    border: 1px solid var(--color-border);
}
.dark-mode .available-slots-container {
    background-color: var(--color-surface);
}
.available-slots-container .form-hint {
    margin: auto 0;
}

.available-slots-container strong {
    display: block;
    width: 100%;
    font-size: 0.9rem;
    font-weight: 700;
    color: var(--color-primary);
    margin-top: 10px;
    margin-bottom: 5px;
    padding-bottom: 5px;
    border-bottom: 1px solid var(--color-border);
}
.available-slots-container strong:first-child {
    margin-top: 0;
}

.btn-slot {
    font-family: var(--font-body);
    font-weight: 600;
    padding: 6px 10px;
    border-radius: 5px;
    border: 1px solid var(--color-border);
    background-color: var(--color-surface);
    color: var(--color-primary);
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    line-height: 1.4;
}
.dark-mode .btn-slot {
    background-color: var(--color-surface-alt);
    border-color: #444;
}
.btn-slot:hover {
    background-color: #f0f0ff;
    border-color: var(--color-primary);
}
.dark-mode .btn-slot:hover {
    background-color: #30363d;
}
.btn-slot.selected {
    background-color: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(57, 0, 153, 0.3);
}

.btn-slot strong {
    font-size: 0.9rem;
    font-weight: 700;
    color: inherit;
}
.btn-slot small {
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--color-text-muted);
}
.btn-slot.selected small {
    color: rgba(255, 255, 255, 0.8);
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\dashboard-cockpit.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\planer-layout.css ---
.planer-header {
    display: flex;
    flex-direction: column; 
    align-items: stretch;    
    gap: 20px;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid var(--color-border);
    padding-bottom: 1.5rem;
}
.planer-actions-wrapper {
    display: flex;
    flex-direction: column; 
    gap: 15px; 
    align-items: stretch; 
}
.planer-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 10px 15px;
    align-items: flex-end;
    justify-content: flex-start; 
}
.planer-controls .form-group {
    margin-bottom: 0;
    flex-basis: 150px;
    flex-grow: 1;
}
.planer-controls .form-group#class-selector-container,
.planer-controls .form-group#teacher-selector-container {
    flex-basis: 200px;
}
.planer-controls .form-group label {
    font-size: 0.85rem;
    margin-bottom: 3px;
}
.publish-controls {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 15px;
    background-color: var(--color-surface-alt);
    padding: 10px 15px;
    border-radius: 6px;
    border: 1px solid var(--color-border);
    box-sizing: border-box;
}
.dark-mode .publish-controls {
    background-color: var(--color-surface-alt);
}
.publish-status {
    font-weight: bold;
    color: var(--color-text-muted);
    font-size: 0.9rem;
    white-space: nowrap;
    flex-grow: 1; 
}
.publish-actions {
    display: flex;
    gap: 10px;
    flex-wrap: nowrap; 
    flex-shrink: 0; 
}
.bulk-actions-controls {
    display: flex;
    gap: 10px;
    padding: 10px 15px;
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 6px;
}
.dark-mode .bulk-actions-controls {
    background-color: var(--color-surface);
}
.copy-week-form {
    display: grid;
    grid-template-columns: 1fr auto 1fr 1fr;
    gap: 15px;
    align-items: flex-end;
    margin-bottom: 20px;
}
.copy-week-form .form-group {
    margin-bottom: 0;
}
.copy-week-form input[readonly] {
    background-color: var(--color-surface-alt);
    color: var(--color-text-muted);
    font-weight: bold;
}
.dark-mode .copy-week-form input[readonly] {
    background-color: var(--color-background);
}
.copy-week-form .arrow-separator {
    font-size: 2rem;
    font-weight: bold;
    color: var(--color-text-muted);
    padding-bottom: 5px; 
}
#copy-week-warning {
    display: block; 
    background-color: rgba(255, 189, 0, 0.1);
    border: 1px solid var(--color-warning);
    color: #664d03; 
    margin-top: 0;
    margin-bottom: 20px;
    padding: 10px 15px;
    border-radius: 6px;
}
.dark-mode #copy-week-warning {
    color: var(--color-warning);
}
#absence-management {
    display: flex;
    flex-direction: column;
    gap: 20px;
    padding: 25px 30px; 
}
.absence-container {
    display: grid;
    grid-template-columns: 1fr 350px; 
    gap: 25px;
    align-items: flex-start;
}
#absence-calendar-container {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    padding: 20px;
    border-radius: 8px;
}
#absence-form-container {
    background-color: var(--color-surface-alt);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid var(--color-border);
    position: sticky;
    top: 100px; 
}
.dark-mode #absence-form-container {
    background-color: var(--color-surface-alt);
}
#absence-form-container h3 {
    margin-top: 0;
    margin-bottom: 20px;
    font-size: 1.3rem;
    border-bottom: 1px solid var(--color-border);
    padding-bottom: 10px;
}
#absence-form .form-grid-col-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}
#absence-form .form-actions {
    margin-top: 20px;
    display: flex;
    justify-content: space-between;
    gap: 10px;
}
#absence-calendar {
    max-height: 70vh; 
}
.fc-event.absence-krank {
    background-color: var(--color-danger);
    border-color: var(--color-danger);
}
.fc-event.absence-fortbildung {
    background-color: var(--color-primary);
    border-color: var(--color-primary);
}
.fc-event.absence-beurlaubt {
    background-color: var(--color-warning);
    border-color: var(--color-warning);
    color: #333;
}
.fc-event.absence-sonstiges {
    background-color: var(--color-text-muted);
    border-color: var(--color-text-muted);
}
.fc-event.absence-selected {
    box-shadow: 0 0 0 3px var(--color-primary);
    outline: 2px solid var(--color-surface);
}
.dark-mode .fc-event.absence-selected {
    outline-color: var(--color-surface);
}
.fc-event-main {
    cursor: pointer;
}
#absence-form.absence-form-layout {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px 20px;
    align-items: flex-end; 
}
#absence-form.absence-form-layout .form-group {
    margin-bottom: 0; 
}
@media (min-width: 993px) {
    #absence-form.absence-form-layout #absence-teacher-group,
    #absence-form.absence-form-layout #absence-comment-group {
        grid-column: span 2;
    }
    @media (min-width: 1200px) {
        #absence-form.absence-form-layout #absence-teacher-group {
            grid-column: span 3;
        }
        #absence-form.absence-form-layout #absence-comment-group {
            grid-column: span 2;
        }
    }
}
#absence-form.absence-form-layout #absence-actions-group {
  grid-column: 1 / -1; 
  margin-top: 10px; 
  display: flex;
  justify-content: flex-start; 
  gap: 10px;
  align-items: center; 
}
@media (max-width: 1200px) {
    .planer-header { flex-direction: column; align-items: stretch; }
    .planer-actions-wrapper { min-width: 100%; }
    .planer-controls { justify-content: flex-start; }
    .publish-controls { justify-content: flex-start; }
    .publish-status { flex-grow: 0; width: 100%; margin-bottom: 10px; }
    .bulk-actions-controls { flex-wrap: wrap; justify-content: flex-start; }
}
@media (max-width: 992px) {
    .absence-container {
        grid-template-columns: 1fr; 
    }
    #absence-form-container {
        position: static; 
        top: auto;
    }
    #absence-calendar {
        max-height: 60vh; 
    }
    #absence-form.absence-form-layout {
        grid-template-columns: 1fr; 
    }
    #absence-form.absence-form-layout #absence-teacher-group,
    #absence-form.absence-form-layout #absence-comment-group {
        grid-column: 1 / -1; 
    }
} 
@media (max-width: 768px) {
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\css\8-pages\planer-layout.css ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-announcements.js ---
import { apiFetch } from './api-client.js';
import { showToast, showConfirm } from './notifications.js'; 
function escapeHtml(unsafe) {
¬† ¬† if (unsafe === null || typeof unsafe === 'undefined') return '';
¬† 	 return String(unsafe)
¬† ¬† ¬† ¬† ¬† .replace(/&/g, "&amp;")
¬† ¬† ¬† ¬† ¬† .replace(/</g, "&lt;")
¬† ¬† ¬† ¬† ¬† .replace(/>/g, "&gt;")
¬† ¬† ¬† ¬† ¬† .replace(/"/g, "&quot;")
¬† ¬† ¬† ¬† ¬† .replace(/'/g, "&#039;");
}
export function initializeAdminAnnouncements() {
¬† ¬† const managementContainer = document.getElementById('announcements-management');
¬† ¬† if (!managementContainer) return;
¬† ¬† const tableBody = managementContainer.querySelector('#announcements-table tbody');
¬† ¬† const form = managementContainer.querySelector('#announcement-form');
¬† ¬† const formTitle = managementContainer.querySelector('#announcement-form-title');
¬† ¬† const announcementIdInput = managementContainer.querySelector('#announcement_id');
¬† ¬† const targetClassSelect = managementContainer.querySelector('#target_class_id');
¬† ¬† const targetCheckboxes = managementContainer.querySelectorAll('.checkbox-group input[type="checkbox"]');
¬† ¬† const targetGlobalCheckbox = managementContainer.querySelector('#target_global');
¬† ¬† const targetTeacherCheckbox = managementContainer.querySelector('#target_teacher');
¬† ¬† const targetPlanerCheckbox = managementContainer.querySelector('#target_planer');
¬† ¬† const targetErrorHint = managementContainer.querySelector('#target-error');
¬† ¬† const cancelBtn = managementContainer.querySelector('#cancel-edit-announcement');
¬† ¬† const attachmentInput = managementContainer.querySelector('#attachment');
¬† ¬† const currentAttachmentInfo = managementContainer.querySelector('#current-attachment-info');
¬† ¬† const currentAttachmentLink = managementContainer.querySelector('#current-attachment-link');
¬† ¬† const removeAttachmentCheckbox = managementContainer.querySelector('#remove_attachment');
¬† ¬† const csrfTokenInput = managementContainer.querySelector('input[name="_csrf_token"]'); 
¬† ¬† const userRole = window.APP_CONFIG.userRole;
¬† ¬† const resetForm = () => {
¬† ¬† ¬† ¬† form.dataset.mode = 'create';
¬† ¬† ¬† ¬† form.reset();
¬† ¬† ¬† ¬† announcementIdInput.value = '';
¬† ¬† ¬† ¬† formTitle.textContent = 'Neue Ank√ºndigung erstellen';
¬† ¬† ¬† ¬† cancelBtn.style.display = 'none';
¬† ¬† ¬† ¬† if (targetClassSelect) targetClassSelect.disabled = false;
¬† ¬† ¬† ¬† if (targetCheckboxes) targetCheckboxes.forEach(cb => { cb.checked = false; cb.disabled = false; });
¬† ¬† ¬† ¬† if (targetErrorHint) targetErrorHint.style.display = 'none';
¬† ¬† ¬† ¬† if (userRole === 'lehrer' && targetClassSelect) {
¬† ¬† ¬† ¬† ¬† ¬† ¬†targetClassSelect.required = true;
¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† if (currentAttachmentInfo) currentAttachmentInfo.style.display = 'none';
¬† ¬† ¬† ¬† if (currentAttachmentLink) {
¬† ¬† ¬† ¬† ¬† ¬† currentAttachmentLink.href = '#';
¬† ¬† ¬† ¬† ¬† ¬† currentAttachmentLink.textContent = '';
¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† if (removeAttachmentCheckbox) removeAttachmentCheckbox.checked = false;
¬† ¬† ¬† ¬† if (attachmentInput) attachmentInput.value = ''; 
¬† ¬† };
¬† ¬† const handleTargetSelectionChange = (event) => {
¬† ¬† ¬† ¬† if (!targetClassSelect || !targetCheckboxes.length) return; 
¬† ¬† ¬† ¬† const isCheckboxEvent = event && event.target.type === 'checkbox';
¬† ¬† ¬† ¬† const isSelectEvent = event && event.target === targetClassSelect;
¬† ¬† ¬† ¬† let checkedCount = 0;
¬† ¬† ¬† ¬† targetCheckboxes.forEach(cb => { if (cb.checked) checkedCount++; });
¬† ¬† ¬† ¬† if (isCheckboxEvent) {
¬† ¬† ¬† ¬† ¬† ¬† ¬†if (event.target.checked) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetCheckboxes.forEach(cb => {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†if (cb !== event.target) cb.checked = false;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†});
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetClassSelect.value = ''; 
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetClassSelect.disabled = true;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†checkedCount = 1; 
¬† ¬† ¬† ¬† ¬† ¬† ¬†} else {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†if (checkedCount === 0) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetClassSelect.disabled = false;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†}
¬† ¬† ¬† ¬† ¬† ¬† ¬†}
¬† ¬† ¬† ¬† } else if (isSelectEvent) {
¬† ¬† ¬† ¬† ¬† ¬† ¬†if (targetClassSelect.value !== '') {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetCheckboxes.forEach(cb => {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†cb.checked = false;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†cb.disabled = true; 
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†});
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†checkedCount = 0;
¬† ¬† ¬† ¬† ¬† ¬† ¬†} else {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetCheckboxes.forEach(cb => cb.disabled = false);
¬† ¬† ¬† ¬† ¬† ¬† ¬†}
¬† ¬† ¬† ¬† } else {
¬† ¬† ¬† ¬† ¬† ¬† ¬†if (checkedCount > 0) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetClassSelect.value = '';
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetClassSelect.disabled = true;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†if (checkedCount > 1) { 
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetCheckboxes[0].checked = true;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†for(let i=1; i<targetCheckboxes.length; i++) targetCheckboxes[i].checked = false;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†}
¬† ¬† ¬† ¬† ¬† ¬† ¬†} else if (targetClassSelect.value !== '') {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetCheckboxes.forEach(cb => { cb.checked = false; cb.disabled = true; });
¬† ¬† ¬† ¬† ¬† ¬† ¬†} else {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetClassSelect.disabled = false;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†targetCheckboxes.forEach(cb => cb.disabled = false);
¬† ¬† ¬† ¬† ¬† ¬† ¬†}
¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† if (targetErrorHint) {
¬† ¬† ¬† ¬† ¬† ¬† targetErrorHint.style.display = (targetClassSelect.value === '' && checkedCount === 0) ? 'block' : 'none';
¬† ¬† ¬† ¬† }
¬† ¬† };
¬† ¬† if (targetClassSelect && targetCheckboxes.length) {
¬† ¬† ¬† ¬† targetClassSelect.addEventListener('change', handleTargetSelectionChange);
¬† ¬† ¬† ¬† targetCheckboxes.forEach(cb => cb.addEventListener('change', handleTargetSelectionChange));
¬† ¬† ¬† ¬† handleTargetSelectionChange(); 
¬† ¬† }
¬† ¬† const renderTable = (announcements) => {
¬† ¬† ¬† ¬† ¬†console.log("Rendering table (client-side update - currently basic)");
¬† ¬† };
¬† ¬† form.addEventListener('submit', async (e) => {
¬† ¬† ¬† ¬† e.preventDefault();
¬† ¬† ¬† ¬† const mode = form.dataset.mode;
¬† ¬† ¬† ¬† const formData = new FormData(form);
¬† ¬† ¬† ¬† if (userRole === 'admin' || userRole === 'planer') {
¬† ¬† ¬† ¬† ¬† ¬† const classSelected = formData.get('target_class_id') && formData.get('target_class_id') !== '';
¬† ¬† ¬† ¬† ¬† ¬† const globalChecked = formData.get('target_global') === '1';
¬† ¬† ¬† ¬† ¬† ¬† const teacherChecked = formData.get('target_teacher') === '1';
¬† ¬† ¬† ¬† ¬† ¬† const planerChecked = formData.get('target_planer') === '1';
¬† ¬† ¬† ¬† ¬† ¬† const checkedCount = [globalChecked, teacherChecked, planerChecked].filter(Boolean).length;
¬† ¬† ¬† ¬† ¬† ¬† if (!classSelected && checkedCount !== 1) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† if (targetErrorHint) targetErrorHint.style.display = 'block';
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† showToast('Bitte eine Klasse ODER genau eine Zielgruppe (Global, Lehrer, Planer) ausw√§hlen.', 'error');
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† return; 
¬† ¬† ¬† ¬† ¬† ¬† } else {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†if (targetErrorHint) targetErrorHint.style.display = 'none';
¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† ¬†if (!globalChecked) formData.delete('target_global');
¬† ¬† ¬† ¬† ¬† ¬† ¬†if (!teacherChecked) formData.delete('target_teacher');
¬† ¬† ¬† ¬† ¬† ¬† ¬†if (!planerChecked) formData.delete('target_planer');
¬† ¬† ¬† ¬† ¬† ¬† ¬†if (checkedCount > 0) formData.delete('target_class_id'); 
¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† const url = mode === 'create'
¬† ¬† ¬† ¬† ¬† ¬† ? `${window.APP_CONFIG.baseUrl}/api/announcements/create`
¬† ¬† ¬† ¬† ¬† ¬† : `${window.APP_CONFIG.baseUrl}/api/announcements/update`; 
¬† ¬† ¬† ¬† ¬†if (!formData.has('_csrf_token') && csrfTokenInput) {
¬† ¬† ¬† ¬† ¬† ¬† ¬†formData.append('_csrf_token', csrfTokenInput.value);
¬† ¬† ¬† ¬† ¬†}
¬† ¬† ¬† ¬† try {
¬† ¬† ¬† ¬† ¬† ¬† const response = await apiFetch(url, { method: 'POST', body: formData });
¬† ¬† ¬† ¬† ¬† ¬† if(response.success) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† showToast(response.message, 'success');
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† resetForm();
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† window.location.reload();
¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† } catch(error) {
¬† ¬† ¬† ¬† ¬† ¬† ¬†console.error("Form submission error:", error);
¬† ¬† ¬† ¬† }
¬† ¬† });
¬† ¬† tableBody.addEventListener('click', async (e) => {
¬† ¬† ¬† ¬† const target = e.target;
¬† ¬† ¬† ¬† const row = target.closest('tr');
¬† ¬† ¬† ¬† if (!row) return;
¬† ¬† ¬† ¬† const id = row.dataset.id;
¬† ¬† ¬† ¬† const announcementData = {
¬† ¬† ¬† ¬† ¬† ¬† announcement_id: id,
¬† ¬† ¬† ¬† ¬† ¬† title: row.dataset.title,
¬† ¬† ¬† ¬† ¬† ¬† content: row.dataset.content,
¬† ¬† ¬† ¬† ¬† ¬† is_global: row.dataset.isGlobal === '1',
¬† ¬† ¬† ¬† ¬† ¬† class_id: row.dataset.classId || null,
¬† ¬† ¬† ¬† ¬† ¬† file_path: row.dataset.filePath || null,
¬† ¬† ¬† ¬† ¬† ¬† user_id: row.dataset.userId
¬† ¬† ¬† ¬† };
¬† ¬† ¬† ¬† if (target.classList.contains('edit-announcement')) {
¬† ¬† ¬† ¬† ¬† ¬† ¬†showToast('Bearbeiten ist derzeit nicht implementiert.', 'info');
¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† if (target.classList.contains('delete-announcement')) {
¬† ¬† ¬† ¬† ¬† ¬† const canModify = in_array(userRole, ['admin', 'planer']) || (userRole === 'lehrer' && announcementData.user_id == window.APP_CONFIG.userId); 
Dienstag
¬† ¬† ¬† ¬† ¬† ¬† ¬†if (!canModify) return;
¬† ¬† ¬† ¬† ¬† ¬† if (await showConfirm('Ank√ºndigung l√∂schen', `Sind Sie sicher, dass Sie "${escapeHtml(announcementData.title)}" l√∂schen m√∂chten? Zugeh√∂rige Dateien werden ebenfalls entfernt.`)) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† const deleteFormData = new FormData();
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† deleteFormData.append('announcement_id', id);
Dienstag
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†if (!deleteFormData.has('_csrf_token') && csrfTokenInput) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†deleteFormData.append('_csrf_token', csrfTokenInput.value);
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†}
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† try {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/announcements/delete`, { method: 'POST', body: deleteFormData });
Dienstag
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† if(response.success) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† showToast(response.message, 'success');
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† row.remove(); 
¬† ¬† ¬† ¬† ¬† tuesday
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† if (tableBody.rows.length === 0) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†window.location.reload(); 
A
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
d
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† } catch(error) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†console.error("Delete error:", error);
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† }
¬† ¬† });
¬† ¬† cancelBtn.addEventListener('click', resetForm);
¬† ¬† handleTargetSelectionChange();
}
function in_array(needle, haystack) {
¬† ¬† return haystack.indexOf(needle) > -1;
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-announcements.js ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-audit-log.js ---
import { apiFetch } from './api-client.js';
import { showToast } from './notifications.js';
function escapeHtml(unsafe) {
    if (unsafe === null || typeof unsafe === 'undefined') return '';
    return String(unsafe)
         .replace(/&/g, "&amp;")
         .replace(/</g, "&lt;")
         .replace(/>/g, "&gt;")
         .replace(/"/g, "&quot;")
         .replace(/'/g, "&#039;");
}
function formatDateTime(dateInput) {
    if (!dateInput) return 'N/A'; 
    try {
        let dateString = String(dateInput);
        dateString = dateString.replace(' ', 'T');
        const date = new Date(dateString);
        if (isNaN(date.getTime())) {
            console.warn("formatDateTime: Ung√ºltiges Datum nach Konvertierung:", dateString, "Original:", dateInput);
            return 'Ung√ºltig';
        }
        return date.toLocaleString('de-DE', {
            year: 'numeric', month: '2-digit', day: '2-digit',
            hour: '2-digit', minute: '2-digit', second: '2-digit'
        });
    } catch (e) {
        console.error("formatDateTime Fehler:", e, "Input:", dateInput);
        return 'Fehler'; 
    }
}
export function initializeAdminAuditLogs() {
    const managementContainer = document.getElementById('audit-log-management');
    if (!managementContainer) return;
    const filterForm = document.getElementById('audit-filter-form');
    const tableBody = document.getElementById('audit-logs-tbody');
    const paginationContainer = document.getElementById('pagination-controls');
    const paginationSummary = document.getElementById('pagination-summary');
    let currentFilters = {};
    let currentPage = 1;
    const createLogRowHtml = (log) => {
        const userName = log.user_id
            ? `${escapeHtml(log.last_name)}, ${escapeHtml(log.first_name)} (${escapeHtml(log.username)})`
            : '<em style="color: var(--color-text-muted);">System/Gast</em>';
        let detailsHtml = '';
        if (log.details) {
            try {
                const detailsObj = JSON.parse(log.details);
                detailsHtml = `
                    <details class="log-details">
                        <summary>Details anzeigen</summary>
                        <pre>${escapeHtml(JSON.stringify(detailsObj, null, 2))}</pre>
                    </details>
                `;
            } catch (e) {
                detailsHtml = escapeHtml(log.details); 
            }
        }
        return `
            <tr data-log-id="${log.log_id}">
                <td data-label="Zeitstempel">${formatDateTime(log.timestamp)}</td> <td data-label="Benutzer">${userName}</td>
                <td data-label="Aktion">${escapeHtml(log.action)}</td>
                <td data-label="Ziel-Typ">${escapeHtml(log.target_type)}</td>
                <td data-label="Ziel-ID">${escapeHtml(log.target_id)}</td>
                <td data-label="Details" class="log-details-cell">${detailsHtml}</td>
                <td data-label="IP-Adresse">${escapeHtml(log.ip_address)}</td>
            </tr>
        `;
    };
    const renderPagination = (currentPage, totalPages) => {
        paginationContainer.innerHTML = '';
        if (totalPages <= 1) return;
        const prevBtn = document.createElement('button');
        prevBtn.className = 'btn btn-secondary btn-small pagination-btn';
        prevBtn.textContent = '¬´ Zur√ºck';
        prevBtn.disabled = currentPage <= 1;
        prevBtn.dataset.page = currentPage - 1;
        paginationContainer.appendChild(prevBtn);
        const pageInfo = document.createElement('span');
        pageInfo.className = 'pagination-info';
        pageInfo.textContent = `Seite ${currentPage} / ${totalPages}`;
        paginationContainer.appendChild(pageInfo);
        const nextBtn = document.createElement('button');
        nextBtn.className = 'btn btn-secondary btn-small pagination-btn';
        nextBtn.textContent = 'Weiter ¬ª';
        nextBtn.disabled = currentPage >= totalPages;
        nextBtn.dataset.page = currentPage + 1;
        paginationContainer.appendChild(nextBtn);
    };
    const loadLogs = async (page = 1, filters = {}) => {
        currentPage = page;
        currentFilters = filters;
        tableBody.innerHTML = `<tr><td colspan="7" style="text-align: center; padding: 40px;"><div class="loading-spinner"></div></td></tr>`;
        paginationContainer.innerHTML = '';
        paginationSummary.textContent = 'Lade Eintr√§ge...';
        const params = new URLSearchParams();
        params.append('page', page);
        for (const [key, value] of Object.entries(filters)) {
            if (value) { 
                params.append(key, value);
            }
        }
        try {
            const url = `${window.APP_CONFIG.baseUrl}/api/admin/audit-logs?${params.toString()}`;
            const response = await apiFetch(url); 
            if (response.success) {
                if (response.logs && response.logs.length > 0) {
                    tableBody.innerHTML = response.logs.map(createLogRowHtml).join('');
                } else {
                    tableBody.innerHTML = `<tr><td colspan="7" style="text-align: center; padding: 20px;">Keine Protokolleintr√§ge f√ºr diese Filter gefunden.</td></tr>`;
                }
                const { currentPage, totalPages, totalCount, limit } = response.pagination;
                renderPagination(currentPage, totalPages);
                const startEntry = (currentPage - 1) * limit + 1;
                const endEntry = Math.min(currentPage * limit, totalCount);
                paginationSummary.textContent = totalCount > 0
                    ? `Zeige Eintr√§ge ${startEntry} - ${endEntry} von ${totalCount}`
                    : 'Keine Eintr√§ge gefunden';
            } else {
                throw new Error(response.message || 'Unbekannter Fehler');
            }
        } catch (error) {
            console.error("Fehler beim Laden der Audit-Logs:", error);
            showToast(error.message, 'error');
            tableBody.innerHTML = `<tr><td colspan="7" class="message error">Fehler: ${error.message}</td></tr>`;
            paginationSummary.textContent = 'Fehler beim Laden';
        }
    };
    filterForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const formData = new FormData(filterForm);
        const filters = Object.fromEntries(formData.entries());
        loadLogs(1, filters); 
    });
    filterForm.addEventListener('reset', (e) => {
        setTimeout(() => {
            loadLogs(1, {}); 
        }, 0);
    });
    paginationContainer.addEventListener('click', (e) => {
        const target = e.target.closest('.pagination-btn');
        if (target && !target.disabled) {
            const page = parseInt(target.dataset.page, 10);
            if (page) {
                loadLogs(page, currentFilters);
            }
        }
    });
    loadLogs(1, {});
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-audit-log.js ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-community.js ---
import { apiFetch } from './api-client.js';
import { showToast, showConfirm } from './notifications.js';
export function initializeAdminCommunity() {
    const container = document.getElementById('community-moderation');
    if (!container) return;
    const tabContainer = container.querySelector('.tab-navigation');
    const contentContainer = container.querySelector('.tab-content');
    if (tabContainer && contentContainer) {
        const tabButtons = tabContainer.querySelectorAll('.tab-button');
        const tabContents = contentContainer.querySelectorAll('.dashboard-section');
        const handleTabClick = (button) => {
            const targetId = button.dataset.target;
            if (!targetId) return;
            tabButtons.forEach(btn => btn.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));
            button.classList.add('active');
            const targetContent = document.getElementById(targetId);
            if (targetContent) {
                targetContent.classList.add('active');
            }
        };
        tabButtons.forEach(button => {
            button.addEventListener('click', () => handleTabClick(button));
        });
    }
    container.addEventListener('click', handleModerationClick);
}
async function handleModerationClick(e) {
    const approveBtn = e.target.closest('.approve-post-btn');
    const rejectBtn = e.target.closest('.reject-post-btn');
    const deleteBtn = e.target.closest('.delete-approved-btn'); 
    const button = approveBtn || rejectBtn || deleteBtn;
    if (!button) return;
    e.preventDefault();
    const postItem = button.closest('.moderation-item');
    const postId = postItem?.dataset.id;
    const postTitle = postItem?.querySelector('.post-title')?.textContent || 'dieser Beitrag';
    if (!postId) {
        showToast('Konnte Beitrags-ID nicht finden.', 'error');
        return;
    }
    let actionText, url, confirmTitle, confirmMessage, logAction;
    if (approveBtn) {
        actionText = 'Freigeben';
        url = `${window.APP_CONFIG.baseUrl}/api/admin/community/approve`;
        logAction = 'approve';
        confirmTitle = 'Beitrag freigeben';
        confirmMessage = `M√∂chten Sie "${postTitle}" wirklich freigeben?`;
    } else if (rejectBtn) {
        actionText = 'Ablehnen & L√∂schen';
        url = `${window.APP_CONFIG.baseUrl}/api/admin/community/reject`;
        logAction = 'reject';
        confirmTitle = 'Beitrag ablehnen';
        confirmMessage = `M√∂chten Sie "${postTitle}" wirklich ablehnen und l√∂schen?`;
    } else if (deleteBtn) { 
        actionText = 'Endg√ºltig L√∂schen';
        url = `${window.APP_CONFIG.baseUrl}/api/admin/community/delete-approved`;
        logAction = 'delete';
        confirmTitle = 'Beitrag l√∂schen';
        confirmMessage = `M√∂chten Sie den freigegebenen Beitrag "${postTitle}" wirklich endg√ºltig l√∂schen?`;
    }
    if (await showConfirm(confirmTitle, confirmMessage)) {
        button.disabled = true;
        const spinner = document.createElement('span');
        spinner.className = 'loading-spinner small';
        button.insertAdjacentElement('afterend', spinner);
        try {
            const response = await apiFetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ post_id: postId })
            });
            if (response.success) {
                showToast(response.message, 'success');
                postItem.style.transition = 'opacity 0.3s ease, height 0.3s ease, margin 0.3s ease, padding 0.3s ease';
                postItem.style.opacity = '0';
                postItem.style.height = '0px';
                postItem.style.paddingTop = '0';
                postItem.style.paddingBottom = '0';
                postItem.style.margin = '0';
                setTimeout(() => {
                    const listContainer = postItem.parentElement;
                    postItem.remove();
                    if (listContainer && listContainer.childElementCount === 0) {
                        const messageType = (logAction === 'approve' || logAction === 'reject') ? 'ausstehende' : 'freigegebene';
                        listContainer.innerHTML = `<p class="message info">Aktuell gibt es keine ${messageType} Beitr√§ge.</p>`;
                    }
                }, 300);
            }
        } catch (error) {
            console.error(`Fehler bei Aktion '${logAction}':`, error);
            button.disabled = false;
        } finally {
            spinner.remove();
        }
    }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-community.js ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-settings.js ---
import { apiFetch } from './api-client.js';
import { showToast } from './notifications.js';
export function initializeAdminSettings() {
    const settingsForm = document.getElementById('settings-form');
    if (!settingsForm) return;
    const saveButton = document.getElementById('save-settings-btn');
    const statusSpinner = document.getElementById('save-settings-spinner');
    const maintenanceToggle = document.getElementById('maintenance_mode');
    const maintenanceStatus = document.getElementById('maintenance-status');
    const icalToggle = document.getElementById('ical_enabled');
    const icalStatus = document.getElementById('ical-status');
    const communityToggle = document.getElementById('community_board_enabled');
    const communityStatus = document.getElementById('community-board-status');
    const logoInput = document.getElementById('site_logo');
    const logoPreviewContainer = document.getElementById('logo-preview-container');
    const logoRemoveCheckbox = document.querySelector('input[name="remove_site_logo"]');
    const faviconInput = document.getElementById('site_favicon');
    const faviconPreviewContainer = document.getElementById('favicon-preview-container');
    const faviconRemoveCheckbox = document.querySelector('input[name="remove_site_favicon"]');
    const clearCacheBtn = document.getElementById('clear-cache-btn');
    const cacheStatusText = document.getElementById('cache-clear-status');
    const cacheCsrfTokenInput = document.getElementById('cache_csrf_token');
    const setupToggle = (toggleElement, statusElement, activeText = 'Aktiviert', inactiveText = 'Deaktiviert') => {
        if (!toggleElement || !statusElement) return;
        const updateStatus = () => {
             if (toggleElement.checked) {
                statusElement.textContent = activeText;
                statusElement.style.color = 'var(--color-success)';
            } else {
                statusElement.textContent = inactiveText;
                statusElement.style.color = 'var(--color-text-muted)';
            }
        };
        toggleElement.addEventListener('change', updateStatus);
        updateStatus(); 
    };
    setupToggle(maintenanceToggle, maintenanceStatus, 'Aktiviert', 'Deaktiviert');
    setupToggle(icalToggle, icalStatus, 'Aktiviert', 'Deaktiviert');
    setupToggle(communityToggle, communityStatus, 'Aktiviert', 'Deaktiviert'); 
    const updatePreview = (input, container, removeCheckbox, isLogo = true) => {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                container.innerHTML = `
                    <img src="${e.target.result}" alt="Vorschau" class="${isLogo ? 'logo-preview' : 'favicon-preview'}">
                    <label class="remove-file-label" style="display: block;">
                        <input type="checkbox" name="${removeCheckbox.name}" value="1"> Entfernen
                    </label>
                `;
                const newRemoveCheckbox = container.querySelector(`input[name="${removeCheckbox.name}"]`);
                if (newRemoveCheckbox) {
                     newRemoveCheckbox.addEventListener('change', () => handleRemoveCheck(newRemoveCheckbox, input, container, isLogo ? 'Logo' : 'Favicon'));
                }
            };
            reader.readAsDataURL(input.files[0]);
            if (removeCheckbox) removeCheckbox.checked = false; 
        }
    };
    const handleRemoveCheck = (checkbox, input, container, altText) => {
         if (checkbox.checked) {
            if (input) input.value = ''; 
            container.querySelector('img')?.remove(); 
            container.querySelector('.no-file')?.remove();
            const noFileSpan = document.createElement('span');
            noFileSpan.className = 'no-file';
            noFileSpan.textContent = `${altText} wird entfernt.`;
            container.prepend(noFileSpan);
            if (checkbox.parentElement) checkbox.parentElement.style.display = 'none';
        }
    };
    if (logoInput) logoInput.addEventListener('change', () => updatePreview(logoInput, logoPreviewContainer, logoRemoveCheckbox, true));
    if (faviconInput) faviconInput.addEventListener('change', () => updatePreview(faviconInput, faviconPreviewContainer, faviconRemoveCheckbox, false));
    if (logoRemoveCheckbox) {
        logoRemoveCheckbox.addEventListener('change', () => handleRemoveCheck(logoRemoveCheckbox, logoInput, logoPreviewContainer, 'Logo'));
    }
     if (faviconRemoveCheckbox) {
        faviconRemoveCheckbox.addEventListener('change', () => handleRemoveCheck(faviconRemoveCheckbox, faviconInput, faviconPreviewContainer, 'Favicon'));
    }
    if (clearCacheBtn && cacheStatusText && cacheCsrfTokenInput) {
        clearCacheBtn.addEventListener('click', async () => {
            if (confirm('Sind Sie sicher, dass Sie den gesamten Anwendungs-Cache leeren m√∂chten?')) {
                clearCacheBtn.disabled = true;
                clearCacheBtn.textContent = 'Leere...';
                cacheStatusText.textContent = '';
                cacheStatusText.classList.remove('text-success', 'text-danger');
                const formData = new FormData();
                formData.append('csrf_token', cacheCsrfTokenInput.value);
                try {
                    const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/cache/clear`, {
                        method: 'POST',
                        body: formData
                    });
                    if (response.success) {
                        showToast(response.message || 'Cache erfolgreich geleert.', 'success');
                        cacheStatusText.textContent = response.message;
                        cacheStatusText.classList.add('text-success');
                    } else {
                        throw new Error(response.message || 'Ein unbekannter Fehler ist aufgetreten.');
                    }
                } catch (error) {
                    console.error('Fehler beim Leeren des Caches:', error);
                    const errorMessage = error.message || 'Fehler beim Leeren des Caches.';
                    showToast(errorMessage, 'error');
                    cacheStatusText.textContent = `Fehler: ${errorMessage}`;
                    cacheStatusText.classList.add('text-danger');
                } finally {
                    clearCacheBtn.disabled = false;
                    clearCacheBtn.textContent = 'Cache jetzt leeren';
                }
            }
        });
    }
    settingsForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        if (saveButton) saveButton.disabled = true;
        if (statusSpinner) statusSpinner.style.display = 'inline-block';
        const formData = new FormData(settingsForm);
        try {
            const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/settings/save`, {
                method: 'POST',
                body: formData 
            });
            if (response.success) {
                showToast('Einstellungen erfolgreich gespeichert.', 'success');
                const cacheBuster = `?v=${new Date().getTime()}`;
                const newTitle = formData.get('site_title');
                const logoContainer = document.querySelector('.site-logo');
                if (logoContainer) {
                    if (response.data.site_logo_path) {
                        logoContainer.innerHTML = `<img src="${window.APP_CONFIG.baseUrl}/${response.data.site_logo_path}${cacheBuster}" alt="${escapeHtml(newTitle)} Logo" class="site-logo-image" id="header-logo-img">`;
                    } else {
                        logoContainer.innerHTML = `<span id="header-logo-text">${escapeHtml(newTitle)}</span>`;
                    }
                }
                document.title = escapeHtml(newTitle);
                let faviconElement = document.querySelector('link[rel="icon"]');
                if (response.data.site_favicon_path) {
                    const newFaviconUrl = `${window.APP_CONFIG.baseUrl}/${response.data.site_favicon_path}${cacheBuster}`;
                    if (faviconElement) {
                        faviconElement.href = newFaviconUrl;
                    } else {
                        const newLink = document.createElement('link');
                        newLink.rel = 'icon';
                        newLink.href = newFaviconUrl;
                        document.head.appendChild(newLink);
                    }
                } else if (!response.data.site_favicon_path && faviconElement) {
                    faviconElement.remove();
                }
                updatePreviewContainer(logoPreviewContainer, response.data.site_logo_path, 'remove_site_logo', 'Logo', true);
                updatePreviewContainer(faviconPreviewContainer, response.data.site_favicon_path, 'remove_site_favicon', 'Favicon', false);
                if (logoInput) logoInput.value = '';
                if (faviconInput) faviconInput.value = '';
                 window.APP_CONFIG.settings.site_title = newTitle;
                 window.APP_CONFIG.settings.site_logo_path = response.data.site_logo_path;
                 window.APP_CONFIG.settings.site_favicon_path = response.data.site_favicon_path;
                 window.APP_CONFIG.settings.default_theme = response.data.default_theme;
                 window.APP_CONFIG.settings.ical_enabled = formData.get('ical_enabled') === '1';
                 window.APP_CONFIG.settings.ical_weeks_future = parseInt(formData.get('ical_weeks_future'), 10);
                 window.APP_CONFIG.settings.maintenance_whitelist_ips = formData.get('maintenance_whitelist_ips'); 
                 window.APP_CONFIG.settings.community_board_enabled = formData.get('community_board_enabled') === '1'; 
            }
        } catch (error) {
            console.error('Fehler beim Speichern der Einstellungen:', error);
        } finally {
            if (saveButton) saveButton.disabled = false;
            if (statusSpinner) statusSpinner.style.display = 'none';
        }
    });
    function updatePreviewContainer(container, newPath, checkboxName, altText, isLogo) {
        if (!container) return;
        const cacheBuster = `?v=${new Date().getTime()}`;
        if (newPath) {
             container.innerHTML = `
                <img src="${window.APP_CONFIG.baseUrl}/${newPath}${cacheBuster}" alt="${altText} Vorschau" class="${isLogo ? 'logo-preview' : 'favicon-preview'}">
                <label class="remove-file-label">
                    <input type="checkbox" name="${checkboxName}" value="1"> ${altText} entfernen
                </label>
            `;
             const newCheckbox = container.querySelector(`input[name="${checkboxName}"]`);
             if (newCheckbox) {
                 const inputEl = document.getElementById(isLogo ? 'site_logo' : 'site_favicon');
                 newCheckbox.addEventListener('change', () => handleRemoveCheck(newCheckbox, inputEl, container, altText));
             }
        } else {
             container.innerHTML = `<span class="no-file">Kein ${altText} festgelegt.</span>`;
        }
    }
    function escapeHtml(unsafe) {
         if (!unsafe) return '';
         return String(unsafe)
              .replace(/&/g, "&amp;")
              .replace(/</g, "&lt;")
              .replace(/>/g, "&gt;")
              .replace(/"/g, "&quot;")
              .replace(/'/g, "&#039;");
    }
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-settings.js ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-stammdaten.js ---
/* public/assets/js/admin-stammdaten.js */
import { apiFetch } from './api-client.js';
import { showToast, showConfirm } from './notifications.js';
import { escapeHtml } from './planer-utils.js';

function initializeTabbedInterface() {
    const stammdatenManagement = document.getElementById('stammdaten-management');
    if (!stammdatenManagement) return;

    const tabButtons = stammdatenManagement.querySelectorAll('.tab-button');
    const tabContents = stammdatenManagement.querySelectorAll('.dashboard-section');

    const initializers = {
        'subjects-section': initializeSubjectManagement,
        'rooms-section': initializeRoomManagement,
        'teachers-section': initializeTeacherManagement,
        'classes-section': initializeClassManagement,
    };

    const handleTabClick = (button) => {
        tabButtons.forEach(btn => btn.classList.remove('active'));
        tabContents.forEach(content => content.classList.remove('active'));
        button.classList.add('active');
        const targetId = button.dataset.target;
        const targetContent = document.getElementById(targetId);

        if (targetContent) {
            targetContent.classList.add('active');
            if (!targetContent.dataset.initialized) {
                const initFunc = initializers[targetId];
                if (typeof initFunc === 'function') {
                    initFunc();
                    targetContent.dataset.initialized = 'true';
                }
            }
            const firstInput = targetContent.querySelector('form input[type="text"], form input[type="email"], form input[type="number"]');
            if (firstInput) {
                setTimeout(() => firstInput.focus(), 50);
            }
        }
    };

    tabButtons.forEach(button => {
        button.addEventListener('click', () => handleTabClick(button));
    });

    const initiallyActiveButton = stammdatenManagement.querySelector('.tab-button.active');
    if (initiallyActiveButton) {
        handleTabClick(initiallyActiveButton);
    }
}

function initializeSubjectManagement() {
    const section = document.getElementById('subjects-section');
    if (!section) return;
    const tableBody = section.querySelector('#subjects-table tbody');
    const form = section.querySelector('#subject-form');
    const formTitle = section.querySelector('#subject-form-container h4');
    const subjectIdInput = section.querySelector('#subject_id');
    const subjectNameInput = section.querySelector('#subject_name');
    const subjectShortcutInput = section.querySelector('#subject_shortcut');
    const cancelBtn = section.querySelector('#cancel-edit-subject');

    const resetForm = () => {
        form.dataset.mode = 'create';
        form.reset();
        subjectIdInput.value = '';
        formTitle.textContent = 'Neues Fach anlegen';
        cancelBtn.style.display = 'none';
    };

    const renderTable = (subjects) => {
        tableBody.innerHTML = subjects.length > 0 ? subjects.map(subject => {
            const id = escapeHtml(subject.subject_id);
            const name = escapeHtml(subject.subject_name);
            const shortcut = escapeHtml(subject.subject_shortcut);
            return `
            <tr data-id="${id}">
                <td data-label="ID">${id}</td>
                <td data-label="Fachname">${name}</td>
                <td data-label="K√ºrzel">${shortcut}</td>
                <td class="actions" data-label="Aktionen">
                    <button class="btn btn-warning btn-small edit-subject" data-name="${name}" data-shortcut="${shortcut}">Bearbeiten</button>
                    <button class="btn btn-danger btn-small delete-subject">L√∂schen</button>
                </td>
            </tr>
        `;
        }).join('') : '<tr><td colspan="4">Keine F√§cher gefunden.</td></tr>';
    };

    const loadSubjects = async () => {
        try {
            const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/subjects`);
            if (response.success) {
                renderTable(response.data);
            }
        } catch (error) {
            tableBody.innerHTML = '<tr><td colspan="4" class="message error">Fehler beim Laden der F√§cher.</td></tr>';
        }
    };

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const mode = form.dataset.mode;
        const formData = new FormData(form);
        const url = mode === 'create'
            ? `${window.APP_CONFIG.baseUrl}/api/admin/subjects/create`
            : `${window.APP_CONFIG.baseUrl}/api/admin/subjects/update`;
        try {
            const response = await apiFetch(url, { method: 'POST', body: formData });
            if(response.success) {
                showToast(response.message, 'success');
                resetForm();
                loadSubjects();
            }
        } catch(error) {}
    });

    tableBody.addEventListener('click', async (e) => {
        const target = e.target;
        const row = target.closest('tr');
        if (!row) return;
        const id = row.dataset.id;

        if (target.classList.contains('edit-subject')) {
            form.dataset.mode = 'update';
            subjectIdInput.value = id;
            subjectNameInput.value = target.dataset.name;
            subjectShortcutInput.value = target.dataset.shortcut;
            formTitle.textContent = 'Fach bearbeiten';
            cancelBtn.style.display = 'inline-block';
            subjectNameInput.focus();
        }

        if (target.classList.contains('delete-subject')) {
            if (await showConfirm('Fach l√∂schen', `Sind Sie sicher, dass Sie das Fach '${escapeHtml(target.closest('tr').cells[1].textContent)}' endg√ºltig l√∂schen m√∂chten?`)) {
                const formData = new FormData();
                formData.append('subject_id', id);
                try {
                    const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/subjects/delete`, { method: 'POST', body: formData });
                    if(response.success) {
                        showToast(response.message, 'success');
                        loadSubjects();
                    }
                } catch(error) {}
            }
        }
    });

    cancelBtn.addEventListener('click', resetForm);
    loadSubjects();
}

function initializeRoomManagement() {
    const section = document.getElementById('rooms-section');
    if (!section) return;
    const tableBody = section.querySelector('#rooms-table tbody');
    const form = section.querySelector('#room-form');
    const formTitle = section.querySelector('#room-form-container h4');
    const roomIdInput = section.querySelector('#room_id');
    const roomNameInput = section.querySelector('#room_name');
    const cancelBtn = section.querySelector('#cancel-edit-room');

    const resetForm = () => {
        form.dataset.mode = 'create';
        form.reset();
        roomIdInput.value = '';
        formTitle.textContent = 'Neuen Raum anlegen';
        cancelBtn.style.display = 'none';
    };

    const renderTable = (rooms) => {
        tableBody.innerHTML = rooms.length > 0 ? rooms.map(room => {
            const id = escapeHtml(room.room_id);
            const name = escapeHtml(room.room_name);
            return `
            <tr data-id="${id}">
                <td data-label="ID">${id}</td>
                <td data-label="Raumname">${name}</td>
                <td class="actions" data-label="Aktionen">
                    <button class="btn btn-warning btn-small edit-room" data-name="${name}">Bearbeiten</button>
                    <button class="btn btn-danger btn-small delete-room">L√∂schen</button>
                </td>
            </tr>
        `;
        }).join('') : '<tr><td colspan="3">Keine R√§ume gefunden.</td></tr>';
    };

    const loadRooms = async () => {
        try {
            const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/rooms`);
            if (response.success) {
                renderTable(response.data);
            }
        } catch (error) {
            tableBody.innerHTML = '<tr><td colspan="3" class="message error">Fehler beim Laden der R√§ume.</td></tr>';
        }
    };

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const mode = form.dataset.mode;
        const formData = new FormData(form);
        const url = mode === 'create'
            ? `${window.APP_CONFIG.baseUrl}/api/admin/rooms/create`
            : `${window.APP_CONFIG.baseUrl}/api/admin/rooms/update`;
        try {
            const response = await apiFetch(url, { method: 'POST', body: formData });
            if(response.success) {
                showToast(response.message, 'success');
                resetForm();
                loadRooms();
            }
        } catch(error) {}
    });

    tableBody.addEventListener('click', async (e) => {
        const target = e.target;
        const row = target.closest('tr');
        if (!row) return;
        const id = row.dataset.id;

        if (target.classList.contains('edit-room')) {
            form.dataset.mode = 'update';
            roomIdInput.value = id;
            roomNameInput.value = target.dataset.name;
            formTitle.textContent = 'Raum bearbeiten';
            cancelBtn.style.display = 'inline-block';
            roomNameInput.focus();
        }

        if (target.classList.contains('delete-room')) {
            if (await showConfirm('Raum l√∂schen', `Sind Sie sicher, dass Sie den Raum '${escapeHtml(target.closest('tr').cells[1].textContent)}' endg√ºltig l√∂schen m√∂chten?`)) {
                const formData = new FormData();
                formData.append('room_id', id);
                try {
                    const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/rooms/delete`, { method: 'POST', body: formData });
                    if(response.success) {
                        showToast(response.message, 'success');
                        loadRooms();
                    }
                } catch(error) {}
            }
        }
    });

    cancelBtn.addEventListener('click', resetForm);
    loadRooms();
}

function initializeTeacherManagement() {
    const section = document.getElementById('teachers-section');
    if (!section) return;
    const tableBody = section.querySelector('#teachers-table tbody');
    const form = section.querySelector('#teacher-form');
    const formTitle = section.querySelector('#teacher-form-container h4');
    const teacherIdInput = section.querySelector('#teacher_id');
    const cancelBtn = section.querySelector('#cancel-edit-teacher');

    const resetForm = () => {
        form.dataset.mode = 'create';
        form.reset();
        teacherIdInput.value = '';
        formTitle.textContent = 'Lehrer anlegen/bearbeiten';
        cancelBtn.style.display = 'none';
    };

    const renderTable = (teachers) => {
        tableBody.innerHTML = teachers.length > 0 ? teachers.map(t => {
            const id = escapeHtml(t.teacher_id);
            const shortcut = escapeHtml(t.teacher_shortcut);
            const firstName = escapeHtml(t.first_name);
            const lastName = escapeHtml(t.last_name);
            const email = escapeHtml(t.email || '');
            return `
            <tr data-id="${id}">
                <td data-label="ID">${id}</td>
                <td data-label="K√ºrzel">${shortcut}</td>
                <td data-label="Vorname">${firstName}</td>
                <td data-label="Nachname">${lastName}</td>
                <td data-label="E-Mail">${email}</td>
                <td class="actions" data-label="Aktionen">
                    <button class="btn btn-warning btn-small edit-teacher">Bearbeiten</button>
                    <button class="btn btn-danger btn-small delete-teacher">L√∂schen</button>
                </td>
            </tr>
        `;
        }).join('') : '<tr><td colspan="6">Keine Lehrer gefunden.</td></tr>';
    };

    const loadTeachers = async () => {
        try {
            const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/teachers`);
            if (response.success) {
                renderTable(response.data);
            }
        } catch (error) {
            tableBody.innerHTML = '<tr><td colspan="6" class="message error">Fehler beim Laden der Lehrer.</td></tr>';
        }
    };

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const mode = form.dataset.mode;
        const formData = new FormData(form);
        const url = mode === 'create'
            ? `${window.APP_CONFIG.baseUrl}/api/admin/teachers/create`
            : `${window.APP_CONFIG.baseUrl}/api/admin/teachers/update`;
        try {
            const response = await apiFetch(url, { method: 'POST', body: formData });
            if(response.success) {
                showToast(response.message, 'success');
                resetForm();
                loadTeachers();
            }
        } catch(error) {}
    });

    tableBody.addEventListener('click', async (e) => {
        const target = e.target;
        const row = target.closest('tr');
        if (!row) return;
        const id = row.dataset.id;

        if (target.classList.contains('edit-teacher')) {
            form.dataset.mode = 'update';
            teacherIdInput.value = id;
            form.querySelector('#teacher_shortcut').value = row.cells[1].textContent;
            form.querySelector('#first_name').value = row.cells[2].textContent;
            form.querySelector('#last_name').value = row.cells[3].textContent;
            form.querySelector('#email').value = row.cells[4].textContent;
            formTitle.textContent = 'Lehrer bearbeiten';
            cancelBtn.style.display = 'inline-block';
            form.querySelector('#teacher_shortcut').focus();
        }

        if (target.classList.contains('delete-teacher')) {
            if (await showConfirm('Lehrer l√∂schen', `Sind Sie sicher, dass Sie '${escapeHtml(row.cells[2].textContent)} ${escapeHtml(row.cells[3].textContent)}' endg√ºltig l√∂schen m√∂chten? Dies kann Stundenpl√§ne beeinflussen.`)) {
                const formData = new FormData();
                formData.append('teacher_id', id);
                try {
                    const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/teachers/delete`, { method: 'POST', body: formData });
                    if(response.success) {
                        showToast(response.message, 'success');
                        loadTeachers();
                    }
                } catch(error) {}
            }
        }
    });

    cancelBtn.addEventListener('click', resetForm);
    loadTeachers();
}

function initializeClassManagement() {
    const section = document.getElementById('classes-section');
    if (!section) return;
    const tableBody = section.querySelector('#classes-table tbody');
    const form = section.querySelector('#class-form');
    const formTitle = section.querySelector('#class-form-container h4');
    const classIdInput = section.querySelector('#class_id_input');
    const classIdHiddenInput = section.querySelector('#class_id_hidden');
    const classNameInput = section.querySelector('#class_name');
    const teacherSelect = section.querySelector('#class_teacher_id');
    const cancelBtn = section.querySelector('#cancel-edit-class');

    const resetForm = () => {
        form.dataset.mode = 'create';
        form.reset();
        classIdHiddenInput.value = '';
        formTitle.textContent = 'Neue Klasse anlegen';
        cancelBtn.style.display = 'none';
        classIdInput.readOnly = false;
        classIdInput.disabled = false;
    };

    const renderTable = (classes) => {
        tableBody.innerHTML = classes.length > 0 ? classes.map(c => {
            const id = escapeHtml(c.class_id);
            const name = escapeHtml(c.class_name);
            const teacherName = escapeHtml(c.teacher_name || 'Kein Klassenlehrer');
            return `
            <tr data-id="${id}" data-teacher-id="${escapeHtml(c.class_teacher_id || '')}">
                <td data-label="ID">${id}</td>
                <td data-label="Klassen-Akronym">${name}</td>
                <td data-label="Klassenlehrer">${teacherName}</td>
                <td class="actions" data-label="Aktionen">
                    <button class="btn btn-warning btn-small edit-class" data-name="${name}">Bearbeiten</button>
                    <button class="btn btn-danger btn-small delete-class">L√∂schen</button>
                </td>
            </tr>
        `;
        }).join('') : '<tr><td colspan="4">Keine Klassen gefunden.</td></tr>';
    };

    const loadTeachersForSelect = async () => {
        try {
            const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/teachers`);
            if (response.success) {
                teacherSelect.innerHTML = '<option value="">Kein Klassenlehrer</option>' + response.data.map(t =>
                    `<option value="${escapeHtml(t.teacher_id)}">${escapeHtml(t.first_name)} ${escapeHtml(t.last_name)} (${escapeHtml(t.teacher_shortcut)})</option>`
                ).join('');
            }
        } catch (error) {
            teacherSelect.innerHTML = '<option value="">Lehrer konnten nicht geladen werden</option>';
        }
    };

    const loadClasses = async () => {
        try {
            const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/classes`);
            if (response.success) {
                renderTable(response.data);
            }
        } catch (error) {
            tableBody.innerHTML = '<tr><td colspan="4" class="message error">Fehler beim Laden der Klassen.</td></tr>';
        }
    };

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const mode = form.dataset.mode;
        const formData = new FormData(form);
        
        // Korrekte ID basierend auf dem Modus setzen
        if (mode === 'update') {
            formData.set('class_id_hidden', classIdHiddenInput.value); // Nutzt die versteckte ID
            formData.delete('class_id_input'); // Entfernt das sichtbare (ggf. deaktivierte) ID-Feld
        } else {
            // class_id_input wird bereits durch FormData erfasst
            formData.delete('class_id_hidden'); // Entfernt das leere versteckte Feld
        }

        const url = mode === 'create'
            ? `${window.APP_CONFIG.baseUrl}/api/admin/classes/create`
            : `${window.APP_CONFIG.baseUrl}/api/admin/classes/update`;
        try {
            const response = await apiFetch(url, { method: 'POST', body: formData });
            if(response.success) {
                showToast(response.message, 'success');
                resetForm();
                loadClasses();
            }
        } catch(error) {}
    });

    tableBody.addEventListener('click', async (e) => {
        const target = e.target;
        const row = target.closest('tr');
        if (!row) return;
        const id = row.dataset.id;

        if (target.classList.contains('edit-class')) {
            form.dataset.mode = 'update';
            classIdInput.value = id;
            classIdInput.readOnly = true;
            classIdInput.disabled = true;
            classIdHiddenInput.value = id;
            classNameInput.value = target.dataset.name;
            teacherSelect.value = row.dataset.teacherId;
            formTitle.textContent = 'Klasse bearbeiten';
            cancelBtn.style.display = 'inline-block';
            classNameInput.focus();
        }

        if (target.classList.contains('delete-class')) {
            if (await showConfirm('Klasse l√∂schen', `Sind Sie sicher, dass Sie die Klasse '${escapeHtml(row.cells[1].textContent)}' endg√ºltig l√∂schen m√∂chten? Dies kann Stundenpl√§ne und Benutzerzuweisungen beeinflussen.`)) {
                const formData = new FormData();
                formData.append('class_id', id);
                try {
                    const response = await apiFetch(`${window.APP_CONFIG.baseUrl}/api/admin/classes/delete`, { method: 'POST', body: formData });
                    if(response.success) {
                        showToast(response.message, 'success');
                        loadClasses();
                    }
                } catch(error) {}
            }
        }
    });

    cancelBtn.addEventListener('click', resetForm);
    loadTeachersForSelect();
    loadClasses();
}

export function initializeAdminStammdaten() {
    initializeTabbedInterface();
}
--- END FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-stammdaten.js ---
--- START FILE: C:\xampp\htdocs\files\PAUSE\public\assets\js\admin-users.js ---
/* public/assets/js/admin-users.js */
import { apiFetch } from './api-client.js';
import { showToast, showConfirm } from './notifications.js';

function escapeHtml(unsafe) {
    if (unsafe === null || typeof unsafe === 'undefined') return '';
    return String(unsafe)
         .replace(/&/g, "&amp;")
         .replace(/</g, "&lt;")
         .replace(/>/g, "&gt;")
         .replace(/"/g, "&quot;")
         .replace(/'/g, "&#039;");
}

export function initializeAdminUsers() {
    const userManagement = document.getElementById('user-management');
    if (!userManagement) return;

    const tableBody = userManagement.querySelector('#users-table tbody');
    const form = userManagement.querySelector('#user-form');
    const formTitle = userManagement.querySelector('#user-form-title');
    const userIdInput = userManagement.querySelector('#user_id');
    const passwordInput = userManagement.querySelector('#password');
    const cancelBtn = userManagement.querySelector('#cancel-edit-user');
    const roleSelect = userManagement.querySelector('#role');
    const classSelectContainer = userManagement.querySelector('#class-select-container');
    const classSelect = userManagement.querySelector('#class_id');
    const teacherSelectContainer = userManagement.querySelector('#teacher-select-container');
    const teacherSelect = userManagement.querySelector('#teacher_id');
    const communityBanContainer = userManagement.querySelector('#community-ban-container');
    const communityBanCheckbox = userManagement.querySelector('#is_community_banned');

    // Import-Formular Elemente
    const importForm = document.getElementById('user-import-form');
    const importButton = document.getElementById('user-import-btn');
    const importResultsContainer = document.getElementById('import-results-container');
    const importResultsPre = document.getElementById('import-results');

    let allData = {}; // Speichert Rollen, Klassen, Lehrer

    const resetForm = () => {
        form.dataset.mode = 'create';
        form.reset();
        userIdInput.value = '';
        formTitle.textContent = 'Neuen Benutzer anlegen';
        passwordInput.setAttribute('required', 'required');
        passwordInput.parentElement.querySelector('label').textContent = 'Passwort*';
        cancelBtn.style.display = 'none';
        toggleRoleSpecificFields();
    };

    const toggleRoleSpecificFields = () => {
        const selectedRole = roleSelect.value;
        classSelectContainer.style.display = selectedRole === 'schueler' ? 'block' : 'none';
        teacherSelectContainer.style.display = selectedRole === 'lehrer' ? 'block' : 'none';
        communityBanContainer.style.display = selectedRole === 'schueler' ? 'block' : 'none';

        if (selectedRole !== 'schueler') {
            classSelect.value = '';
            if(communityBanCheckbox) communityBanCheckbox.checked = false;
        }
        if (selectedRole !== 'lehrer') {
            teacherSelect.value = '';
        }
    };

    const renderTable = (users) => {
        const currentAdminId = window.APP_CONFIG.userId;
        tableBody.innerHTML = users.length > 0 ? users.map(user => {
            let details = '';
            if (user.role === 'schueler' && user.class_name) {
                details = `Klasse: ${escapeHtml(user.class_name)}`;