/* public/assets/css/pages/_planer.css */

/* Haupt-Header Container */
.planer-header {
    display: flex;
    flex-direction: column; /* Stacks title and controls vertically */
    align-items: stretch;    /* Children take full width */
    gap: 20px;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid var(--color-border);
    padding-bottom: 1.5rem;
}

/* Wrapper für alle Controls auf der rechten Seite */
.planer-actions-wrapper {
    display: flex;
    flex-direction: column; /* Stellt Filter und Publish-Controls untereinander */
    gap: 15px; /* Abstand zwischen den beiden Control-Blöcken */
    align-items: stretch; /* Sorgt dafür, dass beide Blöcke die gleiche Breite haben */
}

/* Container für die Filter (Selects, Datum) */
.planer-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 10px 15px;
    align-items: flex-end;
    justify-content: flex-start; /* Richtet die Filter links aus */
}

.planer-controls .form-group {
    margin-bottom: 0;
    flex-basis: 150px;
    flex-grow: 1;
}
/* Spezifische Breite für längere Selects */
.planer-controls .form-group#class-selector-container,
.planer-controls .form-group#teacher-selector-container {
    flex-basis: 200px;
}
.planer-controls .form-group label {
    font-size: 0.85rem;
    margin-bottom: 3px;
}


/* Container für den Veröffentlichungs-Status und Buttons */
.publish-controls {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 15px;
    background-color: var(--color-surface-alt);
    padding: 10px 15px;
    border-radius: 6px;
    border: 1px solid var(--color-border);
    box-sizing: border-box;
}
.dark-mode .publish-controls {
    background-color: var(--color-surface-alt);
}

.publish-status {
    font-weight: bold;
    color: var(--color-text-muted);
    font-size: 0.9rem;
    white-space: nowrap;
    flex-grow: 1; /* Drückt die Buttons nach rechts */
}

.status-indicator {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 4px;
    margin-left: 5px;
    font-size: 0.8rem;
    font-weight: normal;
}

.status-indicator.published {
    background-color: var(--color-success);
    color: white;
}

.status-indicator.not-published {
    background-color: #e9ecef;
    color: #6c757d;
}
.dark-mode .status-indicator.not-published {
    background-color: #343a40;
    color: #adb5bd;
}

.publish-actions {
    display: flex;
    gap: 10px;
    flex-wrap: nowrap; /* Verhindert Umbruch der Buttons selbst */
    flex-shrink: 0; /* Verhindert, dass der Button-Container schrumpft */
}

.publish-actions .btn-small {
    padding: 6px 10px;
    font-size: 0.85rem;
    min-width: 100px; /* Einheitliche Mindestbreite für Buttons */
    height: 36px; /* Einheitliche Höhe */
    display: flex; /* Für vertikale Zentrierung des Textes */
    justify-content: center;
    align-items: center;
    box-sizing: border-box; /* Padding in die Breite/Höhe einbeziehen */
}

/* Spezielles Styling für die "Zurückziehen"-Buttons */
.publish-actions .btn-small.btn-warning { /* Übernimmt die btn-warning Farbe, falls vorhanden */
    background-color: var(--color-warning); /* Beispiel: Orange für Zurückziehen */
    color: #333; /* Dunklerer Text für besseren Kontrast auf gelb */
    border: 1px solid var(--color-warning);
}
.publish-actions .btn-small.btn-warning:hover {
    background-color: #e6ac00;
    border-color: #e6ac00;
}
.dark-mode .publish-actions .btn-small.btn-warning {
    background-color: #e6ac00;
    border-color: #e6ac00;
}
.dark-mode .publish-actions .btn-small.btn-warning:hover {
    background-color: var(--color-warning);
    border-color: var(--color-warning);
}

/* NEU: Bulk Actions Section */
.bulk-actions-controls {
    display: flex;
    gap: 10px;
    padding: 10px 15px;
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 6px;
    /* Removed from planer-actions-wrapper, will be placed below timetable */
    /* width: fit-content; /* Adjust width to content */
    /* margin-left: auto; /* Push to the right */
}
.dark-mode .bulk-actions-controls {
    background-color: var(--color-surface);
}

.bulk-actions-controls .btn-small {
    padding: 6px 12px;
    font-size: 0.85rem;
    height: 36px;
    width: auto;
    display: inline-flex;
    gap: 6px;
    align-items: center;
    background-color: #f8f9fa;
    color: var(--color-text);
    border: 1px solid var(--color-border);
    margin-bottom: 0;
}
.bulk-actions-controls .btn-small:hover {
    background-color: #e9ecef;
    color: var(--color-primary);
}
.dark-mode .bulk-actions-controls .btn-small {
    background-color: var(--color-surface-alt);
    color: var(--color-text);
    border-color: var(--color-border);
}
.dark-mode .bulk-actions-controls .btn-small:hover {
    background-color: #343a40;
    color: var(--color-primary);
}
.bulk-actions-controls .btn-small svg {
    margin-top: -2px; /* Visual alignment */
}


/* NEU: Copy Week Modal */
.copy-week-form {
    display: grid;
    grid-template-columns: 1fr auto 1fr 1fr;
    gap: 15px;
    align-items: flex-end;
    margin-bottom: 20px;
}

.copy-week-form .form-group {
    margin-bottom: 0;
}

.copy-week-form input[readonly] {
    background-color: var(--color-surface-alt);
    color: var(--color-text-muted);
    font-weight: bold;
}
.dark-mode .copy-week-form input[readonly] {
    background-color: var(--color-background);
}


.copy-week-form .arrow-separator {
    font-size: 2rem;
    font-weight: bold;
    color: var(--color-text-muted);
    padding-bottom: 5px; /* Align with inputs */
}

#copy-week-warning {
    display: block; /* Ist immer sichtbar */
    background-color: rgba(255, 189, 0, 0.1);
    border: 1px solid var(--color-warning);
    color: #664d03; /* Darker yellow text */
    margin-top: 0;
    margin-bottom: 20px;
    padding: 10px 15px;
    border-radius: 6px;
}
.dark-mode #copy-week-warning {
    color: var(--color-warning);
}

/* --- Timetable Grid --- */

/* KORREKTUR: .grid-header auf Tabellen-Header (TH) angepasst */
.timetable-grid th.grid-header { /* Ziel: <th class="grid-header ..."> */
    /* display: flex; (Nicht nötig für TH) */
    background-color: var(--color-surface-alt);
    font-weight: bold;
    text-align: center;
    padding: 10px;
    justify-content: center;
    align-items: center;
    vertical-align: middle;
}
.dark-mode .timetable-grid th.grid-header {
    background-color: var(--color-surface-alt);
}

/* KORREKTUR: Alte, falsche Breiten-Definition entfernt (war hier) */


/* --- Modal Styles --- */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    z-index: 1040; /* Standard-Overlay-Ebene */
    display: none;
    justify-content: center;
    /* KORREKTUR: align-items: center zu flex-start geändert */
    align-items: flex-start;
    opacity: 0;
    transition: opacity 0.3s ease;
    backdrop-filter: blur(5px);
    /* NEU: Padding oben und unten, damit Modal scrollen kann */
    padding: 5vh 0;
    overflow-y: auto; /* Erlaube dem Overlay selbst zu scrollen, falls das Modal + Padding größer als 100vh ist */
}
.modal-overlay.visible { display: flex; opacity: 1; }
.modal-box {
    background: var(--color-surface);
    padding: 25px 30px; /* Reduced padding */
    border-radius: 12px;
    width: 90%; /* Width for mobile */
    max-width: 500px; /* Default max-width */
    box-sizing: border-box;
    max-height: 90vh;
    overflow-y: auto;
    margin: 0;
    display: flex;
    flex-direction: column;
}
.modal-box h2 { margin-top: 0; }

/* Modal Conflict Warning */
#modal-conflict-warning {
    display: none;
    background-color: rgba(255, 0, 84, 0.1); /* Helles Rot */
    border: 1px solid var(--color-danger);
    color: var(--color-danger);
    padding: 15px;
    border-radius: 8px;
    margin-top: 20px;
    font-weight: 600;
}
#modal-conflict-warning div {
    margin-bottom: 5px;
}
#modal-conflict-warning div:last-child {
    margin-bottom: 0;
}
.dark-mode #modal-conflict-warning {
    color: #ff8984;
    border-color: #ff8984;
}


.modal-actions { display: flex; gap: 15px; margin-top: 30px; }
.modal-actions .btn { width: 0; flex-grow: 1; flex-basis: 0; margin-bottom: 0; height: 44px; padding-top: 0; padding-bottom: 0; }
.modal-tabs { display: flex; border-bottom: 1px solid var(--color-border); margin-bottom: 20px; }
.modal-tabs .tab-button { padding: 10px 15px; border: none; background: transparent; cursor: pointer; font-size: 1rem; font-weight: 600; color: var(--color-text-muted); border-bottom: 3px solid transparent; transition: color 0.2s, border-color 0.2s; }
.modal-tabs .tab-button:hover { color: var(--color-primary); }
.modal-tabs .tab-button.active { color: var(--color-primary); border-bottom-color: var(--color-primary); }
.modal-tab-content { display: none; }
.modal-tab-content.active { display: block; }
.hidden { display: none !important; }

/* --- NEU: Stile für Template-Editor Modal --- */

/* Modal zum Erstellen/Verwalten von Vorlagen */
#manage-templates-modal {
    z-index: 1050; /* Höher als Standard, aber niedriger als Bearbeiten-Modal */
}
#manage-templates-modal .modal-box {
    max-width: 800px; /* Keep max-width for desktop */
    width: 95%; /* Use percentage width for responsiveness */
    /* max-height: 90vh; und overflow-y: auto; werden von .modal-box geerbt */
}

/* KORREKTUR: Z-Index für das Bearbeiten-Modal, damit es ÜBER dem Vorlagen-Modal erscheint */
#timetable-modal {
    z-index: 1060; /* Höchste Ebene */
}


/* Ansicht 1: Liste */
.manage-templates-view.active {
    display: flex; /* Erzwinge flex-Verhalten, wenn aktiv */
    flex-direction: column;
    flex: 1;
    min-height: 0;
}

/* Ansicht 2: Editor */
#template-editor-view {
    display: none; /* (wird von JS auf 'block' gesetzt) */
    /* NEU: Sorge dafür, dass der Editor-View-Container flexibel wächst und schrumpft */
    flex: 1;
    min-height: 0; /* Wichtig für Flexbox-Scrolling */
    display: flex;
    flex-direction: column;
}


/* Container für Formular (Name/Beschreibung) */
#template-editor-view > div:nth-of-type(2) {
    display: flex;
    flex-direction: column; /* Stack on mobile */
    gap: 15px;
    margin-bottom: 15px;
    flex-shrink: 0; /* Verhindert das Schrumpfen des Formulars */
}

/* Container für das simplifizierte Grid */
#template-editor-grid-container {
    margin-top: 15px;
    border: 1px solid var(--color-border);
    border-radius: 8px;
    overflow-x: auto; /* KORREKTUR: Ermöglicht horizontales Scrollen auf kleinen Geräten */
    overflow-y: hidden; /* Verhindert doppeltes Scrollen */
    flex-shrink: 1; /* Erlaube dem Grid-Container zu schrumpfen */
    min-height: 300px; /* Gib dem Grid eine Mindesthöhe, bevor es den Container scrollt */
}

/* Das Grid im Template-Editor selbst */
/* KORREKTUR: .template-editor-grid ist jetzt eine .timetable-grid (aus JS) */
.template-editor-grid.timetable-grid {
    min-width: 600px; /* NEU: Stellt sicher, dass das Grid eine Mindestbreite hat und scrollt */
    /* grid-auto-rows: minmax(60px, auto); (wird von .grid-cell min-height gesteuert) */
    gap: 2px; /* Dünnere Linien */
}
/* KORREKTUR: Überschreibe Spalten für Template-Grid (schmalere Zeitspalte) */
.template-editor-grid.timetable-grid {
    /* grid-template-columns: 80px repeat(5, 1fr); (Nicht mehr nötig, wird von TH-Breite gesteuert) */
}
.template-editor-grid.timetable-grid th.time-col {
    width: 100px; /* KORREKTUR: auf 100px gesetzt (war 80px) */
}


/* Kleinere Schriftarten speziell im Template-Grid */
.template-editor-grid .grid-header {
    font-size: 0.8rem;
    padding: 5px;
    min-height: 40px;
}
.template-editor-grid .grid-header.period-header {
    font-size: 0.7rem;
    line-height: 1.2;
    padding: 4px 2px;
    grid-column: 1; /* Stellt sicher, dass es in Spalte 1 bleibt */
}
.template-editor-grid .grid-cell {
    min-height: 60px; /* Kleinere Mindesthöhe für Zeilen */
}

/* KORREKTUR: Ziele auf .planner-entry innerhalb des Template-Grids */
.template-editor-grid .grid-cell .planner-entry {
    padding: 2px 4px;
    min-height: 50px; /* Kleinere Höhe für Einträge */
}
.template-editor-grid .grid-cell .entry-subject { font-size: 0.8rem; }
.template-editor-grid .grid-cell .entry-main { font-size: 0.7rem; }
.template-editor-grid .grid-cell .entry-room { font-size: 0.65rem; }


/* Media Query für kleinere Bildschirme */
@media (min-width: 600px) {
    /* Formular Name/Beschreibung nebeneinander auf größeren Bildschirmen */
    #template-editor-view > div:nth-of-type(2) {
        flex-direction: row;
    }
}

@media (max-width: 1200px) {
    .planer-header { flex-direction: column; align-items: stretch; }
    .planer-actions-wrapper { min-width: 100%; }
    .planer-controls { justify-content: flex-start; }
    .publish-controls { justify-content: flex-start; }
    .publish-status { flex-grow: 0; width: 100%; margin-bottom: 10px; }
    /* Ensure bulk actions wrap on smaller screens if needed */
    .bulk-actions-controls { flex-wrap: wrap; justify-content: flex-start; }
}

@media (max-width: 768px) {
    /* Stack bulk action buttons vertically */
    .bulk-actions-controls {
        flex-direction: column;
        align-items: stretch; /* Make buttons full width */
    }
    .bulk-actions-controls .btn-small {
        width: 100%;
        justify-content: center;
    }

    /* NEU: Anpassungen für das Template-Editor-Modal auf Mobilgeräten */
    #manage-templates-modal .modal-box {
        padding: 15px; /* Noch weniger Padding */
        width: 95vw; /* Fast volle Breite */
    }

    #template-editor-view > div:nth-of-type(2) { /* Formular Name/Beschreibung */
        flex-direction: column; /* Bleibt untereinander */
    }
}

/* NEU: CSS für Absence Management */
#absence-management {
    display: flex;
    flex-direction: column;
    gap: 20px;
    padding: 25px 30px; /* Standard-Padding für Sektionen */
}

.absence-container {
    display: grid;
    grid-template-columns: 1fr 350px; /* Kalender links, Formular rechts */
    gap: 25px;
    align-items: flex-start;
}

#absence-calendar-container {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    padding: 20px;
    border-radius: 8px;
    /* Höhe wird von FullCalendar gesteuert */
}

#absence-form-container {
    background-color: var(--color-surface-alt);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid var(--color-border);
    position: sticky;
    top: 100px; /* Hält das Formular beim Scrollen sichtbar */
}
.dark-mode #absence-form-container {
    background-color: var(--color-surface-alt);
}

#absence-form-container h3 {
    margin-top: 0;
    margin-bottom: 20px;
    font-size: 1.3rem;
    border-bottom: 1px solid var(--color-border);
    padding-bottom: 10px;
}

#absence-form .form-grid-col-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

#absence-form .form-actions {
    margin-top: 20px;
    display: flex;
    justify-content: space-between;
    gap: 10px;
}

#absence-form .btn-danger {
    flex-grow: 0; /* Löschen-Button nicht strecken */
    width: auto;
}

/* FullCalendar Anpassungen */
#absence-calendar {
    max-height: 70vh; /* Begrenzt die Höhe des Kalenders */
}

/* Farbcodes für Abwesenheiten im Kalender */
.fc-event.absence-krank {
    background-color: var(--color-danger);
    border-color: var(--color-danger);
}
.fc-event.absence-fortbildung {
    background-color: var(--color-primary);
    border-color: var(--color-primary);
}
.fc-event.absence-beurlaubt {
    background-color: var(--color-warning);
    border-color: var(--color-warning);
    color: #333;
}
.fc-event.absence-sonstiges {
    background-color: var(--color-text-muted);
    border-color: var(--color-text-muted);
}
/* Styling für das ausgewählte Event */
.fc-event.absence-selected {
    box-shadow: 0 0 0 3px var(--color-primary);
    /* Helle outline für dark mode */
    outline: 2px solid var(--color-surface);
}
.dark-mode .fc-event.absence-selected {
    outline-color: var(--color-surface);
}

.fc-event-main {
    cursor: pointer;
}

/* KORREKTUR: Layout für das Abwesenheits-Formular (flacher und breiter) */
#absence-form.absence-form-layout {
    display: grid;
    /* Nutzt auto-fit, um Spalten bei Bedarf umzubrechen */
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px 20px;
    align-items: flex-end; /* Richtet Elemente an der Unterkante aus (wichtig für Aktionen) */
}

/* Einzelne Formulargruppen */
#absence-form.absence-form-layout .form-group {
    margin-bottom: 0; /* Wird durch grid-gap ersetzt */
}

/* Lehrergruppe und Kommentargruppe sollen mehr Platz einnehmen, wenn möglich */
@media (min-width: 993px) {
    #absence-form.absence-form-layout #absence-teacher-group,
    #absence-form.absence-form-layout #absence-comment-group {
        /* Nimmt 2 Spalten ein, wenn das Grid mehr als 2 Spalten hat */
        grid-column: span 2;
    }
    
    /* Auf sehr breiten Bildschirmen (mehr als 4 Items nebeneinander) */
    @media (min-width: 1200px) {
        #absence-form.absence-form-layout #absence-teacher-group {
            grid-column: span 3;
        }
        #absence-form.absence-form-layout #absence-comment-group {
            grid-column: span 2;
        }
    }
}

/* Aktions-Gruppe ganz unten und volle Breite */
#absence-form.absence-form-layout #absence-actions-group {
    grid-column: 1 / -1; /* Volle Breite */
    margin-top: 10px; /* Kleiner Abstand nach oben */
}


/* Responsive für Abwesenheits-Seite */
@media (max-width: 992px) {
    .absence-container {
        grid-template-columns: 1fr; /* Stackt Kalender und Formular */
    }
    #absence-form-container {
        position: static; /* Hebt Sticky auf */
        top: auto;
    }
    #absence-calendar {
        max-height: 60vh; /* Etwas weniger Höhe auf Mobilgeräten */
    }

    /* KORREKTUR: Auf Mobilgeräten das Formular-Grid vereinfachen */
    #absence-form.absence-form-layout {
        grid-template-columns: 1fr; /* Alles untereinander */
    }

    #absence-form.absence-form-layout #absence-teacher-group,
    #absence-form.absence-form-layout #absence-comment-group {
        grid-column: 1 / -1; /* Volle Breite (Standard) */
    }
} 

/* =========================================
NEUE REGELN FÜR PARALLELE EINTRÄGE (wiederhergestellt von _dashboard.css)
=========================================
*/

/* KORREKTUR: Ersetzt die 'display: table' Stile durch 'display: grid' */
.timetable-grid {
    display: grid;
    grid-template-columns: 80px repeat(5, 1fr); /* 80px Zeitspalte */
    grid-auto-rows: minmax(70px, auto); /* Mindesthöhe 70px */
    gap: 3px; /* Simuliert die dünnen Linien */
    background-color: var(--color-border);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    overflow: hidden;
    /* table-layout: fixed; (Nur für Tabellen) */
}
.timetable-grid thead, .timetable-grid tbody, .timetable-grid tr {
    /* (Diese sind nur für Tabellen) */
    display: contents; /* Wichtig für CSS-Grid-Layout in einer Tabelle (obwohl wir jetzt divs verwenden) */
}
/* .timetable-grid th, .timetable-grid td { (wird durch .grid-header / .grid-cell ersetzt) } */


/* Container für mehrere Einträge pro Zelle */
.cell-entries-container {
    display: flex;
    flex-direction: column;
    gap: 2px; /* Kleiner Abstand zwischen parallelen Einträgen */
    height: 100%;
    width: 100%;
    padding: 2px; /* Etwas Innenabstand in der Zelle */
    box-sizing: border-box;
}

/* Anpassung der Zellen (TD), damit der Container die volle Höhe nutzt */
.timetable-grid .grid-cell {
    /* (Dieser Stil wird jetzt vom Dashboard übernommen) */
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: stretch;
    gap: 3px; /* Abstand zwischen parallelen Einträgen */
    padding: 3px;
    position: relative;
    background-color: var(--color-surface);
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease;
    min-height: 70px; /* Synchronisiert mit grid-auto-rows */
}
.dark-mode .timetable-grid .grid-cell {
    background-color: var(--color-surface);
}

/* Weist Zellen den korrekten Spalten zu (CSS-Grid-Logik) */
.grid-cell[data-day="1"] { grid-column: 2; }
.grid-cell[data-day="2"] { grid-column: 3; }
.grid-cell[data-day="3"] { grid-column: 4; }
.grid-cell[data-day="4"] { grid-column: 5; }
.grid-cell[data-day="5"] { grid-column: 6; }


.timetable-grid .grid-cell:hover {
    background-color: #f1f5f9;
    z-index: 5;
}
.dark-mode .timetable-grid .grid-cell:hover {
    background-color: #ffffff1a;
}

.timetable-grid .grid-cell.selected {
    background-color: rgba(57, 0, 153, 0.1);
    outline: 2px solid var(--color-primary);
    outline-offset: -2px;
    z-index: 10;
}

/* KORREKTUR: Drag-Stile auf .grid-cell (TD) anwenden */
.timetable-grid .grid-cell.dragging {
    opacity: 0.4;
    transform: scale(0.95);
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}
.timetable-grid.is-dragging .grid-cell {
    transition: background-color 0.3s ease;
}
.grid-cell.drop-target {
    background-color: rgba(57, 0, 153, 0.1);
    transform: scale(1.03);
    z-index: 15;
}
.grid-cell.drop-target-valid {
    background-color: rgba(40, 167, 69, 0.15);
    outline: 2px dashed var(--color-success);
    outline-offset: -2px;
}
.grid-cell.drop-target-invalid {
    background-color: rgba(255, 0, 84, 0.15);
    outline: 2px dashed var(--color-danger);
    outline-offset: -2px;
}
/* Ende Drag-Stile */


/* (Dieser Stil ist jetzt obsolet, da .planner-entry das Styling übernimmt) */
.cell-entry {
    /* KORREKTUR: pointer-events: none; (damit die Zelle das Drag-Event empfängt) */
    pointer-events: none;
}

/* KORREKTUR: .grid-cell strong/span/small (Globale Zellenschriftarten) */
.grid-cell strong { font-size: 0.9rem; font-weight: 700; }
.grid-cell span { font-size: 0.75rem; color: var(--color-text-muted); }
.grid-cell small { font-size: 0.7rem; color: var(--color-text-muted); }
.grid-cell small.entry-room { color: #555; }
.dark-mode .grid-cell small.entry-room { color: #bbb; }
.grid-cell small.entry-comment { display: block; font-style: italic; color: var(--color-secondary); margin-top: 2px; line-height: 1.2; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 90%; }
/* --- Ende Grid-Stile --- */


/* Styling für die einzelnen Eintrag-Divs (Planner-Entry) */
.planner-entry {
    border-radius: 4px;
    padding: 4px;
    font-size: 0.8rem;
    cursor: pointer;
    border: 1px solid var(--color-border);
    transition: all 0.2s ease;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    flex-shrink: 0;
    line-height: 1.3;
    /* KORREKTUR: Stile aus .cell-entry übernommen */
    background: rgba(255, 255, 255, 0.9);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    word-break: break-word;
}
.dark-mode .planner-entry {
    background: rgba(40, 48, 54, 0.9);
    border-color: #444c56;
}


.planner-entry:hover {
    transform: translateY(-1px) scale(1.03); /* Leichter Hover-Effekt auf dem Eintrag selbst */
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    z-index: 10;
    position: relative; /* Für z-index */
}

/* Styling für reguläre Einträge (timetable-entry) */
.timetable-entry {
    background-color: var(--color-surface-alt);
    border-left: 3px solid var(--color-primary);
}
.dark-mode .timetable-entry {
    background-color: var(--color-surface);
}

.planner-entry .entry-line {
    text-align: left; /* Linksbündig für bessere Lesbarkeit */
    padding: 0 2px; /* Kleiner horizontaler Abstand */
    pointer-events: none; /* Stellt sicher, dass Klicks/Drag zur Zelle durchgehen */
}

.planner-entry .entry-subject {
    font-weight: 600;
    color: var(--color-text);
    font-size: 0.9rem; /* War .grid-cell strong */
}
.planner-entry .entry-main {
    color: var(--color-text-muted);
    font-size: 0.75rem; /* War .grid-cell span */
}
.planner-entry .entry-room {
    font-size: 0.75rem; /* Angepasst */
    color: var(--color-secondary);
}
.planner-entry .sub-type {
    font-weight: 700;
    font-size: 0.7rem;
    text-transform: uppercase;
    margin-bottom: 2px;
}


/* Styling für Vertretungen (substitution-entry) */
.substitution-entry {
    background-color: var(--color-surface-alt);
}
.dark-mode .substitution-entry {
    background-color: var(--color-surface);
}

.planner-entry.vertretung {
    border-left: 3px solid var(--color-danger);
    background-color: #fff0f1;
}
.planner-entry.vertretung .sub-type {
    color: var(--color-danger);
}
.dark-mode .planner-entry.vertretung {
    background-color: rgba(255, 0, 84, 0.1);
}

.planner-entry.raumänderung {
    border-left: 3px solid var(--color-warning);
    background-color: #fff9e6;
}
.planner-entry.raumänderung .sub-type {
    color: var(--color-warning);
}
.dark-mode .planner-entry.raumänderung {
    background-color: rgba(255, 189, 0, 0.1);
}

.planner-entry.entfall {
    border-left: 3px solid var(--color-text-muted);
    background-color: var(--color-surface-alt);
    opacity: 0.7;
    text-decoration: line-through;
}
.planner-entry.entfall .sub-type {
    color: var(--color-text-muted);
}
.dark-mode .planner-entry.entfall {
    background-color: var(--color-surface);
}


.planner-entry.sonderevent {
    border-left: 3px solid var(--color-primary);
    background-color: #e7f5ff; /* Hellblau von Dashboard */
}
.planner-entry.sonderevent .sub-type {
    color: var(--color-primary);
}
.dark-mode .planner-entry.sonderevent {
    background-color: rgba(0, 123, 255, 0.1);
}

/* KORREKTUR: Styling für Abwesenheits-Warnung (zielt auf .planner-entry) */
.planner-entry.is-absent {
    background-color: rgba(255, 0, 84, 0.05);
    outline: 1px dashed var(--color-danger);
    outline-offset: -1px;
}
.dark-mode .planner-entry.is-absent {
    background-color: rgba(255, 0, 84, 0.1);
}
.planner-entry.is-absent .entry-main { /* Zielt auf Lehrer/Klasse */
    color: var(--color-danger);
    font-weight: 700;
    background-color: rgba(255, 0, 84, 0.1);
    padding: 0 4px;
    border-radius: 3px;
}
.dark-mode .planner-entry.is-absent .entry-main {
    background-color: rgba(255, 0, 84, 0.2);
    color: #ff8984;
}
.planner-entry .absence-warning { /* .absence-warning ist jetzt ein Kind von .planner-entry */
    font-size: 0.7rem !important;
    font-weight: 700;
    color: var(--color-danger) !important;
    display: block;
}


/* KORREKTUR: Leere Zellen (TDs) und FU-Zellen */
.timetable-grid .grid-cell.is-empty {
    background-color: var(--color-surface-alt);
    cursor: cell;
}
.dark-mode .timetable-grid .grid-cell.is-empty {
    background-color: var(--color-background); /* Dunkler für leer */
}

/* FU-Stil (Zelle, die einen default-entry enthält) */
.timetable-grid .grid-cell.default-entry {
    background-color: #f8f9fa;
    color: #6c757d;
    justify-content: center;
    align-items: center;
    cursor: default;
}
.dark-mode .timetable-grid .grid-cell.default-entry {
    background-color: #21262d;
    color: var(--color-text-muted);
}
/* Der .planner-entry div innerhalb einer FU-Zelle */
.grid-cell.default-entry .planner-entry {
    background: transparent;
    border: none;
    flex-grow: 0;
    height: auto;
    min-height: 0;
    pointer-events: none;
}
.grid-cell.default-entry .planner-entry .entry-subject {
    color: inherit;
    font-size: 0.9rem;
}


.timetable-grid .grid-cell.is-empty:hover {
    background-color: #f1f5f9;
    transform: none;
}
.dark-mode .timetable-grid .grid-cell.is-empty:hover {
    background-color: #ffffff1a;
}
/* KORREKTUR: Hover für FU-Zellen */
.timetable-grid .grid-cell.default-entry:hover {
    background-color: #f8f9fa;
    transform: none;
}
.dark-mode .timetable-grid .grid-cell.default-entry:hover {
    background-color: #21262d;
}
